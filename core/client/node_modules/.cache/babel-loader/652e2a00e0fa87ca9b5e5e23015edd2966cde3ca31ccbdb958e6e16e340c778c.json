{"ast":null,"code":"var _jsxFileName = \"D:\\\\XM\\\\AI-Sphere-Butler\\\\core\\\\client\\\\src\\\\components\\\\Settings.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// components/Settings.jsx\nimport React, { useState, useEffect, useRef } from 'react';\n// *** 新增：导入 ServerUrlConfig 组件 ***\nimport ServerUrlConfig from './ServerUrlConfig'; // 假设 ServerUrlConfig.jsx 与 Settings.jsx 在同一目录\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst menuItems = [{\n  key: 'home',\n  label: '主页'\n}, {\n  key: 'butler',\n  label: '管家'\n}, {\n  key: 'car',\n  label: '车'\n}, {\n  key: 'homeassistant',\n  label: 'HA'\n}, {\n  key: 'ops',\n  label: '运维'\n}, {\n  key: 'settings',\n  label: '设置'\n}];\nconst wallpaperTypes = [{\n  value: 'image',\n  label: '静态图片'\n}, {\n  value: 'video',\n  label: '视频背景'\n}, {\n  value: 'camera',\n  label: '摄像头实时画面'\n}];\n// ... isValidUrl 和 CameraPreview 保持不变 ...\nexport default function Settings({\n  wallpaperSettings,\n  setWallpaperSettings,\n  panels = [],\n  resetAllPanels,\n  resetSinglePanel\n}) {\n  _s();\n  var _menuItems$find, _availableCameras$fin;\n  const [selectedMenu, setSelectedMenu] = useState('home');\n  const [selectedType, setSelectedType] = useState('image');\n  const [mediaSrc, setMediaSrc] = useState('');\n  const [availableCameras, setAvailableCameras] = useState([]);\n  const [selectedCameraId, setSelectedCameraId] = useState(null);\n  const [cameraError, setCameraError] = useState(null);\n  const [wallpaperFolded, setWallpaperFolded] = useState(false);\n  const [panelResetFolded, setPanelResetFolded] = useState(true);\n  // *** 新增：前端服务地址设置折叠状态 ***\n  const [serverUrlConfigFolded, setServerUrlConfigFolded] = useState(true);\n\n  // 菜单展开状态\n  const [menuOpen, setMenuOpen] = useState(false);\n  const menuRef = useRef(null);\n  // 摄像头设备菜单展开状态\n  const [cameraMenuOpen, setCameraMenuOpen] = useState(false);\n  const cameraMenuRef = useRef(null);\n  // 新增：文件上传状态\n  const [uploadStatus, setUploadStatus] = useState('');\n  useEffect(() => {\n    const cfg = wallpaperSettings[selectedMenu] || {\n      type: 'image',\n      value: ''\n    };\n    setSelectedType(cfg.type);\n    if (cfg.type === 'camera') {\n      setSelectedCameraId(cfg.value || null);\n      setMediaSrc('');\n    } else {\n      setMediaSrc(cfg.value || '');\n      setSelectedCameraId(null);\n    }\n    setCameraError(null);\n  }, [selectedMenu, wallpaperSettings]);\n  useEffect(() => {\n    async function fetchCameras() {\n      try {\n        const devices = await navigator.mediaDevices.enumerateDevices();\n        const videoDevices = devices.filter(d => d.kind === 'videoinput');\n        setAvailableCameras(videoDevices);\n        if (selectedCameraId && !videoDevices.some(d => d.deviceId === selectedCameraId)) {\n          setSelectedCameraId(null);\n        }\n      } catch {\n        setAvailableCameras([]);\n        setCameraError('无法获取摄像头设备列表，可能未授予权限或浏览器不支持。');\n      }\n    }\n    fetchCameras();\n  }, [selectedCameraId]);\n  // 点击页面空白关闭所有菜单\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\n        setMenuOpen(false);\n      }\n      if (cameraMenuRef.current && !cameraMenuRef.current.contains(event.target)) {\n        setCameraMenuOpen(false);\n      }\n    }\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n  // 选择菜单项\n  const handleMenuSelect = key => {\n    setSelectedMenu(key);\n    setMenuOpen(false);\n    setCameraError(null);\n  };\n  // 选择摄像头设备\n  const handleCameraSelect = deviceId => {\n    setSelectedCameraId(deviceId);\n    setCameraMenuOpen(false);\n    setCameraError(null);\n  };\n  const handleTypeChange = e => {\n    const newType = e.target.value;\n    setSelectedType(newType);\n    setCameraError(null);\n    if (newType === 'camera') {\n      setMediaSrc('');\n      if (availableCameras.length > 0) {\n        setSelectedCameraId(availableCameras[0].deviceId);\n      } else {\n        setSelectedCameraId(null);\n      }\n    } else {\n      setMediaSrc('');\n      setSelectedCameraId(null);\n    }\n  };\n  const handleMediaSrcChange = e => setMediaSrc(e.target.value);\n  // 新增：处理文件选择\n  const handleFileChange = e => {\n    const file = e.target.files[0];\n    if (file) {\n      setUploadStatus(`已选择: ${file.name}`);\n    } else {\n      setUploadStatus('');\n    }\n  };\n  // *** 修改：上传背景文件函数，使用动态 URL ***\n  const uploadBackgroundFile = async fileToUpload => {\n    // 1. 获取动态配置的 URL\n    let serverUrls = {};\n    try {\n      const savedUrls = localStorage.getItem('serverUrls');\n      if (savedUrls) {\n        serverUrls = JSON.parse(savedUrls);\n      }\n    } catch (e) {\n      console.error(\"Failed to parse serverUrls from localStorage\", e);\n    }\n    // 2. 优先使用 uploadBgFileUrl 配置项，如果没有则使用 uploadFileUrl，最后 fallback 到默认值\n    const UPLOAD_BG_FILE_URL = serverUrls.uploadBgFileUrl || serverUrls.uploadFileUrl || 'http://192.168.168.77:6010/api/upload_print_file';\n    if (!fileToUpload) return;\n    const validExtensions = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'mp4', 'avi', 'mov', 'wmv', 'flv', 'webm'];\n    const fileExtension = fileToUpload.name.split('.').pop().toLowerCase();\n    if (!validExtensions.includes(fileExtension)) {\n      setUploadStatus('上传失败: 不支持的文件类型');\n      console.error('不支持的文件类型:', fileExtension);\n      return;\n    }\n    const validPrefixes = ['bg-', 'background-'];\n    const hasValidPrefix = validPrefixes.some(prefix => fileToUpload.name.toLowerCase().startsWith(prefix));\n    let newFileName = fileToUpload.name;\n    if (!hasValidPrefix) {\n      newFileName = `bg-${fileToUpload.name}`;\n    }\n    try {\n      setUploadStatus('正在上传背景文件...');\n      const formData = new FormData();\n      // 创建一个新的 File 对象，使用修改后的文件名\n      const renamedFile = new File([fileToUpload], newFileName, {\n        type: fileToUpload.type\n      });\n      formData.append('file', renamedFile);\n      console.log('准备上传背景文件:', {\n        originalName: fileToUpload.name,\n        newName: newFileName,\n        size: fileToUpload.size,\n        type: fileToUpload.type,\n        url: UPLOAD_BG_FILE_URL\n      });\n      const response = await fetch(UPLOAD_BG_FILE_URL, {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Accept': 'application/json'\n        }\n      });\n      const responseText = await response.text();\n      console.log(`背景文件上传响应 (状态码: ${response.status}):`, responseText);\n      let result;\n      try {\n        result = JSON.parse(responseText);\n      } catch (e) {\n        console.error('解析背景文件上传响应JSON失败:', e, '响应文本:', responseText);\n        throw new Error(`服务器返回无效JSON: ${responseText.substring(0, 100)}`);\n      }\n      if (!response.ok) {\n        throw new Error(result.error || `上传失败: ${response.status}`);\n      }\n      // 上传成功后，将返回的文件路径设置到 mediaSrc\n      if (result.filePath) {\n        setMediaSrc(result.filePath);\n      }\n      setUploadStatus(result.message || '背景文件上传成功');\n      console.log('背景文件上传成功:', result);\n    } catch (error) {\n      console.error('背景文件上传失败:', error);\n      setUploadStatus(`上传失败: ${error.message}`);\n    }\n  };\n  // 新增：处理文件上传\n  const handleFileUpload = async e => {\n    e.preventDefault();\n    const fileInput = document.getElementById('bg-file-upload');\n    const file = fileInput === null || fileInput === void 0 ? void 0 : fileInput.files[0];\n    if (file) {\n      await uploadBackgroundFile(file);\n      // 清空文件输入\n      if (fileInput) fileInput.value = '';\n    }\n  };\n  const handleSave = () => {\n    let valueToSave = null;\n    if (selectedType === 'camera') {\n      valueToSave = selectedCameraId || null;\n    } else if (selectedType === 'image' || selectedType === 'video') {\n      valueToSave = mediaSrc.trim() || null;\n    }\n    if ((selectedType === 'image' || selectedType === 'video') && valueToSave) {\n      if (!isValidUrl(valueToSave) && !valueToSave.startsWith('/')) {\n        alert('请输入有效的 URL 地址或以 / 开头的本地路径');\n        return;\n      }\n    }\n    setWallpaperSettings(prev => ({\n      ...prev,\n      [selectedMenu]: {\n        type: selectedType,\n        value: valueToSave\n      }\n    }));\n    alert('保存成功');\n  };\n  const renderPreview = () => {\n    if (selectedType === 'image' && mediaSrc) {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        src: mediaSrc,\n        alt: \"\\u80CC\\u666F\\u56FE\\u7247\\u9884\\u89C8\",\n        style: {\n          maxWidth: '100%',\n          maxHeight: 300,\n          borderRadius: 8,\n          objectFit: 'contain',\n          backgroundColor: '#111'\n        },\n        onError: e => {\n          e.currentTarget.src = '';\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this);\n    }\n    if (selectedType === 'video' && mediaSrc) {\n      return /*#__PURE__*/_jsxDEV(\"video\", {\n        src: mediaSrc,\n        style: {\n          maxWidth: '100%',\n          maxHeight: 300,\n          borderRadius: 8,\n          backgroundColor: '#111'\n        },\n        controls: true,\n        muted: true,\n        loop: true,\n        autoPlay: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }, this);\n    }\n    if (selectedType === 'camera') {\n      if (availableCameras.length === 0) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'orange'\n          },\n          children: \"\\u65E0\\u53EF\\u7528\\u6444\\u50CF\\u5934\\u8BBE\\u5907\\u6216\\u672A\\u6388\\u6743\\u8BBF\\u95EE\\u6444\\u50CF\\u5934\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 16\n        }, this);\n      }\n      return /*#__PURE__*/_jsxDEV(CameraPreview, {\n        cameraId: selectedCameraId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: '#666'\n      },\n      children: \"\\u8BF7\\u9009\\u62E9\\u58C1\\u7EB8\\u7C7B\\u578B\\u5E76\\u8F93\\u5165\\u6216\\u9009\\u62E9\\u8D44\\u6E90\\u3002\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 12\n    }, this);\n  };\n  // 样式定义\n  const foldHeaderStyle = {\n    cursor: 'pointer',\n    userSelect: 'none',\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: '10px 15px',\n    borderRadius: '6px',\n    backgroundColor: 'rgba(0, 229, 255, 0.1)',\n    // 磨砂浅蓝半透明\n    backdropFilter: 'blur(12px)',\n    WebkitBackdropFilter: 'blur(12px)',\n    color: 'white',\n    border: 'none' // 无边框\n  };\n  const panelContainerStyle = {\n    padding: 12,\n    borderRadius: 6,\n    backgroundColor: 'rgba(255, 255, 255, 0.15)',\n    // 白色半透明磨砂背景\n    backdropFilter: 'blur(12px)',\n    WebkitBackdropFilter: 'blur(12px)',\n    color: '#222',\n    marginBottom: 20\n  };\n  const inputSelectStyle = {\n    width: '100%',\n    padding: 8,\n    borderRadius: 4,\n    border: 'none',\n    fontSize: 16,\n    backgroundColor: 'rgba(255, 255, 255, 0.08)',\n    color: '#222',\n    outline: 'none',\n    boxSizing: 'border-box'\n  };\n  const buttonStyle = {\n    padding: '10px 20px',\n    backgroundColor: 'rgba(255, 255, 255, 0.7)',\n    color: '#222',\n    fontWeight: 'bold',\n    border: 'none',\n    borderRadius: 6,\n    cursor: 'pointer',\n    userSelect: 'none'\n  };\n  const resetSingleBtnStyle = {\n    padding: '4px 10px',\n    borderRadius: 4,\n    border: 'none',\n    backgroundColor: 'rgba(0, 123, 255, 0.6)',\n    color: 'white',\n    cursor: 'pointer',\n    userSelect: 'none'\n  };\n  // 自定义选择菜单样式（菜单项、摄像头）\n  const dropdownWrapperStyle = {\n    position: 'relative',\n    userSelect: 'none'\n  };\n  const dropdownHeaderStyle = {\n    padding: '10px 14px',\n    borderRadius: 6,\n    backgroundColor: 'rgba(255, 255, 255, 0.25)',\n    backdropFilter: 'blur(10px)',\n    WebkitBackdropFilter: 'blur(10px)',\n    border: '1px solid rgba(255,255,255,0.4)',\n    color: '#222',\n    fontWeight: '600',\n    cursor: 'pointer',\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  };\n  const dropdownListStyle = {\n    position: 'absolute',\n    top: 'calc(100% + 6px)',\n    left: 0,\n    right: 0,\n    maxHeight: 180,\n    overflowY: 'auto',\n    borderRadius: 8,\n    backgroundColor: 'rgba(255, 255, 255, 0.15)',\n    backdropFilter: 'blur(12px)',\n    WebkitBackdropFilter: 'blur(12px)',\n    boxShadow: '0 8px 24px rgba(0,0,0,0.12)',\n    zIndex: 1000\n  };\n  const dropdownItemStyle = isSelected => ({\n    padding: '10px 14px',\n    cursor: 'pointer',\n    backgroundColor: isSelected ? '#00e5ff' : 'transparent',\n    color: isSelected ? '#fff' : '#222',\n    fontWeight: isSelected ? '700' : '500',\n    transition: 'background-color 0.2s, color 0.2s'\n  });\n  const dropdownItemHoverStyle = {\n    backgroundColor: 'rgba(0, 229, 255, 0.15)',\n    color: '#00e5ff'\n  };\n  // 新增：磨砂玻璃按钮样式（与 OldWebRTC 中的样式保持一致）\n  const frostedGlassBtnStyle = {\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\n    border: '1px solid rgba(255, 255, 255, 0.3)',\n    color: 'white',\n    fontWeight: 'bold',\n    padding: '8px 16px',\n    cursor: 'pointer',\n    borderRadius: 4,\n    outline: 'none',\n    transition: 'all 0.3s',\n    fontSize: 14,\n    backdropFilter: 'blur(10px)',\n    WebkitBackdropFilter: 'blur(10px)',\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      color: 'white',\n      maxWidth: 700,\n      margin: 'auto',\n      fontFamily: 'sans-serif'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: () => setWallpaperFolded(!wallpaperFolded),\n      style: foldHeaderStyle,\n      \"aria-expanded\": !wallpaperFolded,\n      \"aria-controls\": \"wallpaperSettingsPanel\",\n      tabIndex: 0,\n      onKeyDown: e => {\n        if (e.key === 'Enter' || e.key === ' ') setWallpaperFolded(!wallpaperFolded);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"\\u58C1\\u7EB8\\u8BBE\\u7F6E (\\u70B9\\u51FB\", wallpaperFolded ? '展开' : '收起', \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          fontSize: 18\n        },\n        children: wallpaperFolded ? '+' : '−'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 7\n    }, this), !wallpaperFolded && /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"wallpaperSettingsPanel\",\n      style: panelContainerStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 16\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"menuSelect\",\n          style: {\n            display: 'block',\n            marginBottom: 6,\n            color: 'white'\n          },\n          children: \"\\u9009\\u62E9\\u83DC\\u5355\\u9879\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: dropdownWrapperStyle,\n          ref: menuRef,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"menuSelect\",\n            role: \"button\",\n            tabIndex: 0,\n            onClick: () => setMenuOpen(!menuOpen),\n            onKeyDown: e => {\n              if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                setMenuOpen(!menuOpen);\n              }\n            },\n            style: {\n              ...dropdownHeaderStyle,\n              color: 'white',\n              borderColor: 'rgba(255,255,255,0.6)' // 让边框颜色更亮\n            },\n            \"aria-haspopup\": \"listbox\",\n            \"aria-expanded\": menuOpen,\n            \"aria-labelledby\": \"menuSelect\",\n            children: [((_menuItems$find = menuItems.find(item => item.key === selectedMenu)) === null || _menuItems$find === void 0 ? void 0 : _menuItems$find.label) || '请选择', /*#__PURE__*/_jsxDEV(\"svg\", {\n              style: {\n                width: 18,\n                height: 18,\n                transform: menuOpen ? 'rotate(180deg)' : undefined,\n                transition: 'transform 0.3s'\n              },\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"white\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              children: /*#__PURE__*/_jsxDEV(\"polyline\", {\n                points: \"6 9 12 15 18 9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 422,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 15\n          }, this), menuOpen && /*#__PURE__*/_jsxDEV(\"ul\", {\n            role: \"listbox\",\n            tabIndex: -1,\n            \"aria-activedescendant\": selectedMenu,\n            style: dropdownListStyle,\n            children: menuItems.map(({\n              key,\n              label\n            }) => {\n              const isSelected = key === selectedMenu;\n              return /*#__PURE__*/_jsxDEV(\"li\", {\n                id: key,\n                role: \"option\",\n                \"aria-selected\": isSelected,\n                onClick: () => handleMenuSelect(key),\n                onKeyDown: e => {\n                  if (e.key === 'Enter' || e.key === ' ') {\n                    e.preventDefault();\n                    handleMenuSelect(key);\n                  }\n                },\n                style: {\n                  padding: '10px 14px',\n                  cursor: 'pointer',\n                  backgroundColor: isSelected ? '#00e5ff' : 'transparent',\n                  color: isSelected ? '#fff' : 'white',\n                  fontWeight: isSelected ? '700' : '500',\n                  transition: 'background-color 0.2s, color 0.2s'\n                },\n                onMouseEnter: e => {\n                  if (!isSelected) {\n                    e.currentTarget.style.backgroundColor = 'rgba(0, 229, 255, 0.15)';\n                    e.currentTarget.style.color = '#00e5ff';\n                  }\n                },\n                onMouseLeave: e => {\n                  if (!isSelected) {\n                    e.currentTarget.style.backgroundColor = 'transparent';\n                    e.currentTarget.style.color = 'white';\n                  }\n                },\n                tabIndex: 0,\n                children: label\n              }, key, false, {\n                fileName: _jsxFileName,\n                lineNumber: 435,\n                columnNumber: 23\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 16\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: 6,\n            color: 'white'\n          },\n          children: \"\\u58C1\\u7EB8\\u7C7B\\u578B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 13\n        }, this), wallpaperTypes.map(({\n          value,\n          label\n        }) => /*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            marginRight: 20,\n            cursor: 'pointer',\n            color: 'white'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"wallpaperType\",\n            value: value,\n            checked: selectedType === value,\n            onChange: handleTypeChange,\n            style: {\n              marginRight: 6\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 17\n          }, this), label]\n        }, value, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 11\n      }, this), (selectedType === 'image' || selectedType === 'video') && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 16\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"mediaSrc\",\n          style: {\n            display: 'block',\n            marginBottom: 6,\n            color: 'white'\n          },\n          children: selectedType === 'image' ? '图片地址(URL或上传到服务器 )' : '视频地址(URL或上传到服务器)'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"mediaSrc\",\n          type: \"text\",\n          value: mediaSrc,\n          onChange: handleMediaSrcChange,\n          placeholder: selectedType === 'image' ? '例如 https://example.com/bg.jpg' : '例如 https://example.com/bg.mp4 ',\n          style: {\n            width: '100%',\n            padding: 8,\n            borderRadius: 4,\n            border: 'none',\n            fontSize: 16,\n            backgroundColor: 'rgba(255,255,255,0.1)',\n            color: 'white'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 12\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"bg-file-upload\",\n            style: frostedGlassBtnStyle,\n            children: \"\\u9009\\u62E9\\u6587\\u4EF6\\u4E0A\\u4F20\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"bg-file-upload\",\n            type: \"file\",\n            accept: \"image/*,video/*\",\n            onChange: handleFileChange,\n            style: {\n              display: 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 516,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleFileUpload,\n            style: {\n              ...frostedGlassBtnStyle,\n              marginLeft: 8\n            },\n            children: \"\\u4E0A\\u4F20\\u80CC\\u666F\\u6587\\u4EF6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 17\n          }, this), uploadStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: '8px',\n              color: uploadStatus.includes('失败') ? 'red' : 'white',\n              fontSize: 13\n            },\n            children: uploadStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 509,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 13\n      }, this), selectedType === 'camera' && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 16\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"cameraSelect\",\n          style: {\n            display: 'block',\n            marginBottom: 6,\n            color: 'white'\n          },\n          children: \"\\u9009\\u62E9\\u6444\\u50CF\\u5934\\u8BBE\\u5907\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: dropdownWrapperStyle,\n          ref: cameraMenuRef,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"cameraSelect\",\n            role: \"button\",\n            tabIndex: 0,\n            onClick: () => {\n              if (availableCameras.length > 0) setCameraMenuOpen(!cameraMenuOpen);\n            },\n            onKeyDown: e => {\n              if ((e.key === 'Enter' || e.key === ' ') && availableCameras.length > 0) {\n                e.preventDefault();\n                setCameraMenuOpen(!cameraMenuOpen);\n              }\n            },\n            style: {\n              ...dropdownHeaderStyle,\n              color: availableCameras.length > 0 ? 'white' : 'rgba(255,255,255,0.4)',\n              backgroundColor: availableCameras.length > 0 ? dropdownHeaderStyle.backgroundColor : 'rgba(255,255,255,0.1)',\n              cursor: availableCameras.length > 0 ? 'pointer' : 'not-allowed',\n              borderColor: availableCameras.length > 0 ? 'rgba(255,255,255,0.6)' : 'rgba(255,255,255,0.2)'\n            },\n            \"aria-haspopup\": \"listbox\",\n            \"aria-expanded\": cameraMenuOpen,\n            \"aria-labelledby\": \"cameraSelect\",\n            children: [availableCameras.length === 0 ? '无可用摄像头设备' : ((_availableCameras$fin = availableCameras.find(d => d.deviceId === selectedCameraId)) === null || _availableCameras$fin === void 0 ? void 0 : _availableCameras$fin.label) || `摄像头 ${selectedCameraId || ''}` || '请选择', /*#__PURE__*/_jsxDEV(\"svg\", {\n              style: {\n                width: 18,\n                height: 18,\n                transform: cameraMenuOpen ? 'rotate(180deg)' : undefined,\n                transition: 'transform 0.3s'\n              },\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"white\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              children: /*#__PURE__*/_jsxDEV(\"polyline\", {\n                points: \"6 9 12 15 18 9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 582,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 573,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 546,\n            columnNumber: 17\n          }, this), cameraMenuOpen && /*#__PURE__*/_jsxDEV(\"ul\", {\n            role: \"listbox\",\n            tabIndex: -1,\n            \"aria-activedescendant\": selectedCameraId,\n            style: dropdownListStyle,\n            children: availableCameras.map(device => {\n              const isSelected = device.deviceId === selectedCameraId;\n              return /*#__PURE__*/_jsxDEV(\"li\", {\n                id: device.deviceId,\n                role: \"option\",\n                \"aria-selected\": isSelected,\n                onClick: () => handleCameraSelect(device.deviceId),\n                onKeyDown: e => {\n                  if (e.key === 'Enter' || e.key === ' ') {\n                    e.preventDefault();\n                    handleCameraSelect(device.deviceId);\n                  }\n                },\n                style: {\n                  padding: '10px 14px',\n                  cursor: 'pointer',\n                  backgroundColor: isSelected ? '#00e5ff' : 'transparent',\n                  color: isSelected ? '#fff' : 'white',\n                  fontWeight: isSelected ? '700' : '500',\n                  transition: 'background-color 0.2s, color 0.2s'\n                },\n                onMouseEnter: e => {\n                  if (!isSelected) {\n                    e.currentTarget.style.backgroundColor = 'rgba(0, 229, 255, 0.15)';\n                    e.currentTarget.style.color = '#00e5ff';\n                  }\n                },\n                onMouseLeave: e => {\n                  if (!isSelected) {\n                    e.currentTarget.style.backgroundColor = 'transparent';\n                    e.currentTarget.style.color = 'white';\n                  }\n                },\n                tabIndex: 0,\n                children: device.label || `摄像头 ${device.deviceId}`\n              }, device.deviceId, false, {\n                fileName: _jsxFileName,\n                lineNumber: 595,\n                columnNumber: 25\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 15\n        }, this), cameraError && /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: 'orange',\n            marginTop: 6\n          },\n          children: cameraError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 31\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 543,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSave,\n        style: buttonStyle,\n        children: \"\\u4FDD\\u5B58\\u8BBE\\u7F6E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 639,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\u9884\\u89C8\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 643,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            borderRadius: 8,\n            padding: 10,\n            backgroundColor: 'rgba(0,0,0,0.3)',\n            backdropFilter: 'blur(10px)',\n            WebkitBackdropFilter: 'blur(10px)'\n          },\n          children: renderPreview()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 642,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: () => setPanelResetFolded(!panelResetFolded),\n      style: foldHeaderStyle,\n      \"aria-expanded\": !panelResetFolded,\n      \"aria-controls\": \"panelResetPanel\",\n      tabIndex: 0,\n      onKeyDown: e => {\n        if (e.key === 'Enter' || e.key === ' ') setPanelResetFolded(!panelResetFolded);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"\\u9762\\u677F\\u4F4D\\u7F6E\\u91CD\\u7F6E (\\u70B9\\u51FB\", panelResetFolded ? '展开' : '收起', \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 659,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          fontSize: 18\n        },\n        children: panelResetFolded ? '+' : '−'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 660,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 651,\n      columnNumber: 7\n    }, this), !panelResetFolded && /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"panelResetPanel\",\n      style: panelContainerStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: resetAllPanels,\n        style: buttonStyle,\n        children: \"\\u91CD\\u7F6E\\u6240\\u6709\\u9762\\u677F\\u5230\\u9ED8\\u8BA4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 664,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            color: 'white'\n          },\n          children: \"\\u91CD\\u7F6E\\u5355\\u4E2A\\u9762\\u677F\\u4F4D\\u7F6E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 668,\n          columnNumber: 13\n        }, this), panels.map(({\n          id,\n          left,\n          top,\n          width,\n          height\n        }) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            marginBottom: 10,\n            borderRadius: 4,\n            padding: 10,\n            backgroundColor: 'rgba(255, 255, 255, 0.05)',\n            color: 'white',\n            userSelect: 'none'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 685,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: 12,\n                color: '#bbb'\n              },\n              children: [\"\\u5F53\\u524D\\uFF1A\", left, \",\", top, \"\\uFF0C\\u5927\\u5C0F\\uFF1A\", width, \"x\", height]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 686,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 684,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => resetSinglePanel(id),\n            style: resetSingleBtnStyle,\n            children: \"\\u91CD\\u7F6E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 690,\n            columnNumber: 17\n          }, this)]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 667,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 663,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: () => setServerUrlConfigFolded(!serverUrlConfigFolded),\n      style: foldHeaderStyle,\n      \"aria-expanded\": !serverUrlConfigFolded,\n      \"aria-controls\": \"serverUrlConfigPanel\",\n      tabIndex: 0,\n      onKeyDown: e => {\n        if (e.key === 'Enter' || e.key === ' ') setServerUrlConfigFolded(!serverUrlConfigFolded);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"\\u524D\\u7AEF\\u9875\\u9762\\u670D\\u52A1\\u5730\\u5740\\u8BBE\\u7F6E (\\u70B9\\u51FB\", serverUrlConfigFolded ? '展开' : '收起', \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 707,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          fontSize: 18\n        },\n        children: serverUrlConfigFolded ? '+' : '−'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 708,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 699,\n      columnNumber: 7\n    }, this), !serverUrlConfigFolded && /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"serverUrlConfigPanel\",\n      style: panelContainerStyle,\n      children: /*#__PURE__*/_jsxDEV(ServerUrlConfig, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 713,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 711,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 373,\n    columnNumber: 5\n  }, this);\n}\n// CameraPreview 组件保持不变\n_s(Settings, \"2yrK3GfSw8eknlWYUN5jZ3mYJOk=\");\n_c = Settings;\nfunction CameraPreview({\n  cameraId\n}) {\n  _s2();\n  const videoRef = React.useRef(null);\n  const [error, setError] = React.useState(null);\n  React.useEffect(() => {\n    if (!cameraId) {\n      setError('未选择摄像头');\n      return;\n    }\n    setError(null);\n    let stream;\n    const constraints = {\n      video: {\n        deviceId: {\n          exact: cameraId\n        }\n      },\n      audio: false\n    };\n    async function startStream() {\n      try {\n        stream = await navigator.mediaDevices.getUserMedia(constraints);\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n      } catch {\n        setError('无法访问摄像头，可能未授权或设备异常');\n      }\n    }\n    startStream();\n    return () => {\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n      if (videoRef.current) {\n        videoRef.current.srcObject = null;\n      }\n    };\n  }, [cameraId]);\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: 'red'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 756,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"video\", {\n    ref: videoRef,\n    style: {\n      width: '100%',\n      maxHeight: 300,\n      borderRadius: 8,\n      backgroundColor: '#000'\n    },\n    muted: true,\n    playsInline: true,\n    autoPlay: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 759,\n    columnNumber: 5\n  }, this);\n}\n// isValidUrl 保持不变\n_s2(CameraPreview, \"Z4/Bk+yDXdHnVi24D9ydZvaMMK0=\");\n_c2 = CameraPreview;\nfunction isValidUrl(string) {\n  try {\n    new URL(string);\n    return true;\n  } catch {\n    return false;\n  }\n}\nvar _c, _c2;\n$RefreshReg$(_c, \"Settings\");\n$RefreshReg$(_c2, \"CameraPreview\");","map":{"version":3,"names":["React","useState","useEffect","useRef","ServerUrlConfig","jsxDEV","_jsxDEV","menuItems","key","label","wallpaperTypes","value","Settings","wallpaperSettings","setWallpaperSettings","panels","resetAllPanels","resetSinglePanel","_s","_menuItems$find","_availableCameras$fin","selectedMenu","setSelectedMenu","selectedType","setSelectedType","mediaSrc","setMediaSrc","availableCameras","setAvailableCameras","selectedCameraId","setSelectedCameraId","cameraError","setCameraError","wallpaperFolded","setWallpaperFolded","panelResetFolded","setPanelResetFolded","serverUrlConfigFolded","setServerUrlConfigFolded","menuOpen","setMenuOpen","menuRef","cameraMenuOpen","setCameraMenuOpen","cameraMenuRef","uploadStatus","setUploadStatus","cfg","type","fetchCameras","devices","navigator","mediaDevices","enumerateDevices","videoDevices","filter","d","kind","some","deviceId","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleMenuSelect","handleCameraSelect","handleTypeChange","e","newType","length","handleMediaSrcChange","handleFileChange","file","files","name","uploadBackgroundFile","fileToUpload","serverUrls","savedUrls","localStorage","getItem","JSON","parse","console","error","UPLOAD_BG_FILE_URL","uploadBgFileUrl","uploadFileUrl","validExtensions","fileExtension","split","pop","toLowerCase","includes","validPrefixes","hasValidPrefix","prefix","startsWith","newFileName","formData","FormData","renamedFile","File","append","log","originalName","newName","size","url","response","fetch","method","body","headers","responseText","text","status","result","Error","substring","ok","filePath","message","handleFileUpload","preventDefault","fileInput","getElementById","handleSave","valueToSave","trim","isValidUrl","alert","prev","renderPreview","src","alt","style","maxWidth","maxHeight","borderRadius","objectFit","backgroundColor","onError","currentTarget","fileName","_jsxFileName","lineNumber","columnNumber","controls","muted","loop","autoPlay","color","children","CameraPreview","cameraId","foldHeaderStyle","cursor","userSelect","display","justifyContent","alignItems","padding","backdropFilter","WebkitBackdropFilter","border","panelContainerStyle","marginBottom","inputSelectStyle","width","fontSize","outline","boxSizing","buttonStyle","fontWeight","resetSingleBtnStyle","dropdownWrapperStyle","position","dropdownHeaderStyle","dropdownListStyle","top","left","right","overflowY","boxShadow","zIndex","dropdownItemStyle","isSelected","transition","dropdownItemHoverStyle","frostedGlassBtnStyle","margin","fontFamily","onClick","tabIndex","onKeyDown","id","htmlFor","ref","role","borderColor","find","item","height","transform","undefined","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","points","map","onMouseEnter","onMouseLeave","marginRight","checked","onChange","placeholder","marginTop","accept","marginLeft","device","_c","_s2","videoRef","setError","stream","constraints","video","exact","audio","startStream","getUserMedia","srcObject","play","getTracks","forEach","track","stop","playsInline","_c2","string","URL","$RefreshReg$"],"sources":["D:/XM/AI-Sphere-Butler/core/client/src/components/Settings.jsx"],"sourcesContent":["// components/Settings.jsx\r\nimport React, { useState, useEffect, useRef } from 'react';\r\n// *** 新增：导入 ServerUrlConfig 组件 ***\r\nimport ServerUrlConfig from './ServerUrlConfig'; // 假设 ServerUrlConfig.jsx 与 Settings.jsx 在同一目录\r\n\r\nconst menuItems = [\r\n  { key: 'home', label: '主页' },\r\n  { key: 'butler', label: '管家' },\r\n  { key: 'car', label: '车' },\r\n  { key: 'homeassistant', label: 'HA' },\r\n  { key: 'ops', label: '运维' },\r\n  { key: 'settings', label: '设置' },\r\n];\r\nconst wallpaperTypes = [\r\n  { value: 'image', label: '静态图片' },\r\n  { value: 'video', label: '视频背景' },\r\n  { value: 'camera', label: '摄像头实时画面' },\r\n];\r\n// ... isValidUrl 和 CameraPreview 保持不变 ...\r\nexport default function Settings({ wallpaperSettings, setWallpaperSettings, panels = [], resetAllPanels, resetSinglePanel }) {\r\n  const [selectedMenu, setSelectedMenu] = useState('home');\r\n  const [selectedType, setSelectedType] = useState('image');\r\n  const [mediaSrc, setMediaSrc] = useState('');\r\n  const [availableCameras, setAvailableCameras] = useState([]);\r\n  const [selectedCameraId, setSelectedCameraId] = useState(null);\r\n  const [cameraError, setCameraError] = useState(null);\r\n  const [wallpaperFolded, setWallpaperFolded] = useState(false);\r\n  const [panelResetFolded, setPanelResetFolded] = useState(true);\r\n  // *** 新增：前端服务地址设置折叠状态 ***\r\n  const [serverUrlConfigFolded, setServerUrlConfigFolded] = useState(true);\r\n\r\n  // 菜单展开状态\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const menuRef = useRef(null);\r\n  // 摄像头设备菜单展开状态\r\n  const [cameraMenuOpen, setCameraMenuOpen] = useState(false);\r\n  const cameraMenuRef = useRef(null);\r\n  // 新增：文件上传状态\r\n  const [uploadStatus, setUploadStatus] = useState('');\r\n  useEffect(() => {\r\n    const cfg = wallpaperSettings[selectedMenu] || { type: 'image', value: '' };\r\n    setSelectedType(cfg.type);\r\n    if (cfg.type === 'camera') {\r\n      setSelectedCameraId(cfg.value || null);\r\n      setMediaSrc('');\r\n    } else {\r\n      setMediaSrc(cfg.value || '');\r\n      setSelectedCameraId(null);\r\n    }\r\n    setCameraError(null);\r\n  }, [selectedMenu, wallpaperSettings]);\r\n  useEffect(() => {\r\n    async function fetchCameras() {\r\n      try {\r\n        const devices = await navigator.mediaDevices.enumerateDevices();\r\n        const videoDevices = devices.filter(d => d.kind === 'videoinput');\r\n        setAvailableCameras(videoDevices);\r\n        if (selectedCameraId && !videoDevices.some(d => d.deviceId === selectedCameraId)) {\r\n          setSelectedCameraId(null);\r\n        }\r\n      } catch {\r\n        setAvailableCameras([]);\r\n        setCameraError('无法获取摄像头设备列表，可能未授予权限或浏览器不支持。');\r\n      }\r\n    }\r\n    fetchCameras();\r\n  }, [selectedCameraId]);\r\n  // 点击页面空白关闭所有菜单\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        setMenuOpen(false);\r\n      }\r\n      if (cameraMenuRef.current && !cameraMenuRef.current.contains(event.target)) {\r\n        setCameraMenuOpen(false);\r\n      }\r\n    }\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n  // 选择菜单项\r\n  const handleMenuSelect = (key) => {\r\n    setSelectedMenu(key);\r\n    setMenuOpen(false);\r\n    setCameraError(null);\r\n  };\r\n  // 选择摄像头设备\r\n  const handleCameraSelect = (deviceId) => {\r\n    setSelectedCameraId(deviceId);\r\n    setCameraMenuOpen(false);\r\n    setCameraError(null);\r\n  };\r\n  const handleTypeChange = (e) => {\r\n    const newType = e.target.value;\r\n    setSelectedType(newType);\r\n    setCameraError(null);\r\n    if (newType === 'camera') {\r\n      setMediaSrc('');\r\n      if (availableCameras.length > 0) {\r\n        setSelectedCameraId(availableCameras[0].deviceId);\r\n      } else {\r\n        setSelectedCameraId(null);\r\n      }\r\n    } else {\r\n      setMediaSrc('');\r\n      setSelectedCameraId(null);\r\n    }\r\n  };\r\n  const handleMediaSrcChange = (e) => setMediaSrc(e.target.value);\r\n  // 新增：处理文件选择\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setUploadStatus(`已选择: ${file.name}`);\r\n    } else {\r\n      setUploadStatus('');\r\n    }\r\n  };\r\n  // *** 修改：上传背景文件函数，使用动态 URL ***\r\n  const uploadBackgroundFile = async (fileToUpload) => {\r\n    // 1. 获取动态配置的 URL\r\n    let serverUrls = {};\r\n    try {\r\n      const savedUrls = localStorage.getItem('serverUrls');\r\n      if (savedUrls) {\r\n        serverUrls = JSON.parse(savedUrls);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"Failed to parse serverUrls from localStorage\", e);\r\n    }\r\n    // 2. 优先使用 uploadBgFileUrl 配置项，如果没有则使用 uploadFileUrl，最后 fallback 到默认值\r\n    const UPLOAD_BG_FILE_URL = serverUrls.uploadBgFileUrl || serverUrls.uploadFileUrl || 'http://192.168.168.77:6010/api/upload_print_file';\r\n\r\n    if (!fileToUpload) return;\r\n    const validExtensions = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'mp4', 'avi', 'mov', 'wmv', 'flv', 'webm'];\r\n    const fileExtension = fileToUpload.name.split('.').pop().toLowerCase();\r\n    if (!validExtensions.includes(fileExtension)) {\r\n      setUploadStatus('上传失败: 不支持的文件类型');\r\n      console.error('不支持的文件类型:', fileExtension);\r\n      return;\r\n    }\r\n    const validPrefixes = ['bg-', 'background-'];\r\n    const hasValidPrefix = validPrefixes.some(prefix => fileToUpload.name.toLowerCase().startsWith(prefix));\r\n    let newFileName = fileToUpload.name;\r\n    if (!hasValidPrefix) {\r\n      newFileName = `bg-${fileToUpload.name}`;\r\n    }\r\n    try {\r\n      setUploadStatus('正在上传背景文件...');\r\n      const formData = new FormData();\r\n      // 创建一个新的 File 对象，使用修改后的文件名\r\n      const renamedFile = new File([fileToUpload], newFileName, { type: fileToUpload.type });\r\n      formData.append('file', renamedFile);\r\n      console.log('准备上传背景文件:', {\r\n        originalName: fileToUpload.name,\r\n        newName: newFileName,\r\n        size: fileToUpload.size,\r\n        type: fileToUpload.type,\r\n        url: UPLOAD_BG_FILE_URL\r\n      });\r\n      const response = await fetch(UPLOAD_BG_FILE_URL, {\r\n        method: 'POST',\r\n        body: formData,\r\n        headers: {\r\n          'Accept': 'application/json'\r\n        },\r\n      });\r\n      const responseText = await response.text();\r\n      console.log(`背景文件上传响应 (状态码: ${response.status}):`, responseText);\r\n      let result;\r\n      try {\r\n        result = JSON.parse(responseText);\r\n      } catch (e) {\r\n        console.error('解析背景文件上传响应JSON失败:', e, '响应文本:', responseText);\r\n        throw new Error(`服务器返回无效JSON: ${responseText.substring(0, 100)}`);\r\n      }\r\n      if (!response.ok) {\r\n        throw new Error(result.error || `上传失败: ${response.status}`);\r\n      }\r\n      // 上传成功后，将返回的文件路径设置到 mediaSrc\r\n      if (result.filePath) {\r\n        setMediaSrc(result.filePath);\r\n      }\r\n      setUploadStatus(result.message || '背景文件上传成功');\r\n      console.log('背景文件上传成功:', result);\r\n    } catch (error) {\r\n      console.error('背景文件上传失败:', error);\r\n      setUploadStatus(`上传失败: ${error.message}`);\r\n    }\r\n  };\r\n  // 新增：处理文件上传\r\n  const handleFileUpload = async (e) => {\r\n    e.preventDefault();\r\n    const fileInput = document.getElementById('bg-file-upload');\r\n    const file = fileInput?.files[0];\r\n    if (file) {\r\n      await uploadBackgroundFile(file);\r\n      // 清空文件输入\r\n      if (fileInput) fileInput.value = '';\r\n    }\r\n  };\r\n  const handleSave = () => {\r\n    let valueToSave = null;\r\n    if (selectedType === 'camera') {\r\n      valueToSave = selectedCameraId || null;\r\n    } else if (selectedType === 'image' || selectedType === 'video') {\r\n      valueToSave = mediaSrc.trim() || null;\r\n    }\r\n    if ((selectedType === 'image' || selectedType === 'video') && valueToSave) {\r\n      if (!isValidUrl(valueToSave) && !valueToSave.startsWith('/')) {\r\n        alert('请输入有效的 URL 地址或以 / 开头的本地路径');\r\n        return;\r\n      }\r\n    }\r\n    setWallpaperSettings(prev => ({\r\n      ...prev,\r\n      [selectedMenu]: {\r\n        type: selectedType,\r\n        value: valueToSave,\r\n      },\r\n    }));\r\n    alert('保存成功');\r\n  };\r\n  const renderPreview = () => {\r\n    if (selectedType === 'image' && mediaSrc) {\r\n      return (\r\n        <img\r\n          src={mediaSrc}\r\n          alt=\"背景图片预览\"\r\n          style={{ maxWidth: '100%', maxHeight: 300, borderRadius: 8, objectFit: 'contain', backgroundColor: '#111' }}\r\n          onError={(e) => { e.currentTarget.src = ''; }}\r\n        />\r\n      );\r\n    }\r\n    if (selectedType === 'video' && mediaSrc) {\r\n      return (\r\n        <video\r\n          src={mediaSrc}\r\n          style={{ maxWidth: '100%', maxHeight: 300, borderRadius: 8, backgroundColor: '#111' }}\r\n          controls\r\n          muted\r\n          loop\r\n          autoPlay\r\n        />\r\n      );\r\n    }\r\n    if (selectedType === 'camera') {\r\n      if (availableCameras.length === 0) {\r\n        return <div style={{ color: 'orange' }}>无可用摄像头设备或未授权访问摄像头。</div>;\r\n      }\r\n      return (\r\n        <CameraPreview cameraId={selectedCameraId} />\r\n      );\r\n    }\r\n    return <div style={{ color: '#666' }}>请选择壁纸类型并输入或选择资源。</div>;\r\n  };\r\n  // 样式定义\r\n  const foldHeaderStyle = {\r\n    cursor: 'pointer',\r\n    userSelect: 'none',\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: '10px 15px',\r\n    borderRadius: '6px',\r\n    backgroundColor: 'rgba(0, 229, 255, 0.1)', // 磨砂浅蓝半透明\r\n    backdropFilter: 'blur(12px)',\r\n    WebkitBackdropFilter: 'blur(12px)',\r\n    color: 'white',\r\n    border: 'none', // 无边框\r\n  };\r\n  const panelContainerStyle = {\r\n    padding: 12,\r\n    borderRadius: 6,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.15)', // 白色半透明磨砂背景\r\n    backdropFilter: 'blur(12px)',\r\n    WebkitBackdropFilter: 'blur(12px)',\r\n    color: '#222',\r\n    marginBottom: 20,\r\n  };\r\n  const inputSelectStyle = {\r\n    width: '100%',\r\n    padding: 8,\r\n    borderRadius: 4,\r\n    border: 'none',\r\n    fontSize: 16,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.08)',\r\n    color: '#222',\r\n    outline: 'none',\r\n    boxSizing: 'border-box',\r\n  };\r\n  const buttonStyle = {\r\n    padding: '10px 20px',\r\n    backgroundColor: 'rgba(255, 255, 255, 0.7)',\r\n    color: '#222',\r\n    fontWeight: 'bold',\r\n    border: 'none',\r\n    borderRadius: 6,\r\n    cursor: 'pointer',\r\n    userSelect: 'none',\r\n  };\r\n  const resetSingleBtnStyle = {\r\n    padding: '4px 10px',\r\n    borderRadius: 4,\r\n    border: 'none',\r\n    backgroundColor: 'rgba(0, 123, 255, 0.6)',\r\n    color: 'white',\r\n    cursor: 'pointer',\r\n    userSelect: 'none',\r\n  };\r\n  // 自定义选择菜单样式（菜单项、摄像头）\r\n  const dropdownWrapperStyle = {\r\n    position: 'relative',\r\n    userSelect: 'none',\r\n  };\r\n  const dropdownHeaderStyle = {\r\n    padding: '10px 14px',\r\n    borderRadius: 6,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.25)',\r\n    backdropFilter: 'blur(10px)',\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n    border: '1px solid rgba(255,255,255,0.4)',\r\n    color: '#222',\r\n    fontWeight: '600',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  };\r\n  const dropdownListStyle = {\r\n    position: 'absolute',\r\n    top: 'calc(100% + 6px)',\r\n    left: 0,\r\n    right: 0,\r\n    maxHeight: 180,\r\n    overflowY: 'auto',\r\n    borderRadius: 8,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.15)',\r\n    backdropFilter: 'blur(12px)',\r\n    WebkitBackdropFilter: 'blur(12px)',\r\n    boxShadow: '0 8px 24px rgba(0,0,0,0.12)',\r\n    zIndex: 1000,\r\n  };\r\n  const dropdownItemStyle = (isSelected) => ({\r\n    padding: '10px 14px',\r\n    cursor: 'pointer',\r\n    backgroundColor: isSelected ? '#00e5ff' : 'transparent',\r\n    color: isSelected ? '#fff' : '#222',\r\n    fontWeight: isSelected ? '700' : '500',\r\n    transition: 'background-color 0.2s, color 0.2s',\r\n  });\r\n  const dropdownItemHoverStyle = {\r\n    backgroundColor: 'rgba(0, 229, 255, 0.15)',\r\n    color: '#00e5ff',\r\n  };\r\n  // 新增：磨砂玻璃按钮样式（与 OldWebRTC 中的样式保持一致）\r\n  const frostedGlassBtnStyle = {\r\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\r\n    border: '1px solid rgba(255, 255, 255, 0.3)',\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    padding: '8px 16px',\r\n    cursor: 'pointer',\r\n    borderRadius: 4,\r\n    outline: 'none',\r\n    transition: 'all 0.3s',\r\n    fontSize: 14,\r\n    backdropFilter: 'blur(10px)',\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)',\r\n  };\r\n  return (\r\n    <div style={{ color: 'white', maxWidth: 700, margin: 'auto', fontFamily: 'sans-serif' }}>\r\n      {/* 壁纸设置折叠头 */}\r\n      <div\r\n        onClick={() => setWallpaperFolded(!wallpaperFolded)}\r\n        style={foldHeaderStyle}\r\n        aria-expanded={!wallpaperFolded}\r\n        aria-controls=\"wallpaperSettingsPanel\"\r\n        tabIndex={0}\r\n        onKeyDown={e => { if (e.key === 'Enter' || e.key === ' ') setWallpaperFolded(!wallpaperFolded); }}\r\n      >\r\n        <span>壁纸设置 (点击{wallpaperFolded ? '展开' : '收起'})</span>\r\n        <span style={{ fontSize: 18 }}>{wallpaperFolded ? '+' : '−'}</span>\r\n      </div>\r\n      {!wallpaperFolded && (\r\n        <div id=\"wallpaperSettingsPanel\" style={panelContainerStyle}>\r\n          {/* 自定义菜单项选择 */}\r\n          <div style={{ marginBottom: 16 }}>\r\n            <label htmlFor=\"menuSelect\" style={{ display: 'block', marginBottom: 6, color: 'white' }}>选择菜单项</label>\r\n            <div style={dropdownWrapperStyle} ref={menuRef}>\r\n              <div\r\n                id=\"menuSelect\"\r\n                role=\"button\"\r\n                tabIndex={0}\r\n                onClick={() => setMenuOpen(!menuOpen)}\r\n                onKeyDown={e => {\r\n                  if (e.key === 'Enter' || e.key === ' ') {\r\n                    e.preventDefault();\r\n                    setMenuOpen(!menuOpen);\r\n                  }\r\n                }}\r\n                style={{\r\n                  ...dropdownHeaderStyle,\r\n                  color: 'white',\r\n                  borderColor: 'rgba(255,255,255,0.6)', // 让边框颜色更亮\r\n                }}\r\n                aria-haspopup=\"listbox\"\r\n                aria-expanded={menuOpen}\r\n                aria-labelledby=\"menuSelect\"\r\n              >\r\n                {menuItems.find(item => item.key === selectedMenu)?.label || '请选择'}\r\n                <svg\r\n                  style={{ width: 18, height: 18, transform: menuOpen ? 'rotate(180deg)' : undefined, transition: 'transform 0.3s' }}\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"white\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <polyline points=\"6 9 12 15 18 9\" />\r\n                </svg>\r\n              </div>\r\n              {menuOpen && (\r\n                <ul\r\n                  role=\"listbox\"\r\n                  tabIndex={-1}\r\n                  aria-activedescendant={selectedMenu}\r\n                  style={dropdownListStyle}\r\n                >\r\n                  {menuItems.map(({ key, label }) => {\r\n                    const isSelected = key === selectedMenu;\r\n                    return (\r\n                      <li\r\n                        id={key}\r\n                        key={key}\r\n                        role=\"option\"\r\n                        aria-selected={isSelected}\r\n                        onClick={() => handleMenuSelect(key)}\r\n                        onKeyDown={e => {\r\n                          if (e.key === 'Enter' || e.key === ' ') {\r\n                            e.preventDefault();\r\n                            handleMenuSelect(key);\r\n                          }\r\n                        }}\r\n                        style={{\r\n                          padding: '10px 14px',\r\n                          cursor: 'pointer',\r\n                          backgroundColor: isSelected ? '#00e5ff' : 'transparent',\r\n                          color: isSelected ? '#fff' : 'white',\r\n                          fontWeight: isSelected ? '700' : '500',\r\n                          transition: 'background-color 0.2s, color 0.2s',\r\n                        }}\r\n                        onMouseEnter={e => {\r\n                          if (!isSelected) {\r\n                            e.currentTarget.style.backgroundColor = 'rgba(0, 229, 255, 0.15)';\r\n                            e.currentTarget.style.color = '#00e5ff';\r\n                          }\r\n                        }}\r\n                        onMouseLeave={e => {\r\n                          if (!isSelected) {\r\n                            e.currentTarget.style.backgroundColor = 'transparent';\r\n                            e.currentTarget.style.color = 'white';\r\n                          }\r\n                        }}\r\n                        tabIndex={0}\r\n                      >\r\n                        {label}\r\n                      </li>\r\n                    );\r\n                  })}\r\n                </ul>\r\n              )}\r\n            </div>\r\n          </div>\r\n          {/* 壁纸类型 */}\r\n          <div style={{ marginBottom: 16 }}>\r\n            <label style={{ display: 'block', marginBottom: 6, color: 'white' }}>壁纸类型</label>\r\n            {wallpaperTypes.map(({ value, label }) => (\r\n              <label key={value} style={{ marginRight: 20, cursor: 'pointer', color: 'white' }}>\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"wallpaperType\"\r\n                  value={value}\r\n                  checked={selectedType === value}\r\n                  onChange={handleTypeChange}\r\n                  style={{ marginRight: 6 }}\r\n                />\r\n                {label}\r\n              </label>\r\n            ))}\r\n          </div>\r\n          {/* 图片或视频地址输入 */}\r\n          {(selectedType === 'image' || selectedType === 'video') && (\r\n            <div style={{ marginBottom: 16 }}>\r\n              <label htmlFor=\"mediaSrc\" style={{ display: 'block', marginBottom: 6, color: 'white' }}>\r\n                {selectedType === 'image' ? '图片地址(URL或上传到服务器 )' : '视频地址(URL或上传到服务器)'}\r\n              </label>\r\n              <input\r\n                id=\"mediaSrc\"\r\n                type=\"text\"\r\n                value={mediaSrc}\r\n                onChange={handleMediaSrcChange}\r\n                placeholder={selectedType === 'image' ? '例如 https://example.com/bg.jpg' : '例如 https://example.com/bg.mp4 '}\r\n                style={{ width: '100%', padding: 8, borderRadius: 4, border: 'none', fontSize: 16, backgroundColor: 'rgba(255,255,255,0.1)', color: 'white' }}\r\n              />\r\n              {/* 新增：文件上传区域 */}\r\n              <div style={{ marginTop: 12 }}>\r\n                <label\r\n                  htmlFor=\"bg-file-upload\"\r\n                  style={frostedGlassBtnStyle}\r\n                >\r\n                  选择文件上传\r\n                </label>\r\n                <input\r\n                  id=\"bg-file-upload\"\r\n                  type=\"file\"\r\n                  accept=\"image/*,video/*\"\r\n                  onChange={handleFileChange}\r\n                  style={{ display: 'none' }}\r\n                />\r\n                <button\r\n                  onClick={handleFileUpload}\r\n                  style={{ ...frostedGlassBtnStyle, marginLeft: 8 }}\r\n                >\r\n                  上传背景文件\r\n                </button>\r\n                {uploadStatus && (\r\n                  <div style={{\r\n                    marginTop: '8px',\r\n                    color: uploadStatus.includes('失败') ? 'red' : 'white',\r\n                    fontSize: 13\r\n                  }}>\r\n                    {uploadStatus}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n          {/* 摄像头设备选择改成自定义菜单 */}\r\n          {selectedType === 'camera' && (\r\n            <div style={{ marginBottom: 16 }}>\r\n              <label htmlFor=\"cameraSelect\" style={{ display: 'block', marginBottom: 6, color: 'white' }}>选择摄像头设备</label>\r\n              <div style={dropdownWrapperStyle} ref={cameraMenuRef}>\r\n                <div\r\n                  id=\"cameraSelect\"\r\n                  role=\"button\"\r\n                  tabIndex={0}\r\n                  onClick={() => {\r\n                    if (availableCameras.length > 0) setCameraMenuOpen(!cameraMenuOpen);\r\n                  }}\r\n                  onKeyDown={e => {\r\n                    if ((e.key === 'Enter' || e.key === ' ') && availableCameras.length > 0) {\r\n                      e.preventDefault();\r\n                      setCameraMenuOpen(!cameraMenuOpen);\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    ...dropdownHeaderStyle,\r\n                    color: availableCameras.length > 0 ? 'white' : 'rgba(255,255,255,0.4)',\r\n                    backgroundColor: availableCameras.length > 0 ? dropdownHeaderStyle.backgroundColor : 'rgba(255,255,255,0.1)',\r\n                    cursor: availableCameras.length > 0 ? 'pointer' : 'not-allowed',\r\n                    borderColor: availableCameras.length > 0 ? 'rgba(255,255,255,0.6)' : 'rgba(255,255,255,0.2)',\r\n                  }}\r\n                  aria-haspopup=\"listbox\"\r\n                  aria-expanded={cameraMenuOpen}\r\n                  aria-labelledby=\"cameraSelect\"\r\n                >\r\n                  {availableCameras.length === 0\r\n                    ? '无可用摄像头设备'\r\n                    : (availableCameras.find(d => d.deviceId === selectedCameraId)?.label || `摄像头 ${selectedCameraId || ''}`) || '请选择'}\r\n                  <svg\r\n                    style={{ width: 18, height: 18, transform: cameraMenuOpen ? 'rotate(180deg)' : undefined, transition: 'transform 0.3s' }}\r\n                    viewBox=\"0 0 24 24\"\r\n                    fill=\"none\"\r\n                    stroke=\"white\"\r\n                    strokeWidth=\"2\"\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                  >\r\n                    <polyline points=\"6 9 12 15 18 9\" />\r\n                  </svg>\r\n                </div>\r\n                {cameraMenuOpen && (\r\n                  <ul\r\n                    role=\"listbox\"\r\n                    tabIndex={-1}\r\n                    aria-activedescendant={selectedCameraId}\r\n                    style={dropdownListStyle}\r\n                  >\r\n                    {availableCameras.map((device) => {\r\n                      const isSelected = device.deviceId === selectedCameraId;\r\n                      return (\r\n                        <li\r\n                          id={device.deviceId}\r\n                          key={device.deviceId}\r\n                          role=\"option\"\r\n                          aria-selected={isSelected}\r\n                          onClick={() => handleCameraSelect(device.deviceId)}\r\n                          onKeyDown={e => {\r\n                            if (e.key === 'Enter' || e.key === ' ') {\r\n                              e.preventDefault();\r\n                              handleCameraSelect(device.deviceId);\r\n                            }\r\n                          }}\r\n                          style={{\r\n                            padding: '10px 14px',\r\n                            cursor: 'pointer',\r\n                            backgroundColor: isSelected ? '#00e5ff' : 'transparent',\r\n                            color: isSelected ? '#fff' : 'white',\r\n                            fontWeight: isSelected ? '700' : '500',\r\n                            transition: 'background-color 0.2s, color 0.2s',\r\n                          }}\r\n                          onMouseEnter={e => {\r\n                            if (!isSelected) {\r\n                              e.currentTarget.style.backgroundColor = 'rgba(0, 229, 255, 0.15)';\r\n                              e.currentTarget.style.color = '#00e5ff';\r\n                            }\r\n                          }}\r\n                          onMouseLeave={e => {\r\n                            if (!isSelected) {\r\n                              e.currentTarget.style.backgroundColor = 'transparent';\r\n                              e.currentTarget.style.color = 'white';\r\n                            }\r\n                          }}\r\n                          tabIndex={0}\r\n                        >\r\n                          {device.label || `摄像头 ${device.deviceId}`}\r\n                        </li>\r\n                      );\r\n                    })}\r\n                  </ul>\r\n                )}\r\n              </div>\r\n              {cameraError && <p style={{ color: 'orange', marginTop: 6 }}>{cameraError}</p>}\r\n            </div>\r\n          )}\r\n          <button onClick={handleSave} style={buttonStyle}>\r\n            保存设置\r\n          </button>\r\n          <div>\r\n            <h4>预览</h4>\r\n            <div style={{ borderRadius: 8, padding: 10, backgroundColor: 'rgba(0,0,0,0.3)', backdropFilter: 'blur(10px)', WebkitBackdropFilter: 'blur(10px)' }}>\r\n              {renderPreview()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* 面板重置折叠头 */}\r\n      <div\r\n        onClick={() => setPanelResetFolded(!panelResetFolded)}\r\n        style={foldHeaderStyle}\r\n        aria-expanded={!panelResetFolded}\r\n        aria-controls=\"panelResetPanel\"\r\n        tabIndex={0}\r\n        onKeyDown={e => { if (e.key === 'Enter' || e.key === ' ') setPanelResetFolded(!panelResetFolded); }}\r\n      >\r\n        <span>面板位置重置 (点击{panelResetFolded ? '展开' : '收起'})</span>\r\n        <span style={{ fontSize: 18 }}>{panelResetFolded ? '+' : '−'}</span>\r\n      </div>\r\n      {!panelResetFolded && (\r\n        <div id=\"panelResetPanel\" style={panelContainerStyle}>\r\n          <button onClick={resetAllPanels} style={buttonStyle}>\r\n            重置所有面板到默认\r\n          </button>\r\n          <div>\r\n            <h4 style={{ color: 'white' }}>重置单个面板位置</h4>\r\n            {panels.map(({ id, left, top, width, height }) => (\r\n              <div\r\n                key={id}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'space-between',\r\n                  marginBottom: 10,\r\n                  borderRadius: 4,\r\n                  padding: 10,\r\n                  backgroundColor: 'rgba(255, 255, 255, 0.05)',\r\n                  color: 'white',\r\n                  userSelect: 'none',\r\n                }}\r\n              >\r\n                <div>\r\n                  <strong>{id}</strong>\r\n                  <div style={{ fontSize: 12, color: '#bbb' }}>\r\n                    当前：{left},{top}，大小：{width}x{height}\r\n                  </div>\r\n                </div>\r\n                <button onClick={() => resetSinglePanel(id)} style={resetSingleBtnStyle}>\r\n                  重置\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* *** 新增：前端服务地址设置折叠头和面板，独立状态控制 *** */}\r\n      <div\r\n        onClick={() => setServerUrlConfigFolded(!serverUrlConfigFolded)}\r\n        style={foldHeaderStyle}\r\n        aria-expanded={!serverUrlConfigFolded}\r\n        aria-controls=\"serverUrlConfigPanel\"\r\n        tabIndex={0}\r\n        onKeyDown={e => { if (e.key === 'Enter' || e.key === ' ') setServerUrlConfigFolded(!serverUrlConfigFolded); }}\r\n      >\r\n        <span>前端页面服务地址设置 (点击{serverUrlConfigFolded ? '展开' : '收起'})</span>\r\n        <span style={{ fontSize: 18 }}>{serverUrlConfigFolded ? '+' : '−'}</span>\r\n      </div>\r\n      {!serverUrlConfigFolded && (\r\n        <div id=\"serverUrlConfigPanel\" style={panelContainerStyle}>\r\n          {/* *** 使用导入的 ServerUrlConfig 组件 *** */}\r\n          <ServerUrlConfig />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n// CameraPreview 组件保持不变\r\nfunction CameraPreview({ cameraId }) {\r\n  const videoRef = React.useRef(null);\r\n  const [error, setError] = React.useState(null);\r\n  React.useEffect(() => {\r\n    if (!cameraId) {\r\n      setError('未选择摄像头');\r\n      return;\r\n    }\r\n    setError(null);\r\n    let stream;\r\n    const constraints = {\r\n      video: { deviceId: { exact: cameraId } },\r\n      audio: false,\r\n    };\r\n    async function startStream() {\r\n      try {\r\n        stream = await navigator.mediaDevices.getUserMedia(constraints);\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = stream;\r\n          await videoRef.current.play();\r\n        }\r\n      } catch {\r\n        setError('无法访问摄像头，可能未授权或设备异常');\r\n      }\r\n    }\r\n    startStream();\r\n    return () => {\r\n      if (stream) {\r\n        stream.getTracks().forEach(track => track.stop());\r\n      }\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = null;\r\n      }\r\n    };\r\n  }, [cameraId]);\r\n  if (error) {\r\n    return <div style={{ color: 'red' }}>{error}</div>;\r\n  }\r\n  return (\r\n    <video\r\n      ref={videoRef}\r\n      style={{ width: '100%', maxHeight: 300, borderRadius: 8, backgroundColor: '#000' }}\r\n      muted\r\n      playsInline\r\n      autoPlay\r\n    />\r\n  );\r\n}\r\n// isValidUrl 保持不变\r\nfunction isValidUrl(string) {\r\n  try {\r\n    new URL(string);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}