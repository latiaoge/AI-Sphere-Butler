{"ast":null,"code":"import _objectSpread from\"D:/XM/AI-Sphere-Butler/core/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// components/Settings.jsx\nimport React,{useState,useEffect,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const menuItems=[{key:'home',label:'主页'},{key:'butler',label:'管家'},{key:'car',label:'车'},{key:'homeassistant',label:'HA'},{key:'ops',label:'运维'},{key:'settings',label:'设置'}];const wallpaperTypes=[{value:'image',label:'静态图片'},{value:'video',label:'视频背景'},{value:'camera',label:'摄像头实时画面'}];// ... isValidUrl 和 CameraPreview 保持不变 ...\nexport default function Settings(_ref){var _menuItems$find,_availableCameras$fin;let{wallpaperSettings,setWallpaperSettings,panels=[],resetAllPanels,resetSinglePanel}=_ref;const[selectedMenu,setSelectedMenu]=useState('home');const[selectedType,setSelectedType]=useState('image');const[mediaSrc,setMediaSrc]=useState('');const[availableCameras,setAvailableCameras]=useState([]);const[selectedCameraId,setSelectedCameraId]=useState(null);const[cameraError,setCameraError]=useState(null);const[wallpaperFolded,setWallpaperFolded]=useState(false);const[panelResetFolded,setPanelResetFolded]=useState(true);// 菜单展开状态\nconst[menuOpen,setMenuOpen]=useState(false);const menuRef=useRef(null);// 摄像头设备菜单展开状态\nconst[cameraMenuOpen,setCameraMenuOpen]=useState(false);const cameraMenuRef=useRef(null);// 新增：文件上传状态\nconst[uploadStatus,setUploadStatus]=useState('');useEffect(()=>{const cfg=wallpaperSettings[selectedMenu]||{type:'image',value:''};setSelectedType(cfg.type);if(cfg.type==='camera'){setSelectedCameraId(cfg.value||null);setMediaSrc('');}else{setMediaSrc(cfg.value||'');setSelectedCameraId(null);}setCameraError(null);},[selectedMenu,wallpaperSettings]);useEffect(()=>{async function fetchCameras(){try{const devices=await navigator.mediaDevices.enumerateDevices();const videoDevices=devices.filter(d=>d.kind==='videoinput');setAvailableCameras(videoDevices);if(selectedCameraId&&!videoDevices.some(d=>d.deviceId===selectedCameraId)){setSelectedCameraId(null);}}catch(_unused){setAvailableCameras([]);setCameraError('无法获取摄像头设备列表，可能未授予权限或浏览器不支持。');}}fetchCameras();},[selectedCameraId]);// 点击页面空白关闭所有菜单\nuseEffect(()=>{function handleClickOutside(event){if(menuRef.current&&!menuRef.current.contains(event.target)){setMenuOpen(false);}if(cameraMenuRef.current&&!cameraMenuRef.current.contains(event.target)){setCameraMenuOpen(false);}}document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[]);// 选择菜单项\nconst handleMenuSelect=key=>{setSelectedMenu(key);setMenuOpen(false);setCameraError(null);};// 选择摄像头设备\nconst handleCameraSelect=deviceId=>{setSelectedCameraId(deviceId);setCameraMenuOpen(false);setCameraError(null);};const handleTypeChange=e=>{const newType=e.target.value;setSelectedType(newType);setCameraError(null);if(newType==='camera'){setMediaSrc('');if(availableCameras.length>0){setSelectedCameraId(availableCameras[0].deviceId);}else{setSelectedCameraId(null);}}else{setMediaSrc('');setSelectedCameraId(null);}};const handleMediaSrcChange=e=>setMediaSrc(e.target.value);// 新增：处理文件选择\nconst handleFileChange=e=>{const file=e.target.files[0];if(file){setUploadStatus(\"\\u5DF2\\u9009\\u62E9: \".concat(file.name));}else{setUploadStatus('');}};// 新增：上传背景文件函数\nconst UPLOAD_BG_FILE_URL='http://192.168.168.77:6010/api/upload_print_file';const uploadBackgroundFile=async fileToUpload=>{if(!fileToUpload)return;const validExtensions=['jpg','jpeg','png','gif','bmp','webp','mp4','avi','mov','wmv','flv','webm'];const fileExtension=fileToUpload.name.split('.').pop().toLowerCase();if(!validExtensions.includes(fileExtension)){setUploadStatus('上传失败: 不支持的文件类型');console.error('不支持的文件类型:',fileExtension);return;}const validPrefixes=['bg-','background-'];const hasValidPrefix=validPrefixes.some(prefix=>fileToUpload.name.toLowerCase().startsWith(prefix));let newFileName=fileToUpload.name;if(!hasValidPrefix){newFileName=\"bg-\".concat(fileToUpload.name);}try{setUploadStatus('正在上传背景文件...');const formData=new FormData();// 创建一个新的 File 对象，使用修改后的文件名\nconst renamedFile=new File([fileToUpload],newFileName,{type:fileToUpload.type});formData.append('file',renamedFile);console.log('准备上传背景文件:',{originalName:fileToUpload.name,newName:newFileName,size:fileToUpload.size,type:fileToUpload.type,url:UPLOAD_BG_FILE_URL});const response=await fetch(UPLOAD_BG_FILE_URL,{method:'POST',body:formData,headers:{'Accept':'application/json'}});const responseText=await response.text();console.log(\"\\u80CC\\u666F\\u6587\\u4EF6\\u4E0A\\u4F20\\u54CD\\u5E94 (\\u72B6\\u6001\\u7801: \".concat(response.status,\"):\"),responseText);let result;try{result=JSON.parse(responseText);}catch(e){console.error('解析背景文件上传响应JSON失败:',e,'响应文本:',responseText);throw new Error(\"\\u670D\\u52A1\\u5668\\u8FD4\\u56DE\\u65E0\\u6548JSON: \".concat(responseText.substring(0,100)));}if(!response.ok){throw new Error(result.error||\"\\u4E0A\\u4F20\\u5931\\u8D25: \".concat(response.status));}// 上传成功后，将返回的文件路径设置到 mediaSrc\nif(result.filePath){setMediaSrc(result.filePath);}setUploadStatus(result.message||'背景文件上传成功');console.log('背景文件上传成功:',result);}catch(error){console.error('背景文件上传失败:',error);setUploadStatus(\"\\u4E0A\\u4F20\\u5931\\u8D25: \".concat(error.message));}};// 新增：处理文件上传\nconst handleFileUpload=async e=>{e.preventDefault();const fileInput=document.getElementById('bg-file-upload');const file=fileInput===null||fileInput===void 0?void 0:fileInput.files[0];if(file){await uploadBackgroundFile(file);// 清空文件输入\nif(fileInput)fileInput.value='';}};const handleSave=()=>{let valueToSave=null;if(selectedType==='camera'){valueToSave=selectedCameraId||null;}else if(selectedType==='image'||selectedType==='video'){valueToSave=mediaSrc.trim()||null;}if((selectedType==='image'||selectedType==='video')&&valueToSave){if(!isValidUrl(valueToSave)&&!valueToSave.startsWith('/')){alert('请输入有效的 URL 地址或以 / 开头的本地路径');return;}}setWallpaperSettings(prev=>_objectSpread(_objectSpread({},prev),{},{[selectedMenu]:{type:selectedType,value:valueToSave}}));alert('保存成功');};const renderPreview=()=>{if(selectedType==='image'&&mediaSrc){return/*#__PURE__*/_jsx(\"img\",{src:mediaSrc,alt:\"\\u80CC\\u666F\\u56FE\\u7247\\u9884\\u89C8\",style:{maxWidth:'100%',maxHeight:300,borderRadius:8,objectFit:'contain',backgroundColor:'#111'},onError:e=>{e.currentTarget.src='';}});}if(selectedType==='video'&&mediaSrc){return/*#__PURE__*/_jsx(\"video\",{src:mediaSrc,style:{maxWidth:'100%',maxHeight:300,borderRadius:8,backgroundColor:'#111'},controls:true,muted:true,loop:true,autoPlay:true});}if(selectedType==='camera'){if(availableCameras.length===0){return/*#__PURE__*/_jsx(\"div\",{style:{color:'orange'},children:\"\\u65E0\\u53EF\\u7528\\u6444\\u50CF\\u5934\\u8BBE\\u5907\\u6216\\u672A\\u6388\\u6743\\u8BBF\\u95EE\\u6444\\u50CF\\u5934\\u3002\"});}return/*#__PURE__*/_jsx(CameraPreview,{cameraId:selectedCameraId});}return/*#__PURE__*/_jsx(\"div\",{style:{color:'#666'},children:\"\\u8BF7\\u9009\\u62E9\\u58C1\\u7EB8\\u7C7B\\u578B\\u5E76\\u8F93\\u5165\\u6216\\u9009\\u62E9\\u8D44\\u6E90\\u3002\"});};// 样式定义\nconst foldHeaderStyle={cursor:'pointer',userSelect:'none',display:'flex',justifyContent:'space-between',alignItems:'center',padding:'10px 15px',borderRadius:'6px',backgroundColor:'rgba(0, 229, 255, 0.1)',// 磨砂浅蓝半透明\nbackdropFilter:'blur(12px)',WebkitBackdropFilter:'blur(12px)',color:'white',border:'none'// 无边框\n};const panelContainerStyle={padding:12,borderRadius:6,backgroundColor:'rgba(255, 255, 255, 0.15)',// 白色半透明磨砂背景\nbackdropFilter:'blur(12px)',WebkitBackdropFilter:'blur(12px)',color:'#222',marginBottom:20};const inputSelectStyle={width:'100%',padding:8,borderRadius:4,border:'none',fontSize:16,backgroundColor:'rgba(255, 255, 255, 0.08)',color:'#222',outline:'none',boxSizing:'border-box'};const buttonStyle={padding:'10px 20px',backgroundColor:'rgba(255, 255, 255, 0.7)',color:'#222',fontWeight:'bold',border:'none',borderRadius:6,cursor:'pointer',userSelect:'none'};const resetSingleBtnStyle={padding:'4px 10px',borderRadius:4,border:'none',backgroundColor:'rgba(0, 123, 255, 0.6)',color:'white',cursor:'pointer',userSelect:'none'};// 自定义选择菜单样式（菜单项、摄像头）\nconst dropdownWrapperStyle={position:'relative',userSelect:'none'};const dropdownHeaderStyle={padding:'10px 14px',borderRadius:6,backgroundColor:'rgba(255, 255, 255, 0.25)',backdropFilter:'blur(10px)',WebkitBackdropFilter:'blur(10px)',border:'1px solid rgba(255,255,255,0.4)',color:'#222',fontWeight:'600',cursor:'pointer',display:'flex',justifyContent:'space-between',alignItems:'center'};const dropdownListStyle={position:'absolute',top:'calc(100% + 6px)',left:0,right:0,maxHeight:180,overflowY:'auto',borderRadius:8,backgroundColor:'rgba(255, 255, 255, 0.15)',backdropFilter:'blur(12px)',WebkitBackdropFilter:'blur(12px)',boxShadow:'0 8px 24px rgba(0,0,0,0.12)',zIndex:1000};const dropdownItemStyle=isSelected=>({padding:'10px 14px',cursor:'pointer',backgroundColor:isSelected?'#00e5ff':'transparent',color:isSelected?'#fff':'#222',fontWeight:isSelected?'700':'500',transition:'background-color 0.2s, color 0.2s'});const dropdownItemHoverStyle={backgroundColor:'rgba(0, 229, 255, 0.15)',color:'#00e5ff'};// 新增：磨砂玻璃按钮样式（与 OldWebRTC 中的样式保持一致）\nconst frostedGlassBtnStyle={backgroundColor:'rgba(255, 255, 255, 0.1)',border:'1px solid rgba(255, 255, 255, 0.3)',color:'white',fontWeight:'bold',padding:'8px 16px',cursor:'pointer',borderRadius:4,outline:'none',transition:'all 0.3s',fontSize:14,backdropFilter:'blur(10px)',WebkitBackdropFilter:'blur(10px)',boxShadow:'0 4px 10px rgba(255, 255, 255, 0.15)'};return/*#__PURE__*/_jsxs(\"div\",{style:{color:'white',maxWidth:700,margin:'auto',fontFamily:'sans-serif'},children:[/*#__PURE__*/_jsxs(\"div\",{onClick:()=>setWallpaperFolded(!wallpaperFolded),style:foldHeaderStyle,\"aria-expanded\":!wallpaperFolded,\"aria-controls\":\"wallpaperSettingsPanel\",tabIndex:0,onKeyDown:e=>{if(e.key==='Enter'||e.key===' ')setWallpaperFolded(!wallpaperFolded);},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u58C1\\u7EB8\\u8BBE\\u7F6E (\\u70B9\\u51FB\",wallpaperFolded?'展开':'收起',\")\"]}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:18},children:wallpaperFolded?'+':'−'})]}),!wallpaperFolded&&/*#__PURE__*/_jsxs(\"div\",{id:\"wallpaperSettingsPanel\",style:panelContainerStyle,children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"menuSelect\",style:{display:'block',marginBottom:6,color:'white'},children:\"\\u9009\\u62E9\\u83DC\\u5355\\u9879\"}),/*#__PURE__*/_jsxs(\"div\",{style:dropdownWrapperStyle,ref:menuRef,children:[/*#__PURE__*/_jsxs(\"div\",{id:\"menuSelect\",role:\"button\",tabIndex:0,onClick:()=>setMenuOpen(!menuOpen),onKeyDown:e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();setMenuOpen(!menuOpen);}},style:_objectSpread(_objectSpread({},dropdownHeaderStyle),{},{color:'white',borderColor:'rgba(255,255,255,0.6)'// 让边框颜色更亮\n}),\"aria-haspopup\":\"listbox\",\"aria-expanded\":menuOpen,\"aria-labelledby\":\"menuSelect\",children:[((_menuItems$find=menuItems.find(item=>item.key===selectedMenu))===null||_menuItems$find===void 0?void 0:_menuItems$find.label)||'请选择',/*#__PURE__*/_jsx(\"svg\",{style:{width:18,height:18,transform:menuOpen?'rotate(180deg)':undefined,transition:'transform 0.3s'},viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"white\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"polyline\",{points:\"6 9 12 15 18 9\"})})]}),menuOpen&&/*#__PURE__*/_jsx(\"ul\",{role:\"listbox\",tabIndex:-1,\"aria-activedescendant\":selectedMenu,style:dropdownListStyle,children:menuItems.map(_ref2=>{let{key,label}=_ref2;const isSelected=key===selectedMenu;return/*#__PURE__*/_jsx(\"li\",{id:key,role:\"option\",\"aria-selected\":isSelected,onClick:()=>handleMenuSelect(key),onKeyDown:e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();handleMenuSelect(key);}},style:{padding:'10px 14px',cursor:'pointer',backgroundColor:isSelected?'#00e5ff':'transparent',color:isSelected?'#fff':'white',fontWeight:isSelected?'700':'500',transition:'background-color 0.2s, color 0.2s'},onMouseEnter:e=>{if(!isSelected){e.currentTarget.style.backgroundColor='rgba(0, 229, 255, 0.15)';e.currentTarget.style.color='#00e5ff';}},onMouseLeave:e=>{if(!isSelected){e.currentTarget.style.backgroundColor='transparent';e.currentTarget.style.color='white';}},tabIndex:0,children:label},key);})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:6,color:'white'},children:\"\\u58C1\\u7EB8\\u7C7B\\u578B\"}),wallpaperTypes.map(_ref3=>{let{value,label}=_ref3;return/*#__PURE__*/_jsxs(\"label\",{style:{marginRight:20,cursor:'pointer',color:'white'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"wallpaperType\",value:value,checked:selectedType===value,onChange:handleTypeChange,style:{marginRight:6}}),label]},value);})]}),(selectedType==='image'||selectedType==='video')&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"mediaSrc\",style:{display:'block',marginBottom:6,color:'white'},children:selectedType==='image'?'图片地址(URL或上传到服务器 )':'视频地址(URL或上传到服务器)'}),/*#__PURE__*/_jsx(\"input\",{id:\"mediaSrc\",type:\"text\",value:mediaSrc,onChange:handleMediaSrcChange,placeholder:selectedType==='image'?'例如 https://example.com/bg.jpg':'例如 https://example.com/bg.mp4 或 /local/path/bg.mp4',style:{width:'100%',padding:8,borderRadius:4,border:'none',fontSize:16,backgroundColor:'rgba(255,255,255,0.1)',color:'white'}}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"bg-file-upload\",style:frostedGlassBtnStyle,children:\"\\u9009\\u62E9\\u6587\\u4EF6\\u4E0A\\u4F20\"}),/*#__PURE__*/_jsx(\"input\",{id:\"bg-file-upload\",type:\"file\",accept:\"image/*,video/*\",onChange:handleFileChange,style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleFileUpload,style:_objectSpread(_objectSpread({},frostedGlassBtnStyle),{},{marginLeft:8}),children:\"\\u4E0A\\u4F20\\u80CC\\u666F\\u6587\\u4EF6\"}),uploadStatus&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'8px',color:uploadStatus.includes('失败')?'red':'white',fontSize:13},children:uploadStatus})]})]}),selectedType==='camera'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"cameraSelect\",style:{display:'block',marginBottom:6,color:'white'},children:\"\\u9009\\u62E9\\u6444\\u50CF\\u5934\\u8BBE\\u5907\"}),/*#__PURE__*/_jsxs(\"div\",{style:dropdownWrapperStyle,ref:cameraMenuRef,children:[/*#__PURE__*/_jsxs(\"div\",{id:\"cameraSelect\",role:\"button\",tabIndex:0,onClick:()=>{// 如果无设备，禁止展开菜单\nif(availableCameras.length>0)setCameraMenuOpen(!cameraMenuOpen);},onKeyDown:e=>{if((e.key==='Enter'||e.key===' ')&&availableCameras.length>0){e.preventDefault();setCameraMenuOpen(!cameraMenuOpen);}},style:_objectSpread(_objectSpread({},dropdownHeaderStyle),{},{color:availableCameras.length>0?'white':'rgba(255,255,255,0.4)',// 设备可用时白色，不可用时透明白\nbackgroundColor:availableCameras.length>0?dropdownHeaderStyle.backgroundColor:'rgba(255,255,255,0.1)',cursor:availableCameras.length>0?'pointer':'not-allowed',borderColor:availableCameras.length>0?'rgba(255,255,255,0.6)':'rgba(255,255,255,0.2)'}),\"aria-haspopup\":\"listbox\",\"aria-expanded\":cameraMenuOpen,\"aria-labelledby\":\"cameraSelect\",children:[availableCameras.length===0?'无可用摄像头设备':((_availableCameras$fin=availableCameras.find(d=>d.deviceId===selectedCameraId))===null||_availableCameras$fin===void 0?void 0:_availableCameras$fin.label)||\"\\u6444\\u50CF\\u5934 \".concat(selectedCameraId||'')||'请选择',/*#__PURE__*/_jsx(\"svg\",{style:{width:18,height:18,transform:cameraMenuOpen?'rotate(180deg)':undefined,transition:'transform 0.3s'},viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"white\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"polyline\",{points:\"6 9 12 15 18 9\"})})]}),cameraMenuOpen&&/*#__PURE__*/_jsx(\"ul\",{role:\"listbox\",tabIndex:-1,\"aria-activedescendant\":selectedCameraId,style:dropdownListStyle,children:availableCameras.map(device=>{const isSelected=device.deviceId===selectedCameraId;return/*#__PURE__*/_jsx(\"li\",{id:device.deviceId,role:\"option\",\"aria-selected\":isSelected,onClick:()=>handleCameraSelect(device.deviceId),onKeyDown:e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();handleCameraSelect(device.deviceId);}},style:{padding:'10px 14px',cursor:'pointer',backgroundColor:isSelected?'#00e5ff':'transparent',color:isSelected?'#fff':'white',fontWeight:isSelected?'700':'500',transition:'background-color 0.2s, color 0.2s'},onMouseEnter:e=>{if(!isSelected){e.currentTarget.style.backgroundColor='rgba(0, 229, 255, 0.15)';e.currentTarget.style.color='#00e5ff';}},onMouseLeave:e=>{if(!isSelected){e.currentTarget.style.backgroundColor='transparent';e.currentTarget.style.color='white';}},tabIndex:0,children:device.label||\"\\u6444\\u50CF\\u5934 \".concat(device.deviceId)},device.deviceId);})})]}),cameraError&&/*#__PURE__*/_jsx(\"p\",{style:{color:'orange',marginTop:6},children:cameraError})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,style:buttonStyle,children:\"\\u4FDD\\u5B58\\u8BBE\\u7F6E\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u9884\\u89C8\"}),/*#__PURE__*/_jsx(\"div\",{style:{borderRadius:8,padding:10,backgroundColor:'rgba(0,0,0,0.3)',backdropFilter:'blur(10px)',WebkitBackdropFilter:'blur(10px)'},children:renderPreview()})]})]}),/*#__PURE__*/_jsxs(\"div\",{onClick:()=>setPanelResetFolded(!panelResetFolded),style:foldHeaderStyle,\"aria-expanded\":!panelResetFolded,\"aria-controls\":\"panelResetPanel\",tabIndex:0,onKeyDown:e=>{if(e.key==='Enter'||e.key===' ')setPanelResetFolded(!panelResetFolded);},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u9762\\u677F\\u4F4D\\u7F6E\\u91CD\\u7F6E (\\u70B9\\u51FB\",panelResetFolded?'展开':'收起',\")\"]}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:18},children:panelResetFolded?'+':'−'})]}),!panelResetFolded&&/*#__PURE__*/_jsxs(\"div\",{id:\"panelResetPanel\",style:panelContainerStyle,children:[/*#__PURE__*/_jsx(\"button\",{onClick:resetAllPanels,style:buttonStyle,children:\"\\u91CD\\u7F6E\\u6240\\u6709\\u9762\\u677F\\u5230\\u9ED8\\u8BA4\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:'white'},children:\"\\u91CD\\u7F6E\\u5355\\u4E2A\\u9762\\u677F\\u4F4D\\u7F6E\"}),panels.map(_ref4=>{let{id,left,top,width,height}=_ref4;return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:10,borderRadius:4,padding:10,backgroundColor:'rgba(255, 255, 255, 0.05)',color:'white',userSelect:'none'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:id}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:'#bbb'},children:[\"\\u5F53\\u524D\\uFF1A\",left,\",\",top,\"\\uFF0C\\u5927\\u5C0F\\uFF1A\",width,\"x\",height]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>resetSinglePanel(id),style:resetSingleBtnStyle,children:\"\\u91CD\\u7F6E\"})]},id);})]})]})]});}// CameraPreview 组件保持不变\nfunction CameraPreview(_ref5){let{cameraId}=_ref5;const videoRef=React.useRef(null);const[error,setError]=React.useState(null);React.useEffect(()=>{if(!cameraId){setError('未选择摄像头');return;}setError(null);let stream;const constraints={video:{deviceId:{exact:cameraId}},audio:false};async function startStream(){try{stream=await navigator.mediaDevices.getUserMedia(constraints);if(videoRef.current){videoRef.current.srcObject=stream;await videoRef.current.play();}}catch(_unused2){setError('无法访问摄像头，可能未授权或设备异常');}}startStream();return()=>{if(stream){stream.getTracks().forEach(track=>track.stop());}if(videoRef.current){videoRef.current.srcObject=null;}};},[cameraId]);if(error){return/*#__PURE__*/_jsx(\"div\",{style:{color:'red'},children:error});}return/*#__PURE__*/_jsx(\"video\",{ref:videoRef,style:{width:'100%',maxHeight:300,borderRadius:8,backgroundColor:'#000'},muted:true,playsInline:true,autoPlay:true});}// isValidUrl 保持不变\nfunction isValidUrl(string){try{new URL(string);return true;}catch(_unused3){return false;}}","map":{"version":3,"names":["React","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","menuItems","key","label","wallpaperTypes","value","Settings","_ref","_menuItems$find","_availableCameras$fin","wallpaperSettings","setWallpaperSettings","panels","resetAllPanels","resetSinglePanel","selectedMenu","setSelectedMenu","selectedType","setSelectedType","mediaSrc","setMediaSrc","availableCameras","setAvailableCameras","selectedCameraId","setSelectedCameraId","cameraError","setCameraError","wallpaperFolded","setWallpaperFolded","panelResetFolded","setPanelResetFolded","menuOpen","setMenuOpen","menuRef","cameraMenuOpen","setCameraMenuOpen","cameraMenuRef","uploadStatus","setUploadStatus","cfg","type","fetchCameras","devices","navigator","mediaDevices","enumerateDevices","videoDevices","filter","d","kind","some","deviceId","_unused","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleMenuSelect","handleCameraSelect","handleTypeChange","e","newType","length","handleMediaSrcChange","handleFileChange","file","files","concat","name","UPLOAD_BG_FILE_URL","uploadBackgroundFile","fileToUpload","validExtensions","fileExtension","split","pop","toLowerCase","includes","console","error","validPrefixes","hasValidPrefix","prefix","startsWith","newFileName","formData","FormData","renamedFile","File","append","log","originalName","newName","size","url","response","fetch","method","body","headers","responseText","text","status","result","JSON","parse","Error","substring","ok","filePath","message","handleFileUpload","preventDefault","fileInput","getElementById","handleSave","valueToSave","trim","isValidUrl","alert","prev","_objectSpread","renderPreview","src","alt","style","maxWidth","maxHeight","borderRadius","objectFit","backgroundColor","onError","currentTarget","controls","muted","loop","autoPlay","color","children","CameraPreview","cameraId","foldHeaderStyle","cursor","userSelect","display","justifyContent","alignItems","padding","backdropFilter","WebkitBackdropFilter","border","panelContainerStyle","marginBottom","inputSelectStyle","width","fontSize","outline","boxSizing","buttonStyle","fontWeight","resetSingleBtnStyle","dropdownWrapperStyle","position","dropdownHeaderStyle","dropdownListStyle","top","left","right","overflowY","boxShadow","zIndex","dropdownItemStyle","isSelected","transition","dropdownItemHoverStyle","frostedGlassBtnStyle","margin","fontFamily","onClick","tabIndex","onKeyDown","id","htmlFor","ref","role","borderColor","find","item","height","transform","undefined","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","points","map","_ref2","onMouseEnter","onMouseLeave","_ref3","marginRight","checked","onChange","placeholder","marginTop","accept","marginLeft","device","_ref4","_ref5","videoRef","setError","stream","constraints","video","exact","audio","startStream","getUserMedia","srcObject","play","_unused2","getTracks","forEach","track","stop","playsInline","string","URL","_unused3"],"sources":["D:/XM/AI-Sphere-Butler/core/client/src/components/Settings.jsx"],"sourcesContent":["// components/Settings.jsx\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nconst menuItems = [\r\n  { key: 'home', label: '主页' },\r\n  { key: 'butler', label: '管家' },\r\n  { key: 'car', label: '车' },\r\n  { key: 'homeassistant', label: 'HA' },\r\n  { key: 'ops', label: '运维' },\r\n  { key: 'settings', label: '设置' },\r\n];\r\nconst wallpaperTypes = [\r\n  { value: 'image', label: '静态图片' },\r\n  { value: 'video', label: '视频背景' },\r\n  { value: 'camera', label: '摄像头实时画面' },\r\n];\r\n// ... isValidUrl 和 CameraPreview 保持不变 ...\r\nexport default function Settings({ wallpaperSettings, setWallpaperSettings, panels = [], resetAllPanels, resetSinglePanel }) {\r\n  const [selectedMenu, setSelectedMenu] = useState('home');\r\n  const [selectedType, setSelectedType] = useState('image');\r\n  const [mediaSrc, setMediaSrc] = useState('');\r\n  const [availableCameras, setAvailableCameras] = useState([]);\r\n  const [selectedCameraId, setSelectedCameraId] = useState(null);\r\n  const [cameraError, setCameraError] = useState(null);\r\n  const [wallpaperFolded, setWallpaperFolded] = useState(false);\r\n  const [panelResetFolded, setPanelResetFolded] = useState(true);\r\n  // 菜单展开状态\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const menuRef = useRef(null);\r\n  // 摄像头设备菜单展开状态\r\n  const [cameraMenuOpen, setCameraMenuOpen] = useState(false);\r\n  const cameraMenuRef = useRef(null);\r\n\r\n  // 新增：文件上传状态\r\n  const [uploadStatus, setUploadStatus] = useState('');\r\n\r\n  useEffect(() => {\r\n    const cfg = wallpaperSettings[selectedMenu] || { type: 'image', value: '' };\r\n    setSelectedType(cfg.type);\r\n    if (cfg.type === 'camera') {\r\n      setSelectedCameraId(cfg.value || null);\r\n      setMediaSrc('');\r\n    } else {\r\n      setMediaSrc(cfg.value || '');\r\n      setSelectedCameraId(null);\r\n    }\r\n    setCameraError(null);\r\n  }, [selectedMenu, wallpaperSettings]);\r\n  useEffect(() => {\r\n    async function fetchCameras() {\r\n      try {\r\n        const devices = await navigator.mediaDevices.enumerateDevices();\r\n        const videoDevices = devices.filter(d => d.kind === 'videoinput');\r\n        setAvailableCameras(videoDevices);\r\n        if (selectedCameraId && !videoDevices.some(d => d.deviceId === selectedCameraId)) {\r\n          setSelectedCameraId(null);\r\n        }\r\n      } catch {\r\n        setAvailableCameras([]);\r\n        setCameraError('无法获取摄像头设备列表，可能未授予权限或浏览器不支持。');\r\n      }\r\n    }\r\n    fetchCameras();\r\n  }, [selectedCameraId]);\r\n  // 点击页面空白关闭所有菜单\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        setMenuOpen(false);\r\n      }\r\n      if (cameraMenuRef.current && !cameraMenuRef.current.contains(event.target)) {\r\n        setCameraMenuOpen(false);\r\n      }\r\n    }\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n  // 选择菜单项\r\n  const handleMenuSelect = (key) => {\r\n    setSelectedMenu(key);\r\n    setMenuOpen(false);\r\n    setCameraError(null);\r\n  };\r\n  // 选择摄像头设备\r\n  const handleCameraSelect = (deviceId) => {\r\n    setSelectedCameraId(deviceId);\r\n    setCameraMenuOpen(false);\r\n    setCameraError(null);\r\n  };\r\n  const handleTypeChange = (e) => {\r\n    const newType = e.target.value;\r\n    setSelectedType(newType);\r\n    setCameraError(null);\r\n    if (newType === 'camera') {\r\n      setMediaSrc('');\r\n      if (availableCameras.length > 0) {\r\n        setSelectedCameraId(availableCameras[0].deviceId);\r\n      } else {\r\n        setSelectedCameraId(null);\r\n      }\r\n    } else {\r\n      setMediaSrc('');\r\n      setSelectedCameraId(null);\r\n    }\r\n  };\r\n  const handleMediaSrcChange = (e) => setMediaSrc(e.target.value);\r\n\r\n  // 新增：处理文件选择\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setUploadStatus(`已选择: ${file.name}`);\r\n    } else {\r\n      setUploadStatus('');\r\n    }\r\n  };\r\n\r\n  // 新增：上传背景文件函数\r\n  const UPLOAD_BG_FILE_URL = 'http://192.168.168.77:6010/api/upload_print_file';\r\n  const uploadBackgroundFile = async (fileToUpload) => {\r\n    if (!fileToUpload) return;\r\n\r\n    const validExtensions = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'mp4', 'avi', 'mov', 'wmv', 'flv', 'webm'];\r\n    const fileExtension = fileToUpload.name.split('.').pop().toLowerCase();\r\n    if (!validExtensions.includes(fileExtension)) {\r\n        setUploadStatus('上传失败: 不支持的文件类型');\r\n        console.error('不支持的文件类型:', fileExtension);\r\n        return;\r\n    }\r\n\r\n    const validPrefixes = ['bg-', 'background-'];\r\n    const hasValidPrefix = validPrefixes.some(prefix => fileToUpload.name.toLowerCase().startsWith(prefix));\r\n    let newFileName = fileToUpload.name;\r\n    if (!hasValidPrefix) {\r\n        newFileName = `bg-${fileToUpload.name}`;\r\n    }\r\n\r\n    try {\r\n      setUploadStatus('正在上传背景文件...');\r\n      const formData = new FormData();\r\n      // 创建一个新的 File 对象，使用修改后的文件名\r\n      const renamedFile = new File([fileToUpload], newFileName, { type: fileToUpload.type });\r\n      formData.append('file', renamedFile);\r\n\r\n      console.log('准备上传背景文件:', {\r\n        originalName: fileToUpload.name,\r\n        newName: newFileName,\r\n        size: fileToUpload.size,\r\n        type: fileToUpload.type,\r\n        url: UPLOAD_BG_FILE_URL\r\n      });\r\n\r\n      const response = await fetch(UPLOAD_BG_FILE_URL, {\r\n        method: 'POST',\r\n        body: formData,\r\n        headers: {\r\n          'Accept': 'application/json'\r\n        },\r\n      });\r\n\r\n      const responseText = await response.text();\r\n      console.log(`背景文件上传响应 (状态码: ${response.status}):`, responseText);\r\n\r\n      let result;\r\n      try {\r\n        result = JSON.parse(responseText);\r\n      } catch (e) {\r\n        console.error('解析背景文件上传响应JSON失败:', e, '响应文本:', responseText);\r\n        throw new Error(`服务器返回无效JSON: ${responseText.substring(0, 100)}`);\r\n      }\r\n\r\n      if (!response.ok) {\r\n        throw new Error(result.error || `上传失败: ${response.status}`);\r\n      }\r\n\r\n      // 上传成功后，将返回的文件路径设置到 mediaSrc\r\n      if (result.filePath) {\r\n        setMediaSrc(result.filePath);\r\n      }\r\n\r\n      setUploadStatus(result.message || '背景文件上传成功');\r\n      console.log('背景文件上传成功:', result);\r\n    } catch (error) {\r\n      console.error('背景文件上传失败:', error);\r\n      setUploadStatus(`上传失败: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // 新增：处理文件上传\r\n  const handleFileUpload = async (e) => {\r\n    e.preventDefault();\r\n    const fileInput = document.getElementById('bg-file-upload');\r\n    const file = fileInput?.files[0];\r\n    if (file) {\r\n      await uploadBackgroundFile(file);\r\n      // 清空文件输入\r\n      if (fileInput) fileInput.value = '';\r\n    }\r\n  };\r\n\r\n  const handleSave = () => {\r\n    let valueToSave = null;\r\n    if (selectedType === 'camera') {\r\n      valueToSave = selectedCameraId || null;\r\n    } else if (selectedType === 'image' || selectedType === 'video') {\r\n      valueToSave = mediaSrc.trim() || null;\r\n    }\r\n    if ((selectedType === 'image' || selectedType === 'video') && valueToSave) {\r\n      if (!isValidUrl(valueToSave) && !valueToSave.startsWith('/')) {\r\n        alert('请输入有效的 URL 地址或以 / 开头的本地路径');\r\n        return;\r\n      }\r\n    }\r\n    setWallpaperSettings(prev => ({\r\n      ...prev,\r\n      [selectedMenu]: {\r\n        type: selectedType,\r\n        value: valueToSave,\r\n      },\r\n    }));\r\n    alert('保存成功');\r\n  };\r\n  const renderPreview = () => {\r\n    if (selectedType === 'image' && mediaSrc) {\r\n      return (\r\n        <img\r\n          src={mediaSrc}\r\n          alt=\"背景图片预览\"\r\n          style={{ maxWidth: '100%', maxHeight: 300, borderRadius: 8, objectFit: 'contain', backgroundColor: '#111' }}\r\n          onError={(e) => { e.currentTarget.src = ''; }}\r\n        />\r\n      );\r\n    }\r\n    if (selectedType === 'video' && mediaSrc) {\r\n      return (\r\n        <video\r\n          src={mediaSrc}\r\n          style={{ maxWidth: '100%', maxHeight: 300, borderRadius: 8, backgroundColor: '#111' }}\r\n          controls\r\n          muted\r\n          loop\r\n          autoPlay\r\n        />\r\n      );\r\n    }\r\n    if (selectedType === 'camera') {\r\n      if (availableCameras.length === 0) {\r\n        return <div style={{ color: 'orange' }}>无可用摄像头设备或未授权访问摄像头。</div>;\r\n      }\r\n      return (\r\n        <CameraPreview cameraId={selectedCameraId} />\r\n      );\r\n    }\r\n    return <div style={{ color: '#666' }}>请选择壁纸类型并输入或选择资源。</div>;\r\n  };\r\n  // 样式定义\r\n  const foldHeaderStyle = {\r\n    cursor: 'pointer',\r\n    userSelect: 'none',\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: '10px 15px',\r\n    borderRadius: '6px',\r\n    backgroundColor: 'rgba(0, 229, 255, 0.1)', // 磨砂浅蓝半透明\r\n    backdropFilter: 'blur(12px)',\r\n    WebkitBackdropFilter: 'blur(12px)',\r\n    color: 'white',\r\n    border: 'none', // 无边框\r\n  };\r\n  const panelContainerStyle = {\r\n    padding: 12,\r\n    borderRadius: 6,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.15)', // 白色半透明磨砂背景\r\n    backdropFilter: 'blur(12px)',\r\n    WebkitBackdropFilter: 'blur(12px)',\r\n    color: '#222',\r\n    marginBottom: 20,\r\n  };\r\n  const inputSelectStyle = {\r\n    width: '100%',\r\n    padding: 8,\r\n    borderRadius: 4,\r\n    border: 'none',\r\n    fontSize: 16,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.08)',\r\n    color: '#222',\r\n    outline: 'none',\r\n    boxSizing: 'border-box',\r\n  };\r\n  const buttonStyle = {\r\n    padding: '10px 20px',\r\n    backgroundColor: 'rgba(255, 255, 255, 0.7)',\r\n    color: '#222',\r\n    fontWeight: 'bold',\r\n    border: 'none',\r\n    borderRadius: 6,\r\n    cursor: 'pointer',\r\n    userSelect: 'none',\r\n  };\r\n  const resetSingleBtnStyle = {\r\n    padding: '4px 10px',\r\n    borderRadius: 4,\r\n    border: 'none',\r\n    backgroundColor: 'rgba(0, 123, 255, 0.6)',\r\n    color: 'white',\r\n    cursor: 'pointer',\r\n    userSelect: 'none',\r\n  };\r\n  // 自定义选择菜单样式（菜单项、摄像头）\r\n  const dropdownWrapperStyle = {\r\n    position: 'relative',\r\n    userSelect: 'none',\r\n  };\r\n  const dropdownHeaderStyle = {\r\n    padding: '10px 14px',\r\n    borderRadius: 6,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.25)',\r\n    backdropFilter: 'blur(10px)',\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n    border: '1px solid rgba(255,255,255,0.4)',\r\n    color: '#222',\r\n    fontWeight: '600',\r\n    cursor: 'pointer',\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  };\r\n  const dropdownListStyle = {\r\n    position: 'absolute',\r\n    top: 'calc(100% + 6px)',\r\n    left: 0,\r\n    right: 0,\r\n    maxHeight: 180,\r\n    overflowY: 'auto',\r\n    borderRadius: 8,\r\n    backgroundColor: 'rgba(255, 255, 255, 0.15)',\r\n    backdropFilter: 'blur(12px)',\r\n    WebkitBackdropFilter: 'blur(12px)',\r\n    boxShadow: '0 8px 24px rgba(0,0,0,0.12)',\r\n    zIndex: 1000,\r\n  };\r\n  const dropdownItemStyle = (isSelected) => ({\r\n    padding: '10px 14px',\r\n    cursor: 'pointer',\r\n    backgroundColor: isSelected ? '#00e5ff' : 'transparent',\r\n    color: isSelected ? '#fff' : '#222',\r\n    fontWeight: isSelected ? '700' : '500',\r\n    transition: 'background-color 0.2s, color 0.2s',\r\n  });\r\n  const dropdownItemHoverStyle = {\r\n    backgroundColor: 'rgba(0, 229, 255, 0.15)',\r\n    color: '#00e5ff',\r\n  };\r\n\r\n  // 新增：磨砂玻璃按钮样式（与 OldWebRTC 中的样式保持一致）\r\n  const frostedGlassBtnStyle = {\r\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\r\n    border: '1px solid rgba(255, 255, 255, 0.3)',\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    padding: '8px 16px',\r\n    cursor: 'pointer',\r\n    borderRadius: 4,\r\n    outline: 'none',\r\n    transition: 'all 0.3s',\r\n    fontSize: 14,\r\n    backdropFilter: 'blur(10px)',\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)',\r\n  };\r\n\r\n  return (\r\n    <div style={{ color: 'white', maxWidth: 700, margin: 'auto', fontFamily: 'sans-serif' }}>\r\n      {/* 壁纸设置折叠头 */}\r\n      <div\r\n        onClick={() => setWallpaperFolded(!wallpaperFolded)}\r\n        style={foldHeaderStyle}\r\n        aria-expanded={!wallpaperFolded}\r\n        aria-controls=\"wallpaperSettingsPanel\"\r\n        tabIndex={0}\r\n        onKeyDown={e => { if (e.key === 'Enter' || e.key === ' ') setWallpaperFolded(!wallpaperFolded); }}\r\n      >\r\n        <span>壁纸设置 (点击{wallpaperFolded ? '展开' : '收起'})</span>\r\n        <span style={{ fontSize: 18 }}>{wallpaperFolded ? '+' : '−'}</span>\r\n      </div>\r\n      {!wallpaperFolded && (\r\n        <div id=\"wallpaperSettingsPanel\" style={panelContainerStyle}>\r\n          {/* 自定义菜单项选择 */}\r\n          <div style={{ marginBottom: 16 }}>\r\n            <label htmlFor=\"menuSelect\" style={{ display: 'block', marginBottom: 6, color: 'white' }}>选择菜单项</label>\r\n            <div style={dropdownWrapperStyle} ref={menuRef}>\r\n              <div\r\n                id=\"menuSelect\"\r\n                role=\"button\"\r\n                tabIndex={0}\r\n                onClick={() => setMenuOpen(!menuOpen)}\r\n                onKeyDown={e => {\r\n                  if (e.key === 'Enter' || e.key === ' ') {\r\n                    e.preventDefault();\r\n                    setMenuOpen(!menuOpen);\r\n                  }\r\n                }}\r\n                style={{\r\n                  ...dropdownHeaderStyle,\r\n                  color: 'white',\r\n                  borderColor: 'rgba(255,255,255,0.6)', // 让边框颜色更亮\r\n                }}\r\n                aria-haspopup=\"listbox\"\r\n                aria-expanded={menuOpen}\r\n                aria-labelledby=\"menuSelect\"\r\n              >\r\n                {menuItems.find(item => item.key === selectedMenu)?.label || '请选择'}\r\n                <svg\r\n                  style={{ width: 18, height: 18, transform: menuOpen ? 'rotate(180deg)' : undefined, transition: 'transform 0.3s' }}\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"white\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <polyline points=\"6 9 12 15 18 9\" />\r\n                </svg>\r\n              </div>\r\n              {menuOpen && (\r\n                <ul\r\n                  role=\"listbox\"\r\n                  tabIndex={-1}\r\n                  aria-activedescendant={selectedMenu}\r\n                  style={dropdownListStyle}\r\n                >\r\n                  {menuItems.map(({ key, label }) => {\r\n                    const isSelected = key === selectedMenu;\r\n                    return (\r\n                      <li\r\n                        id={key}\r\n                        key={key}\r\n                        role=\"option\"\r\n                        aria-selected={isSelected}\r\n                        onClick={() => handleMenuSelect(key)}\r\n                        onKeyDown={e => {\r\n                          if (e.key === 'Enter' || e.key === ' ') {\r\n                            e.preventDefault();\r\n                            handleMenuSelect(key);\r\n                          }\r\n                        }}\r\n                        style={{\r\n                          padding: '10px 14px',\r\n                          cursor: 'pointer',\r\n                          backgroundColor: isSelected ? '#00e5ff' : 'transparent',\r\n                          color: isSelected ? '#fff' : 'white',\r\n                          fontWeight: isSelected ? '700' : '500',\r\n                          transition: 'background-color 0.2s, color 0.2s',\r\n                        }}\r\n                        onMouseEnter={e => {\r\n                          if (!isSelected) {\r\n                            e.currentTarget.style.backgroundColor = 'rgba(0, 229, 255, 0.15)';\r\n                            e.currentTarget.style.color = '#00e5ff';\r\n                          }\r\n                        }}\r\n                        onMouseLeave={e => {\r\n                          if (!isSelected) {\r\n                            e.currentTarget.style.backgroundColor = 'transparent';\r\n                            e.currentTarget.style.color = 'white';\r\n                          }\r\n                        }}\r\n                        tabIndex={0}\r\n                      >\r\n                        {label}\r\n                      </li>\r\n                    );\r\n                  })}\r\n                </ul>\r\n              )}\r\n            </div>\r\n          </div>\r\n          {/* 壁纸类型 */}\r\n          <div style={{ marginBottom: 16 }}>\r\n            <label style={{ display: 'block', marginBottom: 6, color: 'white' }}>壁纸类型</label>\r\n            {wallpaperTypes.map(({ value, label }) => (\r\n              <label key={value} style={{ marginRight: 20, cursor: 'pointer', color: 'white' }}>\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"wallpaperType\"\r\n                  value={value}\r\n                  checked={selectedType === value}\r\n                  onChange={handleTypeChange}\r\n                  style={{ marginRight: 6 }}\r\n                />\r\n                {label}\r\n              </label>\r\n            ))}\r\n          </div>\r\n          {/* 图片或视频地址输入 */}\r\n          {(selectedType === 'image' || selectedType === 'video') && (\r\n            <div style={{ marginBottom: 16 }}>\r\n              <label htmlFor=\"mediaSrc\" style={{ display: 'block', marginBottom: 6, color: 'white' }}>\r\n                {selectedType === 'image' ? '图片地址(URL或上传到服务器 )' : '视频地址(URL或上传到服务器)'}\r\n              </label>\r\n              <input\r\n                id=\"mediaSrc\"\r\n                type=\"text\"\r\n                value={mediaSrc}\r\n                onChange={handleMediaSrcChange}\r\n                placeholder={selectedType === 'image' ? '例如 https://example.com/bg.jpg' : '例如 https://example.com/bg.mp4 或 /local/path/bg.mp4'}\r\n                style={{ width: '100%', padding: 8, borderRadius: 4, border: 'none', fontSize: 16, backgroundColor: 'rgba(255,255,255,0.1)', color: 'white' }}\r\n              />\r\n\r\n              {/* 新增：文件上传区域 */}\r\n              <div style={{ marginTop: 12 }}>\r\n                <label\r\n                  htmlFor=\"bg-file-upload\"\r\n                  style={frostedGlassBtnStyle}\r\n                >\r\n                  选择文件上传\r\n                </label>\r\n                <input\r\n                  id=\"bg-file-upload\"\r\n                  type=\"file\"\r\n                  accept=\"image/*,video/*\"\r\n                  onChange={handleFileChange}\r\n                  style={{ display: 'none' }}\r\n                />\r\n                <button\r\n                  onClick={handleFileUpload}\r\n                  style={{ ...frostedGlassBtnStyle, marginLeft: 8 }}\r\n                >\r\n                  上传背景文件\r\n                </button>\r\n                {uploadStatus && (\r\n                  <div style={{ \r\n                    marginTop: '8px', \r\n                    color: uploadStatus.includes('失败') ? 'red' : 'white',\r\n                    fontSize: 13\r\n                  }}>\r\n                    {uploadStatus}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n          {/* 摄像头设备选择改成自定义菜单 */}\r\n          {selectedType === 'camera' && (\r\n            <div style={{ marginBottom: 16 }}>\r\n              <label htmlFor=\"cameraSelect\" style={{ display: 'block', marginBottom: 6, color: 'white' }}>选择摄像头设备</label>\r\n              <div style={dropdownWrapperStyle} ref={cameraMenuRef}>\r\n                <div\r\n                  id=\"cameraSelect\"\r\n                  role=\"button\"\r\n                  tabIndex={0}\r\n                  onClick={() => {\r\n                    // 如果无设备，禁止展开菜单\r\n                    if (availableCameras.length > 0) setCameraMenuOpen(!cameraMenuOpen);\r\n                  }}\r\n                  onKeyDown={e => {\r\n                    if ((e.key === 'Enter' || e.key === ' ') && availableCameras.length > 0) {\r\n                      e.preventDefault();\r\n                      setCameraMenuOpen(!cameraMenuOpen);\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    ...dropdownHeaderStyle,\r\n                    color: availableCameras.length > 0 ? 'white' : 'rgba(255,255,255,0.4)', // 设备可用时白色，不可用时透明白\r\n                    backgroundColor: availableCameras.length > 0 ? dropdownHeaderStyle.backgroundColor : 'rgba(255,255,255,0.1)',\r\n                    cursor: availableCameras.length > 0 ? 'pointer' : 'not-allowed',\r\n                    borderColor: availableCameras.length > 0 ? 'rgba(255,255,255,0.6)' : 'rgba(255,255,255,0.2)',\r\n                  }}\r\n                  aria-haspopup=\"listbox\"\r\n                  aria-expanded={cameraMenuOpen}\r\n                  aria-labelledby=\"cameraSelect\"\r\n                >\r\n                  {availableCameras.length === 0\r\n                    ? '无可用摄像头设备'\r\n                    : (availableCameras.find(d => d.deviceId === selectedCameraId)?.label || `摄像头 ${selectedCameraId || ''}`) || '请选择'}\r\n                  <svg\r\n                    style={{ width: 18, height: 18, transform: cameraMenuOpen ? 'rotate(180deg)' : undefined, transition: 'transform 0.3s' }}\r\n                    viewBox=\"0 0 24 24\"\r\n                    fill=\"none\"\r\n                    stroke=\"white\"\r\n                    strokeWidth=\"2\"\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                  >\r\n                    <polyline points=\"6 9 12 15 18 9\" />\r\n                  </svg>\r\n                </div>\r\n                {cameraMenuOpen && (\r\n                  <ul\r\n                    role=\"listbox\"\r\n                    tabIndex={-1}\r\n                    aria-activedescendant={selectedCameraId}\r\n                    style={dropdownListStyle}\r\n                  >\r\n                    {availableCameras.map((device) => {\r\n                      const isSelected = device.deviceId === selectedCameraId;\r\n                      return (\r\n                        <li\r\n                          id={device.deviceId}\r\n                          key={device.deviceId}\r\n                          role=\"option\"\r\n                          aria-selected={isSelected}\r\n                          onClick={() => handleCameraSelect(device.deviceId)}\r\n                          onKeyDown={e => {\r\n                            if (e.key === 'Enter' || e.key === ' ') {\r\n                              e.preventDefault();\r\n                              handleCameraSelect(device.deviceId);\r\n                            }\r\n                          }}\r\n                          style={{\r\n                            padding: '10px 14px',\r\n                            cursor: 'pointer',\r\n                            backgroundColor: isSelected ? '#00e5ff' : 'transparent',\r\n                            color: isSelected ? '#fff' : 'white',\r\n                            fontWeight: isSelected ? '700' : '500',\r\n                            transition: 'background-color 0.2s, color 0.2s',\r\n                          }}\r\n                          onMouseEnter={e => {\r\n                            if (!isSelected) {\r\n                              e.currentTarget.style.backgroundColor = 'rgba(0, 229, 255, 0.15)';\r\n                              e.currentTarget.style.color = '#00e5ff';\r\n                            }\r\n                          }}\r\n                          onMouseLeave={e => {\r\n                            if (!isSelected) {\r\n                              e.currentTarget.style.backgroundColor = 'transparent';\r\n                              e.currentTarget.style.color = 'white';\r\n                            }\r\n                          }}\r\n                          tabIndex={0}\r\n                        >\r\n                          {device.label || `摄像头 ${device.deviceId}`}\r\n                        </li>\r\n                      );\r\n                    })}\r\n                  </ul>\r\n                )}\r\n              </div>\r\n              {cameraError && <p style={{ color: 'orange', marginTop: 6 }}>{cameraError}</p>}\r\n            </div>\r\n          )}  \r\n          <button onClick={handleSave} style={buttonStyle}>\r\n            保存设置\r\n          </button>\r\n          <div>\r\n            <h4>预览</h4>\r\n            <div style={{ borderRadius: 8, padding: 10, backgroundColor: 'rgba(0,0,0,0.3)', backdropFilter: 'blur(10px)', WebkitBackdropFilter: 'blur(10px)' }}>\r\n              {renderPreview()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* 面板重置折叠头 */}\r\n      <div\r\n        onClick={() => setPanelResetFolded(!panelResetFolded)}\r\n        style={foldHeaderStyle}\r\n        aria-expanded={!panelResetFolded}\r\n        aria-controls=\"panelResetPanel\"\r\n        tabIndex={0}\r\n        onKeyDown={e => { if (e.key === 'Enter' || e.key === ' ') setPanelResetFolded(!panelResetFolded); }}\r\n      >\r\n        <span>面板位置重置 (点击{panelResetFolded ? '展开' : '收起'})</span>\r\n        <span style={{ fontSize: 18 }}>{panelResetFolded ? '+' : '−'}</span>\r\n      </div>\r\n      {!panelResetFolded && (\r\n        <div id=\"panelResetPanel\" style={panelContainerStyle}>\r\n          <button onClick={resetAllPanels} style={buttonStyle}>\r\n            重置所有面板到默认\r\n          </button>\r\n          <div>\r\n            <h4 style={{ color: 'white' }}>重置单个面板位置</h4>\r\n            {panels.map(({ id, left, top, width, height }) => (\r\n              <div\r\n                key={id}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'space-between',\r\n                  marginBottom: 10,\r\n                  borderRadius: 4,\r\n                  padding: 10,\r\n                  backgroundColor: 'rgba(255, 255, 255, 0.05)',\r\n                  color: 'white',\r\n                  userSelect: 'none',\r\n                }}\r\n              >\r\n                <div>\r\n                  <strong>{id}</strong>\r\n                  <div style={{ fontSize: 12, color: '#bbb' }}>\r\n                    当前：{left},{top}，大小：{width}x{height}\r\n                  </div>\r\n                </div>\r\n                <button onClick={() => resetSinglePanel(id)} style={resetSingleBtnStyle}>\r\n                  重置\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n// CameraPreview 组件保持不变\r\nfunction CameraPreview({ cameraId }) {\r\n  const videoRef = React.useRef(null);\r\n  const [error, setError] = React.useState(null);\r\n  React.useEffect(() => {\r\n    if (!cameraId) {\r\n      setError('未选择摄像头');\r\n      return;\r\n    }\r\n    setError(null);\r\n    let stream;\r\n    const constraints = {\r\n      video: { deviceId: { exact: cameraId } },\r\n      audio: false,\r\n    };\r\n    async function startStream() {\r\n      try {\r\n        stream = await navigator.mediaDevices.getUserMedia(constraints);\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = stream;\r\n          await videoRef.current.play();\r\n        }\r\n      } catch {\r\n        setError('无法访问摄像头，可能未授权或设备异常');\r\n      }\r\n    }\r\n    startStream();\r\n    return () => {\r\n      if (stream) {\r\n        stream.getTracks().forEach(track => track.stop());\r\n      }\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = null;\r\n      }\r\n    };\r\n  }, [cameraId]);\r\n  if (error) {\r\n    return <div style={{ color: 'red' }}>{error}</div>;\r\n  }\r\n  return (\r\n    <video\r\n      ref={videoRef}\r\n      style={{ width: '100%', maxHeight: 300, borderRadius: 8, backgroundColor: '#000' }}\r\n      muted\r\n      playsInline\r\n      autoPlay\r\n    />\r\n  );\r\n}\r\n// isValidUrl 保持不变\r\nfunction isValidUrl(string) {\r\n  try {\r\n    new URL(string);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}