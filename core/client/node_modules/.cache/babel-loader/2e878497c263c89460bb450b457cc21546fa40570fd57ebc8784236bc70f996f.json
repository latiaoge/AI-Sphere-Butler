{"ast":null,"code":"var _jsxFileName = \"D:\\\\XM\\\\AI-Sphere-Butler\\\\core\\\\client\\\\src\\\\components\\\\OldWebRTC.jsx\",\n  _s = $RefreshSig$();\n// src/components/OldWebRTC.jsx\nimport React, { useEffect, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function OldWebRTC({\n  renderVideo = true,\n  keepConnection = false\n}) {\n  _s();\n  const videoRef = useRef(null);\n  const audioRef = useRef(null);\n  const pcRef = useRef(null);\n  const textareaRef = useRef(null);\n  const containerRef = useRef(null); // 父容器引用，用于范围限制\n\n  const [useStun, setUseStun] = useState(false);\n  const [started, setStarted] = useState(false);\n  const [zoomWidth, setZoomWidth] = useState(600);\n\n  // 视频初始宽高\n  const initialWidth = 600;\n  const initialHeight = 450; // 按你代码比例\n\n  // 信令服务器地址（根据你实际后端调整）\n  const SIGNALING_URL = '/offer'; // POST 地址\n\n  // 视频缩放比例\n  const zoomStep = 50;\n\n  // 维护聊天框位置状态，默认位置距父容器左上角20px,20px\n  const [chatPos, setChatPos] = useState(() => {\n    try {\n      const saved = localStorage.getItem('chatbox-position');\n      if (saved) {\n        const pos = JSON.parse(saved);\n        if (typeof pos.left === 'number' && typeof pos.top === 'number') {\n          return pos;\n        }\n      }\n    } catch {}\n    return {\n      left: 20,\n      top: 20\n    };\n  });\n\n  // 拖拽相关状态\n  const draggingRef = useRef(false);\n  const dragOffsetRef = useRef({\n    x: 0,\n    y: 0\n  });\n\n  // 拖拽事件处理\n  function onDragStart(e) {\n    // 如果点击的是textarea，则不触发拖拽\n    if (e.target.tagName.toLowerCase() === 'textarea') {\n      draggingRef.current = false;\n      return;\n    }\n    draggingRef.current = true;\n    const targetRect = e.currentTarget.getBoundingClientRect();\n    if (e.type === 'touchstart' && e.touches && e.touches[0]) {\n      dragOffsetRef.current = {\n        x: e.touches[0].clientX - targetRect.left,\n        y: e.touches[0].clientY - targetRect.top\n      };\n    } else {\n      dragOffsetRef.current = {\n        x: e.clientX - targetRect.left,\n        y: e.clientY - targetRect.top\n      };\n    }\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  function onDragMove(e) {\n    if (!draggingRef.current) return;\n    let clientX, clientY;\n    if (e.type === 'touchmove' && e.touches && e.touches[0]) {\n      clientX = e.touches[0].clientX;\n      clientY = e.touches[0].clientY;\n    } else if (e.type === 'mousemove') {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    } else {\n      return;\n    }\n    if (!containerRef.current) return;\n    const containerRect = containerRef.current.getBoundingClientRect();\n\n    // 计算相对于父容器左上角的新位置\n    let newLeft = clientX - containerRect.left - dragOffsetRef.current.x;\n    let newTop = clientY - containerRect.top - dragOffsetRef.current.y;\n\n    // 限制拖拽范围在父容器内\n    const chatWidth = 320;\n    const chatHeight = 260;\n    newLeft = Math.min(Math.max(0, newLeft), containerRect.width - chatWidth);\n    // 修改这一行，允许拖拽到最底部，无底部间距\n    newTop = Math.min(Math.max(0, newTop), containerRect.height - chatHeight);\n    setChatPos({\n      left: newLeft,\n      top: newTop\n    });\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  function onDragEnd(e) {\n    if (draggingRef.current) {\n      draggingRef.current = false;\n      // 保存位置\n      localStorage.setItem('chatbox-position', JSON.stringify(chatPos));\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  // 创建并协商 WebRTC 连接\n  async function negotiate() {\n    const pc = pcRef.current;\n    if (!pc) return;\n    pc.addTransceiver('video', {\n      direction: 'recvonly'\n    });\n    pc.addTransceiver('audio', {\n      direction: 'recvonly'\n    });\n    try {\n      const offer = await pc.createOffer();\n      await pc.setLocalDescription(offer);\n\n      // 等待 ICE gathering 完成\n      await new Promise(resolve => {\n        if (pc.iceGatheringState === 'complete') {\n          resolve();\n        } else {\n          const checkState = () => {\n            if (pc.iceGatheringState === 'complete') {\n              pc.removeEventListener('icegatheringstatechange', checkState);\n              resolve();\n            }\n          };\n          pc.addEventListener('icegatheringstatechange', checkState);\n        }\n      });\n\n      // 发送本地 SDP offer 到服务器，等待答复 SDP answer\n      const response = await fetch(SIGNALING_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          sdp: pc.localDescription.sdp,\n          type: pc.localDescription.type\n        })\n      });\n      const answer = await response.json();\n\n      // 设置远端 SDP\n      await pc.setRemoteDescription(answer);\n\n      // 你原来页面有 sessionid 字段，这里不展示，需要的话可以自行扩展\n    } catch (e) {\n      alert('协商失败: ' + e.message);\n    }\n  }\n  function start() {\n    if (started) return;\n    const config = {\n      sdpSemantics: 'unified-plan'\n    };\n    // 注释掉 STUN 服务器配置，禁用 stun 功能\n    {/* if (useStun) {\r\n      config.iceServers = [{ urls: ['stun:stun.l.google.com:19302'] }];\r\n     } */}\n    const pc = new RTCPeerConnection(config);\n    pcRef.current = pc;\n\n    // 监听远端 track，绑定到 video/audio 标签\n    pc.addEventListener('track', evt => {\n      if (evt.track.kind === 'video') {\n        if (videoRef.current) {\n          videoRef.current.srcObject = evt.streams[0];\n        }\n      } else if (evt.track.kind === 'audio') {\n        if (audioRef.current) {\n          audioRef.current.srcObject = evt.streams[0];\n        }\n      }\n    });\n    setStarted(true);\n    negotiate();\n\n    // 初始化视频缩放（首次设置）\n    setZoomWidth(initialWidth);\n  }\n  function stop() {\n    if (!started) return;\n    setStarted(false);\n\n    // 根据 keepConnection prop 决定是否真正关闭连接\n    if (!keepConnection) {\n      setTimeout(() => {\n        if (pcRef.current) {\n          pcRef.current.close();\n          pcRef.current = null;\n        }\n      }, 500);\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(t => t.stop());\n        videoRef.current.srcObject = null;\n      }\n      if (audioRef.current && audioRef.current.srcObject) {\n        audioRef.current.srcObject.getTracks().forEach(t => t.stop());\n        audioRef.current.srcObject = null;\n      }\n    }\n  }\n\n  // 缩放视频\n  function zoomIn() {\n    setZoomWidth(w => w + zoomStep);\n  }\n  function zoomOut() {\n    setZoomWidth(w => w - zoomStep > 0 ? w - zoomStep : w);\n  }\n\n  // 文本框输入状态\n  const [message, setMessage] = useState('');\n  // 图片文件状态\n  const [imageFile, setImageFile] = useState(null);\n\n  // 发送文本消息函数，发送到 LLM 服务\n  const sendTextMessage = async () => {\n    if (!message.trim()) return;\n    try {\n      const response = await fetch('https://192.168.1.70:6010/qwener', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          text: message\n        })\n      });\n      if (!response.ok) {\n        throw new Error('网络响应失败，状态码: ' + response.status);\n      }\n      const data = await response.json();\n      console.log('文本发送成功，服务器返回：', data);\n    } catch (error) {\n      console.error('文本发送失败：', error);\n    }\n  };\n\n  // 发送图片+文本消息函数，发送到多模态服务\n  const sendMultiModal = async () => {\n    if (!imageFile) return;\n    try {\n      const reader = new FileReader();\n      reader.onloadend = async () => {\n        const base64data = reader.result;\n        const payload = {\n          text: message.trim(),\n          // 文字\n          image: base64data // 图片 base64\n        };\n        const response = await fetch('https://192.168.1.70:6010/multimodal', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        });\n        if (!response.ok) {\n          throw new Error('网络响应失败，状态码: ' + response.status);\n        }\n        const data = await response.json();\n        console.log('多模态发送成功，服务器返回：', data);\n        setImageFile(null); // 清空图片\n        setMessage(''); // 清空文本\n      };\n      reader.readAsDataURL(imageFile);\n    } catch (error) {\n      console.error('多模态发送失败：', error);\n    }\n  };\n\n  // 表单提交处理\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (imageFile) {\n      // 有图片时，文本和图片一起发送到多模态服务\n      await sendMultiModal();\n    } else {\n      // 仅文本时，发送到 LLM 服务\n      await sendTextMessage();\n      setMessage(''); // 清空文本\n    }\n  };\n\n  // 选择图片处理\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n    setImageFile(file || null);\n  };\n\n  // 组件挂载时，重新绑定已有远端流到 video/audio 标签，防止切换回来黑屏\n  useEffect(() => {\n    if (pcRef.current && videoRef.current && audioRef.current) {\n      const pc = pcRef.current;\n\n      // 视频流绑定\n      let remoteVideoStream = null;\n      pc.getReceivers().forEach(receiver => {\n        if (receiver.track && receiver.track.kind === 'video') {\n          if (receiver.track.readyState === 'live') {\n            if (receiver.track.streams && receiver.track.streams[0]) {\n              remoteVideoStream = receiver.track.streams[0];\n            }\n          }\n        }\n      });\n      if (remoteVideoStream) {\n        videoRef.current.srcObject = remoteVideoStream;\n      }\n\n      // 音频流绑定\n      let remoteAudioStream = null;\n      pc.getReceivers().forEach(receiver => {\n        if (receiver.track && receiver.track.kind === 'audio') {\n          if (receiver.track.readyState === 'live') {\n            if (receiver.track.streams && receiver.track.streams[0]) {\n              remoteAudioStream = receiver.track.streams[0];\n            }\n          }\n        }\n      });\n      if (remoteAudioStream) {\n        audioRef.current.srcObject = remoteAudioStream;\n      }\n    }\n  }, []); // 仅挂载时执行一次\n\n  // 通用磨砂玻璃按钮样式（纯 CSS 磨砂玻璃效果）\n  const frostedGlassBtnStyle = {\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\n    // 半透明背景\n    border: '1px solid rgba(255, 255, 255, 0.3)',\n    // 半透明边框\n    color: 'white',\n    fontWeight: 'bold',\n    padding: '8px 16px',\n    cursor: 'pointer',\n    borderRadius: 4,\n    outline: 'none',\n    transition: 'background-color 0.3s, color 0.3s, box-shadow 0.3s, transform 0.3s',\n    fontSize: 14,\n    lineHeight: '1.2',\n    backdropFilter: 'blur(10px)',\n    // 磨砂玻璃模糊\n    WebkitBackdropFilter: 'blur(10px)',\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)'\n  };\n\n  // 按钮禁用样式\n  const disabledBtnStyle = {\n    ...frostedGlassBtnStyle,\n    opacity: 0.4,\n    cursor: 'not-allowed',\n    boxShadow: 'none'\n  };\n\n  // 按钮 hover 效果内联样式函数\n  const getBtnHoverStyle = disabled => {\n    if (disabled) return {};\n    return {\n      backgroundColor: 'rgba(255, 255, 255, 0.2)',\n      boxShadow: '0 6px 20px rgba(255, 255, 255, 0.3)',\n      transform: 'scale(1.05)'\n    };\n  };\n\n  // 本组件内部按钮 hover 状态管理\n  const [startBtnHover, setStartBtnHover] = useState(false);\n  const [stopBtnHover, setStopBtnHover] = useState(false);\n  const [zoomInHover, setZoomInHover] = useState(false);\n  const [zoomOutHover, setZoomOutHover] = useState(false);\n  const [interruptBtnHover, setInterruptBtnHover] = useState(false); // 新增 打断按钮 hover\n\n  // 新增：点击打断说话按钮，调用后端打断接口\n  const handleInterruptClick = async () => {\n    try {\n      const resp = await fetch('http://192.168.168.77:6010/api/interrupt_speaking', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (!resp.ok) {\n        alert('打断请求失败，状态码: ' + resp.status);\n        console.warn('打断请求失败，状态码:', resp.status);\n      } else {\n        console.log('成功发送打断请求到后台');\n        alert('已发送打断请求');\n      }\n    } catch (e) {\n      alert('调用打断接口异常: ' + e.message);\n      console.error('调用打断接口异常:', e);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    style: {\n      maxWidth: 1280,\n      position: 'relative',\n      minHeight: '100vh'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"option\",\n      style: {\n        marginBottom: 8\n      },\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"use-stun\",\n        type: \"checkbox\",\n        checked: useStun,\n        onChange: e => setUseStun(e.target.checked),\n        style: {\n          accentColor: 'white'\n        },\n        disabled: started // 连接启动后禁用切换，避免状态不一致\n        // 注释掉STUN功能，禁用选择\n        ,\n        hidden: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: zoomIn,\n        style: {\n          ...frostedGlassBtnStyle,\n          marginRight: 8,\n          ...(zoomInHover ? getBtnHoverStyle(false) : {})\n        },\n        onMouseEnter: () => setZoomInHover(true),\n        onMouseLeave: () => setZoomInHover(false),\n        type: \"button\",\n        children: \"\\u653E\\u5927\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: zoomOut,\n        style: {\n          ...frostedGlassBtnStyle,\n          ...(zoomOutHover ? getBtnHoverStyle(false) : {})\n        },\n        onMouseEnter: () => setZoomOutHover(true),\n        onMouseLeave: () => setZoomOutHover(false),\n        type: \"button\",\n        children: \"\\u7F29\\u5C0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: start,\n      disabled: started,\n      style: {\n        ...(started ? disabledBtnStyle : frostedGlassBtnStyle),\n        ...(startBtnHover && !started ? getBtnHoverStyle(false) : {}),\n        marginRight: 8\n      },\n      onMouseEnter: () => setStartBtnHover(true),\n      onMouseLeave: () => setStartBtnHover(false),\n      type: \"button\",\n      children: \"\\u542F\\u52A8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: stop,\n      disabled: !started,\n      style: {\n        ...(!started ? disabledBtnStyle : frostedGlassBtnStyle),\n        ...(stopBtnHover && started ? getBtnHoverStyle(false) : {})\n      },\n      onMouseEnter: () => setStopBtnHover(true),\n      onMouseLeave: () => setStopBtnHover(false),\n      type: \"button\",\n      children: \"\\u505C\\u6B62\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 7\n    }, this), renderVideo && /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"media\",\n      style: {\n        marginTop: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          color: 'white'\n        },\n        children: \"\\u7BA1\\u5BB6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        ref: audioRef,\n        autoPlay: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        style: {\n          width: zoomWidth,\n          height: zoomWidth * initialHeight / initialWidth,\n          display: 'block'\n        },\n        autoPlay: true,\n        playsInline: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 493,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        left: chatPos.left,\n        top: chatPos.top,\n        width: 320,\n        borderRadius: 6,\n        padding: 12,\n        color: 'white',\n        userSelect: 'none',\n        cursor: draggingRef.current ? 'grabbing' : 'grab',\n        zIndex: 9999,\n        backdropFilter: 'none',\n        backgroundColor: 'transparent'\n      },\n      onMouseDown: onDragStart,\n      onMouseMove: onDragMove,\n      onMouseUp: onDragEnd,\n      onMouseLeave: onDragEnd,\n      onTouchStart: onDragStart,\n      onTouchMove: onDragMove,\n      onTouchEnd: onDragEnd,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        id: \"echo-form\",\n        onSubmit: handleSubmit,\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          gap: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"message\",\n          style: {\n            fontWeight: 'bold',\n            color: '#ccc'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: textareaRef,\n          id: \"message\",\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          rows: 3,\n          style: {\n            width: '100%',\n            resize: 'vertical',\n            fontSize: 14,\n            padding: 8,\n            borderRadius: 8,\n            border: '1px solid rgba(255, 255, 255, 0.3)',\n            backgroundColor: 'rgba(255, 255, 255, 0.1)',\n            // 半透明背景\n            backdropFilter: 'blur(10px)',\n            // 磨砂效果\n            WebkitBackdropFilter: 'blur(10px)',\n            // 兼容Safari\n            color: 'white',\n            // 白色文字\n            fontFamily: 'inherit',\n            outline: 'none',\n            transition: 'border-color 0.3s'\n          },\n          placeholder: \"\\u8BF7\\u8F93\\u5165\\u8981\\u53D1\\u9001\\u7ED9\\u7BA1\\u5BB6\\u6587\\u672C...\",\n          onClick: e => e.stopPropagation()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'flex-end',\n            alignItems: 'center',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleInterruptClick,\n            style: {\n              ...frostedGlassBtnStyle,\n              padding: '6px 16px',\n              fontSize: 14,\n              lineHeight: '1.2',\n              userSelect: 'none',\n              cursor: 'pointer'\n            },\n            onMouseEnter: () => setInterruptBtnHover(true),\n            onMouseLeave: () => setInterruptBtnHover(false)\n            // hover 样式\n            ,\n            ...(interruptBtnHover ? {\n              style: {\n                ...frostedGlassBtnStyle,\n                backgroundColor: 'rgba(255, 255, 255, 0.2)',\n                boxShadow: '0 6px 20px rgba(255, 255, 255, 0.3)',\n                transform: 'scale(1.05)',\n                padding: '6px 16px',\n                fontSize: 14,\n                lineHeight: '1.2',\n                userSelect: 'none',\n                cursor: 'pointer'\n              }\n            } : {}),\n            title: \"\\u6253\\u65AD\\u7BA1\\u5BB6\\u8BF4\\u8BDD\",\n            children: \"\\u6253\\u65AD\\u8BF4\\u8BDD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"image-upload\",\n            style: {\n              ...frostedGlassBtnStyle,\n              display: 'inline-flex',\n              alignItems: 'center',\n              cursor: 'pointer',\n              padding: '6px 12px',\n              userSelect: 'none',\n              fontSize: 14,\n              lineHeight: '1.2'\n            },\n            title: \"\\u4E0A\\u4F20\\u56FE\\u7247\",\n            children: \"\\u4E0A\\u4F20\\u56FE\\u7247\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"image-upload\",\n            type: \"file\",\n            accept: \"image/*\",\n            style: {\n              display: 'none'\n            },\n            onChange: handleImageChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 609,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            style: {\n              ...frostedGlassBtnStyle,\n              padding: '6px 16px',\n              fontSize: 14,\n              lineHeight: '1.2'\n            },\n            children: \"\\u53D1\\u9001\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 413,\n    columnNumber: 5\n  }, this);\n}\n_s(OldWebRTC, \"LAl2IA0mH2JomA4V0bMVzvXN4qU=\");\n_c = OldWebRTC;\nvar _c;\n$RefreshReg$(_c, \"OldWebRTC\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","OldWebRTC","renderVideo","keepConnection","_s","videoRef","audioRef","pcRef","textareaRef","containerRef","useStun","setUseStun","started","setStarted","zoomWidth","setZoomWidth","initialWidth","initialHeight","SIGNALING_URL","zoomStep","chatPos","setChatPos","saved","localStorage","getItem","pos","JSON","parse","left","top","draggingRef","dragOffsetRef","x","y","onDragStart","e","target","tagName","toLowerCase","current","targetRect","currentTarget","getBoundingClientRect","type","touches","clientX","clientY","preventDefault","stopPropagation","onDragMove","containerRect","newLeft","newTop","chatWidth","chatHeight","Math","min","max","width","height","onDragEnd","setItem","stringify","negotiate","pc","addTransceiver","direction","offer","createOffer","setLocalDescription","Promise","resolve","iceGatheringState","checkState","removeEventListener","addEventListener","response","fetch","method","headers","body","sdp","localDescription","answer","json","setRemoteDescription","alert","message","start","config","sdpSemantics","RTCPeerConnection","evt","track","kind","srcObject","streams","stop","setTimeout","close","getTracks","forEach","t","zoomIn","w","zoomOut","setMessage","imageFile","setImageFile","sendTextMessage","trim","text","ok","Error","status","data","console","log","error","sendMultiModal","reader","FileReader","onloadend","base64data","result","payload","image","readAsDataURL","handleSubmit","handleImageChange","file","files","remoteVideoStream","getReceivers","receiver","readyState","remoteAudioStream","frostedGlassBtnStyle","backgroundColor","border","color","fontWeight","padding","cursor","borderRadius","outline","transition","fontSize","lineHeight","backdropFilter","WebkitBackdropFilter","boxShadow","disabledBtnStyle","opacity","getBtnHoverStyle","disabled","transform","startBtnHover","setStartBtnHover","stopBtnHover","setStopBtnHover","zoomInHover","setZoomInHover","zoomOutHover","setZoomOutHover","interruptBtnHover","setInterruptBtnHover","handleInterruptClick","resp","warn","ref","style","maxWidth","position","minHeight","children","className","marginBottom","id","checked","onChange","accentColor","hidden","fileName","_jsxFileName","lineNumber","columnNumber","onClick","marginRight","onMouseEnter","onMouseLeave","marginTop","autoPlay","display","playsInline","userSelect","zIndex","onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","onSubmit","flexDirection","gap","htmlFor","value","rows","resize","fontFamily","placeholder","justifyContent","alignItems","title","accept","_c","$RefreshReg$"],"sources":["D:/XM/AI-Sphere-Butler/core/client/src/components/OldWebRTC.jsx"],"sourcesContent":["// src/components/OldWebRTC.jsx\r\nimport React, { useEffect, useRef, useState } from 'react';\r\n\r\nexport default function OldWebRTC({ renderVideo = true, keepConnection = false }) {\r\n  const videoRef = useRef(null);\r\n  const audioRef = useRef(null);\r\n  const pcRef = useRef(null);\r\n  const textareaRef = useRef(null);\r\n\r\n  const containerRef = useRef(null); // 父容器引用，用于范围限制\r\n\r\n  const [useStun, setUseStun] = useState(false);\r\n  const [started, setStarted] = useState(false);\r\n  const [zoomWidth, setZoomWidth] = useState(600);\r\n\r\n  // 视频初始宽高\r\n  const initialWidth = 600;\r\n  const initialHeight = 450; // 按你代码比例\r\n\r\n  // 信令服务器地址（根据你实际后端调整）\r\n  const SIGNALING_URL = '/offer'; // POST 地址\r\n\r\n  // 视频缩放比例\r\n  const zoomStep = 50;\r\n\r\n  // 维护聊天框位置状态，默认位置距父容器左上角20px,20px\r\n  const [chatPos, setChatPos] = useState(() => {\r\n    try {\r\n      const saved = localStorage.getItem('chatbox-position');\r\n      if (saved) {\r\n        const pos = JSON.parse(saved);\r\n        if (\r\n          typeof pos.left === 'number' &&\r\n          typeof pos.top === 'number'\r\n        ) {\r\n          return pos;\r\n        }\r\n      }\r\n    } catch {}\r\n    return { left: 20, top: 20 };\r\n  });\r\n\r\n  // 拖拽相关状态\r\n  const draggingRef = useRef(false);\r\n  const dragOffsetRef = useRef({ x: 0, y: 0 });\r\n\r\n  // 拖拽事件处理\r\n  function onDragStart(e) {\r\n    // 如果点击的是textarea，则不触发拖拽\r\n    if (e.target.tagName.toLowerCase() === 'textarea') {\r\n      draggingRef.current = false;\r\n      return;\r\n    }\r\n    \r\n    draggingRef.current = true;\r\n    const targetRect = e.currentTarget.getBoundingClientRect();\r\n    if (e.type === 'touchstart' && e.touches && e.touches[0]) {\r\n      dragOffsetRef.current = {\r\n        x: e.touches[0].clientX - targetRect.left,\r\n        y: e.touches[0].clientY - targetRect.top,\r\n      };\r\n    } else {\r\n      dragOffsetRef.current = {\r\n        x: e.clientX - targetRect.left,\r\n        y: e.clientY - targetRect.top,\r\n      };\r\n    }\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  function onDragMove(e) {\r\n    if (!draggingRef.current) return;\r\n  \r\n    let clientX, clientY;\r\n    if (e.type === 'touchmove' && e.touches && e.touches[0]) {\r\n      clientX = e.touches[0].clientX;\r\n      clientY = e.touches[0].clientY;\r\n    } else if (e.type === 'mousemove') {\r\n      clientX = e.clientX;\r\n      clientY = e.clientY;\r\n    } else {\r\n      return;\r\n    }\r\n  \r\n    if (!containerRef.current) return;\r\n  \r\n    const containerRect = containerRef.current.getBoundingClientRect();\r\n  \r\n    // 计算相对于父容器左上角的新位置\r\n    let newLeft = clientX - containerRect.left - dragOffsetRef.current.x;\r\n    let newTop = clientY - containerRect.top - dragOffsetRef.current.y;\r\n  \r\n    // 限制拖拽范围在父容器内\r\n    const chatWidth = 320;\r\n    const chatHeight = 260;\r\n  \r\n    newLeft = Math.min(Math.max(0, newLeft), containerRect.width - chatWidth);\r\n    // 修改这一行，允许拖拽到最底部，无底部间距\r\n    newTop = Math.min(Math.max(0, newTop), containerRect.height - chatHeight);\r\n  \r\n    setChatPos({ left: newLeft, top: newTop });\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n  \r\n\r\n  function onDragEnd(e) {\r\n    if (draggingRef.current) {\r\n      draggingRef.current = false;\r\n      // 保存位置\r\n      localStorage.setItem('chatbox-position', JSON.stringify(chatPos));\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  // 创建并协商 WebRTC 连接\r\n  async function negotiate() {\r\n    const pc = pcRef.current;\r\n    if (!pc) return;\r\n\r\n    pc.addTransceiver('video', { direction: 'recvonly' });\r\n    pc.addTransceiver('audio', { direction: 'recvonly' });\r\n\r\n    try {\r\n      const offer = await pc.createOffer();\r\n      await pc.setLocalDescription(offer);\r\n\r\n      // 等待 ICE gathering 完成\r\n      await new Promise((resolve) => {\r\n        if (pc.iceGatheringState === 'complete') {\r\n          resolve();\r\n        } else {\r\n          const checkState = () => {\r\n            if (pc.iceGatheringState === 'complete') {\r\n              pc.removeEventListener('icegatheringstatechange', checkState);\r\n              resolve();\r\n            }\r\n          };\r\n          pc.addEventListener('icegatheringstatechange', checkState);\r\n        }\r\n      });\r\n\r\n      // 发送本地 SDP offer 到服务器，等待答复 SDP answer\r\n      const response = await fetch(SIGNALING_URL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          sdp: pc.localDescription.sdp,\r\n          type: pc.localDescription.type,\r\n        }),\r\n      });\r\n      const answer = await response.json();\r\n\r\n      // 设置远端 SDP\r\n      await pc.setRemoteDescription(answer);\r\n\r\n      // 你原来页面有 sessionid 字段，这里不展示，需要的话可以自行扩展\r\n    } catch (e) {\r\n      alert('协商失败: ' + e.message);\r\n    }\r\n  }\r\n\r\n  function start() {\r\n    if (started) return;\r\n\r\n    const config = { sdpSemantics: 'unified-plan' };\r\n    // 注释掉 STUN 服务器配置，禁用 stun 功能\r\n    {/* if (useStun) {\r\n      config.iceServers = [{ urls: ['stun:stun.l.google.com:19302'] }];\r\n    } */}\r\n\r\n    const pc = new RTCPeerConnection(config);\r\n    pcRef.current = pc;\r\n\r\n    // 监听远端 track，绑定到 video/audio 标签\r\n    pc.addEventListener('track', (evt) => {\r\n      if (evt.track.kind === 'video') {\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = evt.streams[0];\r\n        }\r\n      } else if (evt.track.kind === 'audio') {\r\n        if (audioRef.current) {\r\n          audioRef.current.srcObject = evt.streams[0];\r\n        }\r\n      }\r\n    });\r\n\r\n    setStarted(true);\r\n\r\n    negotiate();\r\n\r\n    // 初始化视频缩放（首次设置）\r\n    setZoomWidth(initialWidth);\r\n  }\r\n\r\n  function stop() {\r\n    if (!started) return;\r\n\r\n    setStarted(false);\r\n\r\n    // 根据 keepConnection prop 决定是否真正关闭连接\r\n    if (!keepConnection) {\r\n      setTimeout(() => {\r\n        if (pcRef.current) {\r\n          pcRef.current.close();\r\n          pcRef.current = null;\r\n        }\r\n      }, 500);\r\n\r\n      if (videoRef.current && videoRef.current.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach((t) => t.stop());\r\n        videoRef.current.srcObject = null;\r\n      }\r\n      if (audioRef.current && audioRef.current.srcObject) {\r\n        audioRef.current.srcObject.getTracks().forEach((t) => t.stop());\r\n        audioRef.current.srcObject = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  // 缩放视频\r\n  function zoomIn() {\r\n    setZoomWidth((w) => w + zoomStep);\r\n  }\r\n  function zoomOut() {\r\n    setZoomWidth((w) => (w - zoomStep > 0 ? w - zoomStep : w));\r\n  }\r\n\r\n  // 文本框输入状态\r\n  const [message, setMessage] = useState('');\r\n  // 图片文件状态\r\n  const [imageFile, setImageFile] = useState(null);\r\n\r\n  // 发送文本消息函数，发送到 LLM 服务\r\n  const sendTextMessage = async () => {\r\n    if (!message.trim()) return;\r\n\r\n    try {\r\n      const response = await fetch('https://192.168.1.70:6010/qwener', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ text: message }),\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error('网络响应失败，状态码: ' + response.status);\r\n      }\r\n      const data = await response.json();\r\n      console.log('文本发送成功，服务器返回：', data);\r\n    } catch (error) {\r\n      console.error('文本发送失败：', error);\r\n    }\r\n  };\r\n\r\n  // 发送图片+文本消息函数，发送到多模态服务\r\n  const sendMultiModal = async () => {\r\n    if (!imageFile) return;\r\n\r\n    try {\r\n      const reader = new FileReader();\r\n      reader.onloadend = async () => {\r\n        const base64data = reader.result;\r\n\r\n        const payload = {\r\n          text: message.trim(), // 文字\r\n          image: base64data,     // 图片 base64\r\n        };\r\n\r\n        const response = await fetch('https://192.168.1.70:6010/multimodal', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify(payload),\r\n        });\r\n        if (!response.ok) {\r\n          throw new Error('网络响应失败，状态码: ' + response.status);\r\n        }\r\n        const data = await response.json();\r\n        console.log('多模态发送成功，服务器返回：', data);\r\n        setImageFile(null); // 清空图片\r\n        setMessage(''); // 清空文本\r\n      };\r\n      reader.readAsDataURL(imageFile);\r\n    } catch (error) {\r\n      console.error('多模态发送失败：', error);\r\n    }\r\n  };\r\n\r\n  // 表单提交处理\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (imageFile) {\r\n      // 有图片时，文本和图片一起发送到多模态服务\r\n      await sendMultiModal();\r\n    } else {\r\n      // 仅文本时，发送到 LLM 服务\r\n      await sendTextMessage();\r\n      setMessage(''); // 清空文本\r\n    }\r\n  };\r\n\r\n  // 选择图片处理\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    setImageFile(file || null);\r\n  };\r\n\r\n  // 组件挂载时，重新绑定已有远端流到 video/audio 标签，防止切换回来黑屏\r\n  useEffect(() => {\r\n    if (pcRef.current && videoRef.current && audioRef.current) {\r\n      const pc = pcRef.current;\r\n\r\n      // 视频流绑定\r\n      let remoteVideoStream = null;\r\n      pc.getReceivers().forEach((receiver) => {\r\n        if (receiver.track && receiver.track.kind === 'video') {\r\n          if (receiver.track.readyState === 'live') {\r\n            if (receiver.track.streams && receiver.track.streams[0]) {\r\n              remoteVideoStream = receiver.track.streams[0];\r\n            }\r\n          }\r\n        }\r\n      });\r\n      if (remoteVideoStream) {\r\n        videoRef.current.srcObject = remoteVideoStream;\r\n      }\r\n\r\n      // 音频流绑定\r\n      let remoteAudioStream = null;\r\n      pc.getReceivers().forEach((receiver) => {\r\n        if (receiver.track && receiver.track.kind === 'audio') {\r\n          if (receiver.track.readyState === 'live') {\r\n            if (receiver.track.streams && receiver.track.streams[0]) {\r\n              remoteAudioStream = receiver.track.streams[0];\r\n            }\r\n          }\r\n        }\r\n      });\r\n      if (remoteAudioStream) {\r\n        audioRef.current.srcObject = remoteAudioStream;\r\n      }\r\n    }\r\n  }, []); // 仅挂载时执行一次\r\n\r\n  // 通用磨砂玻璃按钮样式（纯 CSS 磨砂玻璃效果）\r\n  const frostedGlassBtnStyle = {\r\n    backgroundColor: 'rgba(255, 255, 255, 0.1)', // 半透明背景\r\n    border: '1px solid rgba(255, 255, 255, 0.3)', // 半透明边框\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    padding: '8px 16px',\r\n    cursor: 'pointer',\r\n    borderRadius: 4,\r\n    outline: 'none',\r\n    transition: 'background-color 0.3s, color 0.3s, box-shadow 0.3s, transform 0.3s',\r\n    fontSize: 14,\r\n    lineHeight: '1.2',\r\n    backdropFilter: 'blur(10px)', // 磨砂玻璃模糊\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)',\r\n  };\r\n\r\n  // 按钮禁用样式\r\n  const disabledBtnStyle = {\r\n    ...frostedGlassBtnStyle,\r\n    opacity: 0.4,\r\n    cursor: 'not-allowed',\r\n    boxShadow: 'none',\r\n  };\r\n\r\n  // 按钮 hover 效果内联样式函数\r\n  const getBtnHoverStyle = (disabled) => {\r\n    if (disabled) return {};\r\n    return {\r\n      backgroundColor: 'rgba(255, 255, 255, 0.2)',\r\n      boxShadow: '0 6px 20px rgba(255, 255, 255, 0.3)',\r\n      transform: 'scale(1.05)',\r\n    };\r\n  };\r\n\r\n  // 本组件内部按钮 hover 状态管理\r\n  const [startBtnHover, setStartBtnHover] = useState(false);\r\n  const [stopBtnHover, setStopBtnHover] = useState(false);\r\n  const [zoomInHover, setZoomInHover] = useState(false);\r\n  const [zoomOutHover, setZoomOutHover] = useState(false);\r\n  const [interruptBtnHover, setInterruptBtnHover] = useState(false); // 新增 打断按钮 hover\r\n\r\n  // 新增：点击打断说话按钮，调用后端打断接口\r\n  const handleInterruptClick = async () => {\r\n    try {\r\n      const resp = await fetch('http://192.168.168.77:6010/api/interrupt_speaking', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      if (!resp.ok) {\r\n        alert('打断请求失败，状态码: ' + resp.status);\r\n        console.warn('打断请求失败，状态码:', resp.status);\r\n      } else {\r\n        console.log('成功发送打断请求到后台');\r\n        alert('已发送打断请求');\r\n      }\r\n    } catch (e) {\r\n      alert('调用打断接口异常: ' + e.message);\r\n      console.error('调用打断接口异常:', e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div ref={containerRef} style={{ maxWidth: 1280, position: 'relative', minHeight: '100vh' }}>\r\n      <div className=\"option\" style={{ marginBottom: 8 }}>\r\n        <input\r\n          id=\"use-stun\"\r\n          type=\"checkbox\"\r\n          checked={useStun}\r\n          onChange={(e) => setUseStun(e.target.checked)}\r\n          style={{ accentColor: 'white' }}\r\n          disabled={started} // 连接启动后禁用切换，避免状态不一致\r\n          // 注释掉STUN功能，禁用选择\r\n          hidden\r\n        />\r\n        {/* <label htmlFor=\"use-stun\" style={{ marginLeft: 4, color: 'white' }}>\r\n          Use STUN server\r\n        </label> */}\r\n      </div>\r\n\r\n      {/* 将 Zoom 按钮放到 Start、Stop 上面 */}\r\n      <div style={{ marginBottom: 8 }}>\r\n        <button\r\n          onClick={zoomIn}\r\n          style={{\r\n            ...frostedGlassBtnStyle,\r\n            marginRight: 8,\r\n            ...(zoomInHover ? getBtnHoverStyle(false) : {}),\r\n          }}\r\n          onMouseEnter={() => setZoomInHover(true)}\r\n          onMouseLeave={() => setZoomInHover(false)}\r\n          type=\"button\"\r\n        >\r\n          放大\r\n        </button>\r\n        <button\r\n          onClick={zoomOut}\r\n          style={{\r\n            ...frostedGlassBtnStyle,\r\n            ...(zoomOutHover ? getBtnHoverStyle(false) : {}),\r\n          }}\r\n          onMouseEnter={() => setZoomOutHover(true)}\r\n          onMouseLeave={() => setZoomOutHover(false)}\r\n          type=\"button\"\r\n        >\r\n          缩小\r\n        </button>\r\n      </div>\r\n\r\n      <button\r\n        onClick={start}\r\n        disabled={started}\r\n        style={{\r\n          ...(started ? disabledBtnStyle : frostedGlassBtnStyle),\r\n          ...(startBtnHover && !started ? getBtnHoverStyle(false) : {}),\r\n          marginRight: 8,\r\n        }}\r\n        onMouseEnter={() => setStartBtnHover(true)}\r\n        onMouseLeave={() => setStartBtnHover(false)}\r\n        type=\"button\"\r\n      >\r\n        启动\r\n      </button>\r\n      <button\r\n        onClick={stop}\r\n        disabled={!started}\r\n        style={{\r\n          ...(!started ? disabledBtnStyle : frostedGlassBtnStyle),\r\n          ...(stopBtnHover && started ? getBtnHoverStyle(false) : {}),\r\n        }}\r\n        onMouseEnter={() => setStopBtnHover(true)}\r\n        onMouseLeave={() => setStopBtnHover(false)}\r\n        type=\"button\"\r\n      >\r\n        停止\r\n      </button>\r\n\r\n      {/* 根据 renderVideo prop 决定是否渲染视频区域 */}\r\n      {renderVideo && (\r\n        <div id=\"media\" style={{ marginTop: 20 }}>\r\n          <h2 style={{ color: 'white' }}>管家</h2>\r\n\r\n          <audio ref={audioRef} autoPlay />\r\n          <video\r\n            ref={videoRef}\r\n            style={{ width: zoomWidth, height: (zoomWidth * initialHeight) / initialWidth, display: 'block' }}\r\n            autoPlay\r\n            playsInline\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* 可拖拽的聊天对话框容器 */}\r\n      <div\r\n        style={{\r\n          position: 'absolute',\r\n          left: chatPos.left,\r\n          top: chatPos.top,\r\n          width: 320,\r\n          borderRadius: 6,\r\n          padding: 12,\r\n          color: 'white',\r\n          userSelect: 'none',\r\n          cursor: draggingRef.current ? 'grabbing' : 'grab',\r\n          zIndex: 9999,\r\n          backdropFilter: 'none',\r\n          backgroundColor: 'transparent',\r\n        }}\r\n        onMouseDown={onDragStart}\r\n        onMouseMove={onDragMove}\r\n        onMouseUp={onDragEnd}\r\n        onMouseLeave={onDragEnd}\r\n        onTouchStart={onDragStart}\r\n        onTouchMove={onDragMove}\r\n        onTouchEnd={onDragEnd}\r\n      >\r\n        {/* 文本发送表单，放在聊天框内 */}\r\n        <form\r\n          id=\"echo-form\"\r\n          onSubmit={handleSubmit}\r\n          style={{\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            gap: 8,\r\n          }}\r\n        >\r\n          <label htmlFor=\"message\" style={{ fontWeight: 'bold', color: '#ccc' }}>\r\n            {/* 可自定义标签内容 */}\r\n          </label>\r\n          <textarea\r\n            ref={textareaRef}\r\n            id=\"message\"\r\n            value={message}\r\n            onChange={(e) => setMessage(e.target.value)}\r\n            rows={3}\r\n            style={{\r\n              width: '100%',\r\n              resize: 'vertical',\r\n              fontSize: 14,\r\n              padding: 8,\r\n              borderRadius: 8,\r\n              border: '1px solid rgba(255, 255, 255, 0.3)',\r\n              backgroundColor: 'rgba(255, 255, 255, 0.1)', // 半透明背景\r\n              backdropFilter: 'blur(10px)', // 磨砂效果\r\n              WebkitBackdropFilter: 'blur(10px)', // 兼容Safari\r\n              color: 'white', // 白色文字\r\n              fontFamily: 'inherit',\r\n              outline: 'none',\r\n              transition: 'border-color 0.3s',\r\n            }}\r\n            placeholder=\"请输入要发送给管家文本...\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          />\r\n          <div\r\n            style={{\r\n              display: 'flex',\r\n              justifyContent: 'flex-end',\r\n              alignItems: 'center',\r\n              gap: 8,\r\n            }}\r\n          >\r\n             {/* 新增 打断说话按钮 */}\r\n             <button\r\n              type=\"button\"\r\n              onClick={handleInterruptClick}\r\n              style={{\r\n                ...frostedGlassBtnStyle,\r\n                padding: '6px 16px',\r\n                fontSize: 14,\r\n                lineHeight: '1.2',\r\n                userSelect: 'none',\r\n                cursor: 'pointer',\r\n              }}\r\n              onMouseEnter={() => setInterruptBtnHover(true)}\r\n              onMouseLeave={() => setInterruptBtnHover(false)}\r\n              // hover 样式\r\n              {...(interruptBtnHover ? { style: { ...frostedGlassBtnStyle, backgroundColor: 'rgba(255, 255, 255, 0.2)', boxShadow: '0 6px 20px rgba(255, 255, 255, 0.3)', transform: 'scale(1.05)', padding: '6px 16px', fontSize: 14, lineHeight: '1.2', userSelect: 'none', cursor: 'pointer' } } : {})}\r\n              title=\"打断管家说话\"\r\n            >\r\n              打断说话\r\n            </button>\r\n\r\n            {/* 上传图片按钮 */}\r\n            <label\r\n              htmlFor=\"image-upload\"\r\n              style={{\r\n                ...frostedGlassBtnStyle,\r\n                display: 'inline-flex',\r\n                alignItems: 'center',\r\n                cursor: 'pointer',\r\n                padding: '6px 12px',\r\n                userSelect: 'none',\r\n                fontSize: 14,\r\n                lineHeight: '1.2',\r\n              }}\r\n              title=\"上传图片\"\r\n            >\r\n              上传图片\r\n            </label>\r\n            <input\r\n              id=\"image-upload\"\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              style={{ display: 'none' }}\r\n              onChange={handleImageChange}\r\n            />\r\n            <button\r\n              type=\"submit\"\r\n              style={{\r\n                ...frostedGlassBtnStyle,\r\n                padding: '6px 16px',\r\n                fontSize: 14,\r\n                lineHeight: '1.2',\r\n              }}\r\n            >\r\n              发送\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3D,eAAe,SAASC,SAASA,CAAC;EAAEC,WAAW,GAAG,IAAI;EAAEC,cAAc,GAAG;AAAM,CAAC,EAAE;EAAAC,EAAA;EAChF,MAAMC,QAAQ,GAAGR,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMS,QAAQ,GAAGT,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMU,KAAK,GAAGV,MAAM,CAAC,IAAI,CAAC;EAC1B,MAAMW,WAAW,GAAGX,MAAM,CAAC,IAAI,CAAC;EAEhC,MAAMY,YAAY,GAAGZ,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;;EAEnC,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGb,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACc,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACgB,SAAS,EAAEC,YAAY,CAAC,GAAGjB,QAAQ,CAAC,GAAG,CAAC;;EAE/C;EACA,MAAMkB,YAAY,GAAG,GAAG;EACxB,MAAMC,aAAa,GAAG,GAAG,CAAC,CAAC;;EAE3B;EACA,MAAMC,aAAa,GAAG,QAAQ,CAAC,CAAC;;EAEhC;EACA,MAAMC,QAAQ,GAAG,EAAE;;EAEnB;EACA,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGvB,QAAQ,CAAC,MAAM;IAC3C,IAAI;MACF,MAAMwB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC;MACtD,IAAIF,KAAK,EAAE;QACT,MAAMG,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACL,KAAK,CAAC;QAC7B,IACE,OAAOG,GAAG,CAACG,IAAI,KAAK,QAAQ,IAC5B,OAAOH,GAAG,CAACI,GAAG,KAAK,QAAQ,EAC3B;UACA,OAAOJ,GAAG;QACZ;MACF;IACF,CAAC,CAAC,MAAM,CAAC;IACT,OAAO;MAAEG,IAAI,EAAE,EAAE;MAAEC,GAAG,EAAE;IAAG,CAAC;EAC9B,CAAC,CAAC;;EAEF;EACA,MAAMC,WAAW,GAAGjC,MAAM,CAAC,KAAK,CAAC;EACjC,MAAMkC,aAAa,GAAGlC,MAAM,CAAC;IAAEmC,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE;EAAE,CAAC,CAAC;;EAE5C;EACA,SAASC,WAAWA,CAACC,CAAC,EAAE;IACtB;IACA,IAAIA,CAAC,CAACC,MAAM,CAACC,OAAO,CAACC,WAAW,CAAC,CAAC,KAAK,UAAU,EAAE;MACjDR,WAAW,CAACS,OAAO,GAAG,KAAK;MAC3B;IACF;IAEAT,WAAW,CAACS,OAAO,GAAG,IAAI;IAC1B,MAAMC,UAAU,GAAGL,CAAC,CAACM,aAAa,CAACC,qBAAqB,CAAC,CAAC;IAC1D,IAAIP,CAAC,CAACQ,IAAI,KAAK,YAAY,IAAIR,CAAC,CAACS,OAAO,IAAIT,CAAC,CAACS,OAAO,CAAC,CAAC,CAAC,EAAE;MACxDb,aAAa,CAACQ,OAAO,GAAG;QACtBP,CAAC,EAAEG,CAAC,CAACS,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO,GAAGL,UAAU,CAACZ,IAAI;QACzCK,CAAC,EAAEE,CAAC,CAACS,OAAO,CAAC,CAAC,CAAC,CAACE,OAAO,GAAGN,UAAU,CAACX;MACvC,CAAC;IACH,CAAC,MAAM;MACLE,aAAa,CAACQ,OAAO,GAAG;QACtBP,CAAC,EAAEG,CAAC,CAACU,OAAO,GAAGL,UAAU,CAACZ,IAAI;QAC9BK,CAAC,EAAEE,CAAC,CAACW,OAAO,GAAGN,UAAU,CAACX;MAC5B,CAAC;IACH;IACAM,CAAC,CAACY,cAAc,CAAC,CAAC;IAClBZ,CAAC,CAACa,eAAe,CAAC,CAAC;EACrB;EAEA,SAASC,UAAUA,CAACd,CAAC,EAAE;IACrB,IAAI,CAACL,WAAW,CAACS,OAAO,EAAE;IAE1B,IAAIM,OAAO,EAAEC,OAAO;IACpB,IAAIX,CAAC,CAACQ,IAAI,KAAK,WAAW,IAAIR,CAAC,CAACS,OAAO,IAAIT,CAAC,CAACS,OAAO,CAAC,CAAC,CAAC,EAAE;MACvDC,OAAO,GAAGV,CAAC,CAACS,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO;MAC9BC,OAAO,GAAGX,CAAC,CAACS,OAAO,CAAC,CAAC,CAAC,CAACE,OAAO;IAChC,CAAC,MAAM,IAAIX,CAAC,CAACQ,IAAI,KAAK,WAAW,EAAE;MACjCE,OAAO,GAAGV,CAAC,CAACU,OAAO;MACnBC,OAAO,GAAGX,CAAC,CAACW,OAAO;IACrB,CAAC,MAAM;MACL;IACF;IAEA,IAAI,CAACrC,YAAY,CAAC8B,OAAO,EAAE;IAE3B,MAAMW,aAAa,GAAGzC,YAAY,CAAC8B,OAAO,CAACG,qBAAqB,CAAC,CAAC;;IAElE;IACA,IAAIS,OAAO,GAAGN,OAAO,GAAGK,aAAa,CAACtB,IAAI,GAAGG,aAAa,CAACQ,OAAO,CAACP,CAAC;IACpE,IAAIoB,MAAM,GAAGN,OAAO,GAAGI,aAAa,CAACrB,GAAG,GAAGE,aAAa,CAACQ,OAAO,CAACN,CAAC;;IAElE;IACA,MAAMoB,SAAS,GAAG,GAAG;IACrB,MAAMC,UAAU,GAAG,GAAG;IAEtBH,OAAO,GAAGI,IAAI,CAACC,GAAG,CAACD,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEN,OAAO,CAAC,EAAED,aAAa,CAACQ,KAAK,GAAGL,SAAS,CAAC;IACzE;IACAD,MAAM,GAAGG,IAAI,CAACC,GAAG,CAACD,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEL,MAAM,CAAC,EAAEF,aAAa,CAACS,MAAM,GAAGL,UAAU,CAAC;IAEzEjC,UAAU,CAAC;MAAEO,IAAI,EAAEuB,OAAO;MAAEtB,GAAG,EAAEuB;IAAO,CAAC,CAAC;IAC1CjB,CAAC,CAACY,cAAc,CAAC,CAAC;IAClBZ,CAAC,CAACa,eAAe,CAAC,CAAC;EACrB;EAGA,SAASY,SAASA,CAACzB,CAAC,EAAE;IACpB,IAAIL,WAAW,CAACS,OAAO,EAAE;MACvBT,WAAW,CAACS,OAAO,GAAG,KAAK;MAC3B;MACAhB,YAAY,CAACsC,OAAO,CAAC,kBAAkB,EAAEnC,IAAI,CAACoC,SAAS,CAAC1C,OAAO,CAAC,CAAC;MACjEe,CAAC,CAACY,cAAc,CAAC,CAAC;MAClBZ,CAAC,CAACa,eAAe,CAAC,CAAC;IACrB;EACF;;EAEA;EACA,eAAee,SAASA,CAAA,EAAG;IACzB,MAAMC,EAAE,GAAGzD,KAAK,CAACgC,OAAO;IACxB,IAAI,CAACyB,EAAE,EAAE;IAETA,EAAE,CAACC,cAAc,CAAC,OAAO,EAAE;MAAEC,SAAS,EAAE;IAAW,CAAC,CAAC;IACrDF,EAAE,CAACC,cAAc,CAAC,OAAO,EAAE;MAAEC,SAAS,EAAE;IAAW,CAAC,CAAC;IAErD,IAAI;MACF,MAAMC,KAAK,GAAG,MAAMH,EAAE,CAACI,WAAW,CAAC,CAAC;MACpC,MAAMJ,EAAE,CAACK,mBAAmB,CAACF,KAAK,CAAC;;MAEnC;MACA,MAAM,IAAIG,OAAO,CAAEC,OAAO,IAAK;QAC7B,IAAIP,EAAE,CAACQ,iBAAiB,KAAK,UAAU,EAAE;UACvCD,OAAO,CAAC,CAAC;QACX,CAAC,MAAM;UACL,MAAME,UAAU,GAAGA,CAAA,KAAM;YACvB,IAAIT,EAAE,CAACQ,iBAAiB,KAAK,UAAU,EAAE;cACvCR,EAAE,CAACU,mBAAmB,CAAC,yBAAyB,EAAED,UAAU,CAAC;cAC7DF,OAAO,CAAC,CAAC;YACX;UACF,CAAC;UACDP,EAAE,CAACW,gBAAgB,CAAC,yBAAyB,EAAEF,UAAU,CAAC;QAC5D;MACF,CAAC,CAAC;;MAEF;MACA,MAAMG,QAAQ,GAAG,MAAMC,KAAK,CAAC3D,aAAa,EAAE;QAC1C4D,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEtD,IAAI,CAACoC,SAAS,CAAC;UACnBmB,GAAG,EAAEjB,EAAE,CAACkB,gBAAgB,CAACD,GAAG;UAC5BtC,IAAI,EAAEqB,EAAE,CAACkB,gBAAgB,CAACvC;QAC5B,CAAC;MACH,CAAC,CAAC;MACF,MAAMwC,MAAM,GAAG,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;;MAEpC;MACA,MAAMpB,EAAE,CAACqB,oBAAoB,CAACF,MAAM,CAAC;;MAErC;IACF,CAAC,CAAC,OAAOhD,CAAC,EAAE;MACVmD,KAAK,CAAC,QAAQ,GAAGnD,CAAC,CAACoD,OAAO,CAAC;IAC7B;EACF;EAEA,SAASC,KAAKA,CAAA,EAAG;IACf,IAAI5E,OAAO,EAAE;IAEb,MAAM6E,MAAM,GAAG;MAAEC,YAAY,EAAE;IAAe,CAAC;IAC/C;IACA,CAAC;AACL;AACA,SAFK;IAID,MAAM1B,EAAE,GAAG,IAAI2B,iBAAiB,CAACF,MAAM,CAAC;IACxClF,KAAK,CAACgC,OAAO,GAAGyB,EAAE;;IAElB;IACAA,EAAE,CAACW,gBAAgB,CAAC,OAAO,EAAGiB,GAAG,IAAK;MACpC,IAAIA,GAAG,CAACC,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;QAC9B,IAAIzF,QAAQ,CAACkC,OAAO,EAAE;UACpBlC,QAAQ,CAACkC,OAAO,CAACwD,SAAS,GAAGH,GAAG,CAACI,OAAO,CAAC,CAAC,CAAC;QAC7C;MACF,CAAC,MAAM,IAAIJ,GAAG,CAACC,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;QACrC,IAAIxF,QAAQ,CAACiC,OAAO,EAAE;UACpBjC,QAAQ,CAACiC,OAAO,CAACwD,SAAS,GAAGH,GAAG,CAACI,OAAO,CAAC,CAAC,CAAC;QAC7C;MACF;IACF,CAAC,CAAC;IAEFnF,UAAU,CAAC,IAAI,CAAC;IAEhBkD,SAAS,CAAC,CAAC;;IAEX;IACAhD,YAAY,CAACC,YAAY,CAAC;EAC5B;EAEA,SAASiF,IAAIA,CAAA,EAAG;IACd,IAAI,CAACrF,OAAO,EAAE;IAEdC,UAAU,CAAC,KAAK,CAAC;;IAEjB;IACA,IAAI,CAACV,cAAc,EAAE;MACnB+F,UAAU,CAAC,MAAM;QACf,IAAI3F,KAAK,CAACgC,OAAO,EAAE;UACjBhC,KAAK,CAACgC,OAAO,CAAC4D,KAAK,CAAC,CAAC;UACrB5F,KAAK,CAACgC,OAAO,GAAG,IAAI;QACtB;MACF,CAAC,EAAE,GAAG,CAAC;MAEP,IAAIlC,QAAQ,CAACkC,OAAO,IAAIlC,QAAQ,CAACkC,OAAO,CAACwD,SAAS,EAAE;QAClD1F,QAAQ,CAACkC,OAAO,CAACwD,SAAS,CAACK,SAAS,CAAC,CAAC,CAACC,OAAO,CAAEC,CAAC,IAAKA,CAAC,CAACL,IAAI,CAAC,CAAC,CAAC;QAC/D5F,QAAQ,CAACkC,OAAO,CAACwD,SAAS,GAAG,IAAI;MACnC;MACA,IAAIzF,QAAQ,CAACiC,OAAO,IAAIjC,QAAQ,CAACiC,OAAO,CAACwD,SAAS,EAAE;QAClDzF,QAAQ,CAACiC,OAAO,CAACwD,SAAS,CAACK,SAAS,CAAC,CAAC,CAACC,OAAO,CAAEC,CAAC,IAAKA,CAAC,CAACL,IAAI,CAAC,CAAC,CAAC;QAC/D3F,QAAQ,CAACiC,OAAO,CAACwD,SAAS,GAAG,IAAI;MACnC;IACF;EACF;;EAEA;EACA,SAASQ,MAAMA,CAAA,EAAG;IAChBxF,YAAY,CAAEyF,CAAC,IAAKA,CAAC,GAAGrF,QAAQ,CAAC;EACnC;EACA,SAASsF,OAAOA,CAAA,EAAG;IACjB1F,YAAY,CAAEyF,CAAC,IAAMA,CAAC,GAAGrF,QAAQ,GAAG,CAAC,GAAGqF,CAAC,GAAGrF,QAAQ,GAAGqF,CAAE,CAAC;EAC5D;;EAEA;EACA,MAAM,CAACjB,OAAO,EAAEmB,UAAU,CAAC,GAAG5G,QAAQ,CAAC,EAAE,CAAC;EAC1C;EACA,MAAM,CAAC6G,SAAS,EAAEC,YAAY,CAAC,GAAG9G,QAAQ,CAAC,IAAI,CAAC;;EAEhD;EACA,MAAM+G,eAAe,GAAG,MAAAA,CAAA,KAAY;IAClC,IAAI,CAACtB,OAAO,CAACuB,IAAI,CAAC,CAAC,EAAE;IAErB,IAAI;MACF,MAAMlC,QAAQ,GAAG,MAAMC,KAAK,CAAC,kCAAkC,EAAE;QAC/DC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEtD,IAAI,CAACoC,SAAS,CAAC;UAAEiD,IAAI,EAAExB;QAAQ,CAAC;MACxC,CAAC,CAAC;MACF,IAAI,CAACX,QAAQ,CAACoC,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAAC,cAAc,GAAGrC,QAAQ,CAACsC,MAAM,CAAC;MACnD;MACA,MAAMC,IAAI,GAAG,MAAMvC,QAAQ,CAACQ,IAAI,CAAC,CAAC;MAClCgC,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEF,IAAI,CAAC;IACpC,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,SAAS,EAAEA,KAAK,CAAC;IACjC;EACF,CAAC;;EAED;EACA,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI,CAACZ,SAAS,EAAE;IAEhB,IAAI;MACF,MAAMa,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,SAAS,GAAG,YAAY;QAC7B,MAAMC,UAAU,GAAGH,MAAM,CAACI,MAAM;QAEhC,MAAMC,OAAO,GAAG;UACdd,IAAI,EAAExB,OAAO,CAACuB,IAAI,CAAC,CAAC;UAAE;UACtBgB,KAAK,EAAEH,UAAU,CAAM;QACzB,CAAC;QAED,MAAM/C,QAAQ,GAAG,MAAMC,KAAK,CAAC,sCAAsC,EAAE;UACnEC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,cAAc,EAAE;UAClB,CAAC;UACDC,IAAI,EAAEtD,IAAI,CAACoC,SAAS,CAAC+D,OAAO;QAC9B,CAAC,CAAC;QACF,IAAI,CAACjD,QAAQ,CAACoC,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAC,cAAc,GAAGrC,QAAQ,CAACsC,MAAM,CAAC;QACnD;QACA,MAAMC,IAAI,GAAG,MAAMvC,QAAQ,CAACQ,IAAI,CAAC,CAAC;QAClCgC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEF,IAAI,CAAC;QACnCP,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;QACpBF,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC;MAClB,CAAC;MACDc,MAAM,CAACO,aAAa,CAACpB,SAAS,CAAC;IACjC,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;IAClC;EACF,CAAC;;EAED;EACA,MAAMU,YAAY,GAAG,MAAO7F,CAAC,IAAK;IAChCA,CAAC,CAACY,cAAc,CAAC,CAAC;IAClB,IAAI4D,SAAS,EAAE;MACb;MACA,MAAMY,cAAc,CAAC,CAAC;IACxB,CAAC,MAAM;MACL;MACA,MAAMV,eAAe,CAAC,CAAC;MACvBH,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC;IAClB;EACF,CAAC;;EAED;EACA,MAAMuB,iBAAiB,GAAI9F,CAAC,IAAK;IAC/B,MAAM+F,IAAI,GAAG/F,CAAC,CAACC,MAAM,CAAC+F,KAAK,CAAC,CAAC,CAAC;IAC9BvB,YAAY,CAACsB,IAAI,IAAI,IAAI,CAAC;EAC5B,CAAC;;EAED;EACAtI,SAAS,CAAC,MAAM;IACd,IAAIW,KAAK,CAACgC,OAAO,IAAIlC,QAAQ,CAACkC,OAAO,IAAIjC,QAAQ,CAACiC,OAAO,EAAE;MACzD,MAAMyB,EAAE,GAAGzD,KAAK,CAACgC,OAAO;;MAExB;MACA,IAAI6F,iBAAiB,GAAG,IAAI;MAC5BpE,EAAE,CAACqE,YAAY,CAAC,CAAC,CAAChC,OAAO,CAAEiC,QAAQ,IAAK;QACtC,IAAIA,QAAQ,CAACzC,KAAK,IAAIyC,QAAQ,CAACzC,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;UACrD,IAAIwC,QAAQ,CAACzC,KAAK,CAAC0C,UAAU,KAAK,MAAM,EAAE;YACxC,IAAID,QAAQ,CAACzC,KAAK,CAACG,OAAO,IAAIsC,QAAQ,CAACzC,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,EAAE;cACvDoC,iBAAiB,GAAGE,QAAQ,CAACzC,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC;YAC/C;UACF;QACF;MACF,CAAC,CAAC;MACF,IAAIoC,iBAAiB,EAAE;QACrB/H,QAAQ,CAACkC,OAAO,CAACwD,SAAS,GAAGqC,iBAAiB;MAChD;;MAEA;MACA,IAAII,iBAAiB,GAAG,IAAI;MAC5BxE,EAAE,CAACqE,YAAY,CAAC,CAAC,CAAChC,OAAO,CAAEiC,QAAQ,IAAK;QACtC,IAAIA,QAAQ,CAACzC,KAAK,IAAIyC,QAAQ,CAACzC,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;UACrD,IAAIwC,QAAQ,CAACzC,KAAK,CAAC0C,UAAU,KAAK,MAAM,EAAE;YACxC,IAAID,QAAQ,CAACzC,KAAK,CAACG,OAAO,IAAIsC,QAAQ,CAACzC,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,EAAE;cACvDwC,iBAAiB,GAAGF,QAAQ,CAACzC,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC;YAC/C;UACF;QACF;MACF,CAAC,CAAC;MACF,IAAIwC,iBAAiB,EAAE;QACrBlI,QAAQ,CAACiC,OAAO,CAACwD,SAAS,GAAGyC,iBAAiB;MAChD;IACF;EACF,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;;EAER;EACA,MAAMC,oBAAoB,GAAG;IAC3BC,eAAe,EAAE,0BAA0B;IAAE;IAC7CC,MAAM,EAAE,oCAAoC;IAAE;IAC9CC,KAAK,EAAE,OAAO;IACdC,UAAU,EAAE,MAAM;IAClBC,OAAO,EAAE,UAAU;IACnBC,MAAM,EAAE,SAAS;IACjBC,YAAY,EAAE,CAAC;IACfC,OAAO,EAAE,MAAM;IACfC,UAAU,EAAE,oEAAoE;IAChFC,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,KAAK;IACjBC,cAAc,EAAE,YAAY;IAAE;IAC9BC,oBAAoB,EAAE,YAAY;IAClCC,SAAS,EAAE;EACb,CAAC;;EAED;EACA,MAAMC,gBAAgB,GAAG;IACvB,GAAGf,oBAAoB;IACvBgB,OAAO,EAAE,GAAG;IACZV,MAAM,EAAE,aAAa;IACrBQ,SAAS,EAAE;EACb,CAAC;;EAED;EACA,MAAMG,gBAAgB,GAAIC,QAAQ,IAAK;IACrC,IAAIA,QAAQ,EAAE,OAAO,CAAC,CAAC;IACvB,OAAO;MACLjB,eAAe,EAAE,0BAA0B;MAC3Ca,SAAS,EAAE,qCAAqC;MAChDK,SAAS,EAAE;IACb,CAAC;EACH,CAAC;;EAED;EACA,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGhK,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACiK,YAAY,EAAEC,eAAe,CAAC,GAAGlK,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAACmK,WAAW,EAAEC,cAAc,CAAC,GAAGpK,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACqK,YAAY,EAAEC,eAAe,CAAC,GAAGtK,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAACuK,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGxK,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;;EAEnE;EACA,MAAMyK,oBAAoB,GAAG,MAAAA,CAAA,KAAY;IACvC,IAAI;MACF,MAAMC,IAAI,GAAG,MAAM3F,KAAK,CAAC,mDAAmD,EAAE;QAC5EC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB;MAChD,CAAC,CAAC;MACF,IAAI,CAACyF,IAAI,CAACxD,EAAE,EAAE;QACZ1B,KAAK,CAAC,cAAc,GAAGkF,IAAI,CAACtD,MAAM,CAAC;QACnCE,OAAO,CAACqD,IAAI,CAAC,aAAa,EAAED,IAAI,CAACtD,MAAM,CAAC;MAC1C,CAAC,MAAM;QACLE,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;QAC1B/B,KAAK,CAAC,SAAS,CAAC;MAClB;IACF,CAAC,CAAC,OAAOnD,CAAC,EAAE;MACVmD,KAAK,CAAC,YAAY,GAAGnD,CAAC,CAACoD,OAAO,CAAC;MAC/B6B,OAAO,CAACE,KAAK,CAAC,WAAW,EAAEnF,CAAC,CAAC;IAC/B;EACF,CAAC;EAED,oBACEnC,OAAA;IAAK0K,GAAG,EAAEjK,YAAa;IAACkK,KAAK,EAAE;MAAEC,QAAQ,EAAE,IAAI;MAAEC,QAAQ,EAAE,UAAU;MAAEC,SAAS,EAAE;IAAQ,CAAE;IAAAC,QAAA,gBAC1F/K,OAAA;MAAKgL,SAAS,EAAC,QAAQ;MAACL,KAAK,EAAE;QAAEM,YAAY,EAAE;MAAE,CAAE;MAAAF,QAAA,eACjD/K,OAAA;QACEkL,EAAE,EAAC,UAAU;QACbvI,IAAI,EAAC,UAAU;QACfwI,OAAO,EAAEzK,OAAQ;QACjB0K,QAAQ,EAAGjJ,CAAC,IAAKxB,UAAU,CAACwB,CAAC,CAACC,MAAM,CAAC+I,OAAO,CAAE;QAC9CR,KAAK,EAAE;UAAEU,WAAW,EAAE;QAAQ,CAAE;QAChC1B,QAAQ,EAAE/I,OAAQ,CAAC;QACnB;QAAA;QACA0K,MAAM;MAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACP;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAIC,CAAC,eAGN1L,OAAA;MAAK2K,KAAK,EAAE;QAAEM,YAAY,EAAE;MAAE,CAAE;MAAAF,QAAA,gBAC9B/K,OAAA;QACE2L,OAAO,EAAEpF,MAAO;QAChBoE,KAAK,EAAE;UACL,GAAGlC,oBAAoB;UACvBmD,WAAW,EAAE,CAAC;UACd,IAAI3B,WAAW,GAAGP,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAChD,CAAE;QACFmC,YAAY,EAAEA,CAAA,KAAM3B,cAAc,CAAC,IAAI,CAAE;QACzC4B,YAAY,EAAEA,CAAA,KAAM5B,cAAc,CAAC,KAAK,CAAE;QAC1CvH,IAAI,EAAC,QAAQ;QAAAoI,QAAA,EACd;MAED;QAAAQ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACT1L,OAAA;QACE2L,OAAO,EAAElF,OAAQ;QACjBkE,KAAK,EAAE;UACL,GAAGlC,oBAAoB;UACvB,IAAI0B,YAAY,GAAGT,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACjD,CAAE;QACFmC,YAAY,EAAEA,CAAA,KAAMzB,eAAe,CAAC,IAAI,CAAE;QAC1C0B,YAAY,EAAEA,CAAA,KAAM1B,eAAe,CAAC,KAAK,CAAE;QAC3CzH,IAAI,EAAC,QAAQ;QAAAoI,QAAA,EACd;MAED;QAAAQ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,eAEN1L,OAAA;MACE2L,OAAO,EAAEnG,KAAM;MACfmE,QAAQ,EAAE/I,OAAQ;MAClB+J,KAAK,EAAE;QACL,IAAI/J,OAAO,GAAG4I,gBAAgB,GAAGf,oBAAoB,CAAC;QACtD,IAAIoB,aAAa,IAAI,CAACjJ,OAAO,GAAG8I,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QAC7DkC,WAAW,EAAE;MACf,CAAE;MACFC,YAAY,EAAEA,CAAA,KAAM/B,gBAAgB,CAAC,IAAI,CAAE;MAC3CgC,YAAY,EAAEA,CAAA,KAAMhC,gBAAgB,CAAC,KAAK,CAAE;MAC5CnH,IAAI,EAAC,QAAQ;MAAAoI,QAAA,EACd;IAED;MAAAQ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eACT1L,OAAA;MACE2L,OAAO,EAAE1F,IAAK;MACd0D,QAAQ,EAAE,CAAC/I,OAAQ;MACnB+J,KAAK,EAAE;QACL,IAAI,CAAC/J,OAAO,GAAG4I,gBAAgB,GAAGf,oBAAoB,CAAC;QACvD,IAAIsB,YAAY,IAAInJ,OAAO,GAAG8I,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;MAC5D,CAAE;MACFmC,YAAY,EAAEA,CAAA,KAAM7B,eAAe,CAAC,IAAI,CAAE;MAC1C8B,YAAY,EAAEA,CAAA,KAAM9B,eAAe,CAAC,KAAK,CAAE;MAC3CrH,IAAI,EAAC,QAAQ;MAAAoI,QAAA,EACd;IAED;MAAAQ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,EAGRxL,WAAW,iBACVF,OAAA;MAAKkL,EAAE,EAAC,OAAO;MAACP,KAAK,EAAE;QAAEoB,SAAS,EAAE;MAAG,CAAE;MAAAhB,QAAA,gBACvC/K,OAAA;QAAI2K,KAAK,EAAE;UAAE/B,KAAK,EAAE;QAAQ,CAAE;QAAAmC,QAAA,EAAC;MAAE;QAAAQ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAEtC1L,OAAA;QAAO0K,GAAG,EAAEpK,QAAS;QAAC0L,QAAQ;MAAA;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACjC1L,OAAA;QACE0K,GAAG,EAAErK,QAAS;QACdsK,KAAK,EAAE;UAAEjH,KAAK,EAAE5C,SAAS;UAAE6C,MAAM,EAAG7C,SAAS,GAAGG,aAAa,GAAID,YAAY;UAAEiL,OAAO,EAAE;QAAQ,CAAE;QAClGD,QAAQ;QACRE,WAAW;MAAA;QAAAX,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACZ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CACN,eAGD1L,OAAA;MACE2K,KAAK,EAAE;QACLE,QAAQ,EAAE,UAAU;QACpBjJ,IAAI,EAAER,OAAO,CAACQ,IAAI;QAClBC,GAAG,EAAET,OAAO,CAACS,GAAG;QAChB6B,KAAK,EAAE,GAAG;QACVsF,YAAY,EAAE,CAAC;QACfF,OAAO,EAAE,EAAE;QACXF,KAAK,EAAE,OAAO;QACduD,UAAU,EAAE,MAAM;QAClBpD,MAAM,EAAEjH,WAAW,CAACS,OAAO,GAAG,UAAU,GAAG,MAAM;QACjD6J,MAAM,EAAE,IAAI;QACZ/C,cAAc,EAAE,MAAM;QACtBX,eAAe,EAAE;MACnB,CAAE;MACF2D,WAAW,EAAEnK,WAAY;MACzBoK,WAAW,EAAErJ,UAAW;MACxBsJ,SAAS,EAAE3I,SAAU;MACrBkI,YAAY,EAAElI,SAAU;MACxB4I,YAAY,EAAEtK,WAAY;MAC1BuK,WAAW,EAAExJ,UAAW;MACxByJ,UAAU,EAAE9I,SAAU;MAAAmH,QAAA,eAGtB/K,OAAA;QACEkL,EAAE,EAAC,WAAW;QACdyB,QAAQ,EAAE3E,YAAa;QACvB2C,KAAK,EAAE;UACLsB,OAAO,EAAE,MAAM;UACfW,aAAa,EAAE,QAAQ;UACvBC,GAAG,EAAE;QACP,CAAE;QAAA9B,QAAA,gBAEF/K,OAAA;UAAO8M,OAAO,EAAC,SAAS;UAACnC,KAAK,EAAE;YAAE9B,UAAU,EAAE,MAAM;YAAED,KAAK,EAAE;UAAO;QAAE;UAAA2C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAE/D,CAAC,eACR1L,OAAA;UACE0K,GAAG,EAAElK,WAAY;UACjB0K,EAAE,EAAC,SAAS;UACZ6B,KAAK,EAAExH,OAAQ;UACf6F,QAAQ,EAAGjJ,CAAC,IAAKuE,UAAU,CAACvE,CAAC,CAACC,MAAM,CAAC2K,KAAK,CAAE;UAC5CC,IAAI,EAAE,CAAE;UACRrC,KAAK,EAAE;YACLjH,KAAK,EAAE,MAAM;YACbuJ,MAAM,EAAE,UAAU;YAClB9D,QAAQ,EAAE,EAAE;YACZL,OAAO,EAAE,CAAC;YACVE,YAAY,EAAE,CAAC;YACfL,MAAM,EAAE,oCAAoC;YAC5CD,eAAe,EAAE,0BAA0B;YAAE;YAC7CW,cAAc,EAAE,YAAY;YAAE;YAC9BC,oBAAoB,EAAE,YAAY;YAAE;YACpCV,KAAK,EAAE,OAAO;YAAE;YAChBsE,UAAU,EAAE,SAAS;YACrBjE,OAAO,EAAE,MAAM;YACfC,UAAU,EAAE;UACd,CAAE;UACFiE,WAAW,EAAC,uEAAgB;UAC5BxB,OAAO,EAAGxJ,CAAC,IAAKA,CAAC,CAACa,eAAe,CAAC;QAAE;UAAAuI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrC,CAAC,eACF1L,OAAA;UACE2K,KAAK,EAAE;YACLsB,OAAO,EAAE,MAAM;YACfmB,cAAc,EAAE,UAAU;YAC1BC,UAAU,EAAE,QAAQ;YACpBR,GAAG,EAAE;UACP,CAAE;UAAA9B,QAAA,gBAGD/K,OAAA;YACC2C,IAAI,EAAC,QAAQ;YACbgJ,OAAO,EAAEpB,oBAAqB;YAC9BI,KAAK,EAAE;cACL,GAAGlC,oBAAoB;cACvBK,OAAO,EAAE,UAAU;cACnBK,QAAQ,EAAE,EAAE;cACZC,UAAU,EAAE,KAAK;cACjB+C,UAAU,EAAE,MAAM;cAClBpD,MAAM,EAAE;YACV,CAAE;YACF8C,YAAY,EAAEA,CAAA,KAAMvB,oBAAoB,CAAC,IAAI,CAAE;YAC/CwB,YAAY,EAAEA,CAAA,KAAMxB,oBAAoB,CAAC,KAAK;YAC9C;YAAA;YAAA,IACKD,iBAAiB,GAAG;cAAEM,KAAK,EAAE;gBAAE,GAAGlC,oBAAoB;gBAAEC,eAAe,EAAE,0BAA0B;gBAAEa,SAAS,EAAE,qCAAqC;gBAAEK,SAAS,EAAE,aAAa;gBAAEd,OAAO,EAAE,UAAU;gBAAEK,QAAQ,EAAE,EAAE;gBAAEC,UAAU,EAAE,KAAK;gBAAE+C,UAAU,EAAE,MAAM;gBAAEpD,MAAM,EAAE;cAAU;YAAE,CAAC,GAAG,CAAC,CAAC;YAC1RuE,KAAK,EAAC,sCAAQ;YAAAvC,QAAA,EACf;UAED;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAGT1L,OAAA;YACE8M,OAAO,EAAC,cAAc;YACtBnC,KAAK,EAAE;cACL,GAAGlC,oBAAoB;cACvBwD,OAAO,EAAE,aAAa;cACtBoB,UAAU,EAAE,QAAQ;cACpBtE,MAAM,EAAE,SAAS;cACjBD,OAAO,EAAE,UAAU;cACnBqD,UAAU,EAAE,MAAM;cAClBhD,QAAQ,EAAE,EAAE;cACZC,UAAU,EAAE;YACd,CAAE;YACFkE,KAAK,EAAC,0BAAM;YAAAvC,QAAA,EACb;UAED;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACR1L,OAAA;YACEkL,EAAE,EAAC,cAAc;YACjBvI,IAAI,EAAC,MAAM;YACX4K,MAAM,EAAC,SAAS;YAChB5C,KAAK,EAAE;cAAEsB,OAAO,EAAE;YAAO,CAAE;YAC3Bb,QAAQ,EAAEnD;UAAkB;YAAAsD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7B,CAAC,eACF1L,OAAA;YACE2C,IAAI,EAAC,QAAQ;YACbgI,KAAK,EAAE;cACL,GAAGlC,oBAAoB;cACvBK,OAAO,EAAE,UAAU;cACnBK,QAAQ,EAAE,EAAE;cACZC,UAAU,EAAE;YACd,CAAE;YAAA2B,QAAA,EACH;UAED;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACtL,EAAA,CApnBuBH,SAAS;AAAAuN,EAAA,GAATvN,SAAS;AAAA,IAAAuN,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}