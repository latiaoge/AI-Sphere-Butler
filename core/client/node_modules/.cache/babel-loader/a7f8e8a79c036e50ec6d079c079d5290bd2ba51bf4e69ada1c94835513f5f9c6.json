{"ast":null,"code":"var _jsxFileName = \"D:\\\\XM\\\\AI-Sphere-Butler\\\\core\\\\client\\\\src\\\\components\\\\AudioTranscriber.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useRecorder } from '../hooks/useRecorder';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function AudioTranscriber() {\n  _s();\n  // 录音状态\n  const [isRecording, setIsRecording] = useState(false);\n  // 转写文本内容\n  const [transcription, setTranscription] = useState('');\n  // 语言参数，默认 auto\n  const [lang, setLang] = useState('auto');\n  // 是否开启声纹识别\n  const [speakerVerification, setSpeakerVerification] = useState(false);\n\n  // 自定义录音 Hook，管理录音功能\n  const recorder = useRecorder();\n\n  // WebSocket 实例引用\n  const wsRef = useRef(null);\n  // 定时发送音频的定时器引用\n  const intervalRef = useRef(null);\n\n  // 拖拽相关引用，仅用于麦克风按钮\n  const micButtonRef = useRef(null);\n  const isDraggingRef = useRef(false);\n  const offsetXRef = useRef(0);\n  const offsetYRef = useRef(0);\n\n  // localStorage 保存位置的 key\n  const storageKey = 'audioTranscriberMicButtonPosition';\n\n  /**\r\n   * 发送文本消息到 LLM 服务\r\n   * @param {string} text - 要发送的文本\r\n   */\n  const sendTextMessage = async text => {\n    if (!text.trim()) return;\n    try {\n      const response = await fetch('https://192.168.1.70:6010/qwener', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          text\n        })\n      });\n      if (!response.ok) {\n        throw new Error('网络响应失败，状态码: ' + response.status);\n      }\n      const data = await response.json();\n      console.log('文本发送成功，服务器返回：', data);\n    } catch (error) {\n      console.error('文本发送失败：', error);\n    }\n  };\n\n  // 组件卸载时清理资源\n  useEffect(() => {\n    return () => {\n      stopRecording();\n    };\n  }, []);\n\n  /**\r\n   * 启动录音并建立 WebSocket 连接\r\n   */\n  function startRecording() {\n    if (isRecording) return;\n\n    // 先请求麦克风权限\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }).then(() => {\n      // 根据语言和声纹识别参数拼接 WebSocket URL 查询参数\n      let params = [];\n      if (lang) params.push(`lang=${encodeURIComponent(lang)}`);\n      if (speakerVerification) params.push('sv=1'); // 声纹识别参数，勾选时添加\n      const queryStr = params.length > 0 ? `?${params.join('&')}` : '';\n\n      // 请根据实际服务器地址修改此处 ws 地址和端口\n      const wsUrl = `ws://192.168.168.77:6007/ws/transcribe${queryStr}`;\n      const ws = new WebSocket(wsUrl);\n      ws.binaryType = 'arraybuffer';\n      ws.onopen = () => {\n        console.log('WebSocket 已连接');\n\n        // 启动录音\n        recorder.start().catch(e => {\n          alert('启动录音失败: ' + e.message);\n          ws.close();\n        });\n\n        // 定时发送音频数据（每 500ms 发送一次）\n        intervalRef.current = setInterval(() => {\n          if (ws.readyState === 1) {\n            const audioBlob = recorder.getAudioBlob();\n            if (audioBlob.size > 0) {\n              console.log('发送音频数据，大小：', audioBlob.size);\n              ws.send(audioBlob);\n              recorder.clearBuffer();\n            }\n          }\n        }, 500);\n      };\n      ws.onmessage = evt => {\n        try {\n          const resJson = JSON.parse(evt.data);\n          if (resJson.code === 0) {\n            // 收到转写正确结果\n            const recognizedText = resJson.data || '无识别结果';\n\n            // 更新转写文本展示\n            setTranscription(prev => prev ? prev + '\\n' + recognizedText : recognizedText);\n\n            // 识别到有效文本时，发送给后端 LLM 服务\n            if (recognizedText && recognizedText.trim() && recognizedText !== '无识别结果') {\n              sendTextMessage(recognizedText);\n            }\n          } else {\n            // 其他情况输出原始数据\n            setTranscription(prev => prev ? prev + '\\n' + evt.data : evt.data);\n          }\n        } catch (e) {\n          console.error('解析转写消息失败', e);\n          setTranscription(prev => prev ? prev + '\\n' + evt.data : evt.data);\n        }\n      };\n      ws.onclose = () => {\n        console.log('WebSocket 已关闭');\n        stopRecording();\n      };\n      ws.onerror = e => {\n        console.error('WebSocket 错误', e);\n      };\n      wsRef.current = ws;\n      setIsRecording(true);\n    }).catch(error => {\n      alert('请求麦克风权限失败: ' + error.message);\n    });\n  }\n\n  /**\r\n   * 停止录音并关闭 WebSocket 连接\r\n   */\n  function stopRecording() {\n    if (!isRecording) return;\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n    recorder.stop();\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n    setIsRecording(false);\n  }\n\n  // 拖拽事件处理，仅麦克风按钮\n  useEffect(() => {\n    if (!micButtonRef.current) return;\n    const button = micButtonRef.current;\n\n    // 读取并恢复按钮位置\n    const savedPosStr = localStorage.getItem(storageKey);\n    let left = 26;\n    let top = 26;\n    if (savedPosStr) {\n      try {\n        const pos = JSON.parse(savedPosStr);\n        if (typeof pos.left === 'number' && typeof pos.top === 'number' && pos.left >= 0 && pos.top >= 0) {\n          left = pos.left;\n          top = pos.top;\n        }\n      } catch {\n        // 解析失败忽略，使用默认\n      }\n    }\n    button.style.position = 'fixed';\n    button.style.left = `${left}px`;\n    button.style.top = `${top}px`;\n    button.style.zIndex = '10000';\n    button.style.cursor = 'grab';\n\n    // 拖拽相关变量\n    isDraggingRef.current = false;\n    offsetXRef.current = 0;\n    offsetYRef.current = 0;\n    const onMouseDown = e => {\n      if (e.button !== 0) return; // 仅左键拖拽\n      isDraggingRef.current = true;\n      offsetXRef.current = e.clientX - button.offsetLeft;\n      offsetYRef.current = e.clientY - button.offsetTop;\n      button.style.cursor = 'grabbing';\n      e.preventDefault();\n    };\n    const onMouseMove = e => {\n      if (!isDraggingRef.current) return;\n      let newLeft = e.clientX - offsetXRef.current;\n      let newTop = e.clientY - offsetYRef.current;\n      const maxLeft = window.innerWidth - button.offsetWidth;\n      const maxTop = window.innerHeight - button.offsetHeight;\n      newLeft = Math.min(Math.max(0, newLeft), maxLeft);\n      newTop = Math.min(Math.max(0, newTop), maxTop);\n      button.style.left = `${newLeft}px`;\n      button.style.top = `${newTop}px`;\n    };\n    const onMouseUp = () => {\n      if (!isDraggingRef.current) return;\n      isDraggingRef.current = false;\n      button.style.cursor = 'grab';\n\n      // 保存位置\n      localStorage.setItem(storageKey, JSON.stringify({\n        left: button.offsetLeft,\n        top: button.offsetTop\n      }));\n    };\n    const onTouchStart = e => {\n      if (e.touches.length === 0) return;\n      isDraggingRef.current = true;\n      const touch = e.touches[0];\n      offsetXRef.current = touch.clientX - button.offsetLeft;\n      offsetYRef.current = touch.clientY - button.offsetTop;\n      button.style.cursor = 'grabbing';\n    };\n    const onTouchMove = e => {\n      if (!isDraggingRef.current || e.touches.length === 0) return;\n      const touch = e.touches[0];\n      let newLeft = touch.clientX - offsetXRef.current;\n      let newTop = touch.clientY - offsetYRef.current;\n      const maxLeft = window.innerWidth - button.offsetWidth;\n      const maxTop = window.innerHeight - button.offsetHeight;\n      newLeft = Math.min(Math.max(0, newLeft), maxLeft);\n      newTop = Math.min(Math.max(0, newTop), maxTop);\n      button.style.left = `${newLeft}px`;\n      button.style.top = `${newTop}px`;\n      e.preventDefault();\n    };\n    const onTouchEnd = () => {\n      if (!isDraggingRef.current) return;\n      isDraggingRef.current = false;\n      button.style.cursor = 'grab';\n\n      // 保存位置\n      localStorage.setItem(storageKey, JSON.stringify({\n        left: button.offsetLeft,\n        top: button.offsetTop\n      }));\n    };\n    button.addEventListener('mousedown', onMouseDown);\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    button.addEventListener('touchstart', onTouchStart, {\n      passive: false\n    });\n    document.addEventListener('touchmove', onTouchMove, {\n      passive: false\n    });\n    document.addEventListener('touchend', onTouchEnd);\n    return () => {\n      button.removeEventListener('mousedown', onMouseDown);\n      document.removeEventListener('mousemove', onMouseMove);\n      document.removeEventListener('mouseup', onMouseUp);\n      button.removeEventListener('touchstart', onTouchStart);\n      document.removeEventListener('touchmove', onTouchMove);\n      document.removeEventListener('touchend', onTouchEnd);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        /* 麦克风按钮样式 */\n        #mic-button-wrapper {\n          position: fixed;\n          z-index: 10000;\n          user-select: none;\n          pointer-events: auto;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          gap: 4px;\n          /* 位置由JS直接设置mic-button-wrapper定位 */\n        }\n\n        #listening-text {\n          font-size: 12px;\n          color: rgba(128, 128, 128, 0.7);\n          user-select: none;\n          pointer-events: none;\n          font-weight: 500;\n          opacity: 0;\n          transition: opacity 0.3s ease;\n          height: 16px;\n          line-height: 16px;\n        }\n        #listening-text.visible {\n          opacity: 1;\n        }\n\n        #mic-button {\n          background: none;\n          border: none;\n          padding: 0;\n          outline: none;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          filter: none;\n          transition: filter 0.3s ease;\n\n          width: 68px;\n          height: 68px;\n          cursor: grab;\n          /* 不再设置fixed定位，由wrapper定位 */\n        }\n        #mic-button.recording {\n          filter: drop-shadow(0 0 5px red);\n        }\n        #mic-button img {\n          width: 48px;\n          height: 48px;\n          user-select: none;\n          pointer-events: none;\n          -webkit-user-drag: none;\n        }\n\n        /* 语言和声纹识别区域样式 */\n        #controls-container {\n          max-width: 700px;\n          margin: 20px auto 12px auto;\n          font-family: Arial, sans-serif;\n          color: white;\n          display: flex;\n          align-items: center;\n          gap: 20px;\n          user-select: none;\n        }\n        #controls-container label {\n          font-size: 14px;\n          user-select: none;\n        }\n        #langInput {\n          padding: 4px;\n          font-size: 14px;\n          width: 120px;\n          background-color: #333;\n          border: 1px solid #666;\n          border-radius: 3px;\n          color: white;\n          user-select: text;\n        }\n        #speakerVerificationLabel {\n          display: flex;\n          align-items: center;\n          font-size: 14px;\n          user-select: none;\n        }\n        #speakerVerificationLabel input {\n          margin-right: 6px;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"mic-button-wrapper\",\n      ref: micButtonRef,\n      style: {\n        left: 26,\n        top: 26,\n        position: 'fixed'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"listening-text\",\n        className: isRecording ? 'visible' : '',\n        \"aria-live\": \"polite\",\n        role: \"status\",\n        children: \"\\u8046\\u542C\\u4E2D...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        id: \"mic-button\",\n        className: isRecording ? 'recording' : '',\n        onClick: () => isRecording ? stopRecording() : startRecording(),\n        \"aria-label\": isRecording ? '停止录音' : '开始录音',\n        title: isRecording ? '点击停止录音' : '点击开始录音',\n        type: \"button\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/core/client/ai-butler/image/mic-icon.png\",\n          alt: \"\\u9EA6\\u514B\\u98CE\",\n          draggable: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"controls-container\",\n      \"aria-label\": \"\\u8BED\\u97F3\\u8BC6\\u522B\\u8BBE\\u7F6E\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"langInput\",\n        children: \"\\u8BED\\u8A00\\uFF1A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"langInput\",\n        type: \"text\",\n        value: lang,\n        onChange: e => setLang(e.target.value),\n        disabled: isRecording,\n        placeholder: \"auto\",\n        autoComplete: \"off\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        id: \"speakerVerificationLabel\",\n        htmlFor: \"speakerVerificationCheckbox\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"speakerVerificationCheckbox\",\n          type: \"checkbox\",\n          checked: speakerVerification,\n          disabled: isRecording,\n          onChange: e => setSpeakerVerification(e.target.checked)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 11\n        }, this), \"\\u58F0\\u7EB9\\u8BC6\\u522B\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"transcriptionResult\",\n      style: {\n        maxWidth: 700,\n        margin: '12px auto 20px auto',\n        fontFamily: 'Arial, sans-serif',\n        whiteSpace: 'pre-wrap',\n        backgroundColor: 'transparent',\n        padding: 10,\n        border: '1px solid transparent',\n        borderRadius: 5,\n        minHeight: 150,\n        fontFamily: 'monospace',\n        fontSize: 14,\n        overflowY: 'auto',\n        maxHeight: 300,\n        userSelect: 'text',\n        color: transcription ? 'white' : 'rgba(255, 255, 255, 0.5)'\n      },\n      children: transcription || '识别文字展示区...'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(AudioTranscriber, \"vXmrLAmJ9CuU6njQq3UgGkuepiM=\", false, function () {\n  return [useRecorder];\n});\n_c = AudioTranscriber;\nvar _c;\n$RefreshReg$(_c, \"AudioTranscriber\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useRecorder","jsxDEV","_jsxDEV","Fragment","_Fragment","AudioTranscriber","_s","isRecording","setIsRecording","transcription","setTranscription","lang","setLang","speakerVerification","setSpeakerVerification","recorder","wsRef","intervalRef","micButtonRef","isDraggingRef","offsetXRef","offsetYRef","storageKey","sendTextMessage","text","trim","response","fetch","method","headers","body","JSON","stringify","ok","Error","status","data","json","console","log","error","stopRecording","startRecording","navigator","mediaDevices","getUserMedia","audio","then","params","push","encodeURIComponent","queryStr","length","join","wsUrl","ws","WebSocket","binaryType","onopen","start","catch","e","alert","message","close","current","setInterval","readyState","audioBlob","getAudioBlob","size","send","clearBuffer","onmessage","evt","resJson","parse","code","recognizedText","prev","onclose","onerror","stop","clearInterval","button","savedPosStr","localStorage","getItem","left","top","pos","style","position","zIndex","cursor","onMouseDown","clientX","offsetLeft","clientY","offsetTop","preventDefault","onMouseMove","newLeft","newTop","maxLeft","window","innerWidth","offsetWidth","maxTop","innerHeight","offsetHeight","Math","min","max","onMouseUp","setItem","onTouchStart","touches","touch","onTouchMove","onTouchEnd","addEventListener","document","passive","removeEventListener","children","fileName","_jsxFileName","lineNumber","columnNumber","id","ref","className","role","onClick","title","type","src","alt","draggable","htmlFor","value","onChange","target","disabled","placeholder","autoComplete","checked","maxWidth","margin","fontFamily","whiteSpace","backgroundColor","padding","border","borderRadius","minHeight","fontSize","overflowY","maxHeight","userSelect","color","_c","$RefreshReg$"],"sources":["D:/XM/AI-Sphere-Butler/core/client/src/components/AudioTranscriber.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useRecorder } from '../hooks/useRecorder';\r\n\r\nexport default function AudioTranscriber() {\r\n  // 录音状态\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  // 转写文本内容\r\n  const [transcription, setTranscription] = useState('');\r\n  // 语言参数，默认 auto\r\n  const [lang, setLang] = useState('auto');\r\n  // 是否开启声纹识别\r\n  const [speakerVerification, setSpeakerVerification] = useState(false);\r\n\r\n  // 自定义录音 Hook，管理录音功能\r\n  const recorder = useRecorder();\r\n\r\n  // WebSocket 实例引用\r\n  const wsRef = useRef(null);\r\n  // 定时发送音频的定时器引用\r\n  const intervalRef = useRef(null);\r\n\r\n  // 拖拽相关引用，仅用于麦克风按钮\r\n  const micButtonRef = useRef(null);\r\n  const isDraggingRef = useRef(false);\r\n  const offsetXRef = useRef(0);\r\n  const offsetYRef = useRef(0);\r\n\r\n  // localStorage 保存位置的 key\r\n  const storageKey = 'audioTranscriberMicButtonPosition';\r\n\r\n  /**\r\n   * 发送文本消息到 LLM 服务\r\n   * @param {string} text - 要发送的文本\r\n   */\r\n  const sendTextMessage = async (text) => {\r\n    if (!text.trim()) return;\r\n\r\n    try {\r\n      const response = await fetch('https://192.168.1.70:6010/qwener', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ text }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('网络响应失败，状态码: ' + response.status);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('文本发送成功，服务器返回：', data);\r\n    } catch (error) {\r\n      console.error('文本发送失败：', error);\r\n    }\r\n  };\r\n\r\n  // 组件卸载时清理资源\r\n  useEffect(() => {\r\n    return () => {\r\n      stopRecording();\r\n    };\r\n  }, []);\r\n\r\n  /**\r\n   * 启动录音并建立 WebSocket 连接\r\n   */\r\n  function startRecording() {\r\n    if (isRecording) return;\r\n\r\n    // 先请求麦克风权限\r\n    navigator.mediaDevices.getUserMedia({ audio: true })\r\n      .then(() => {\r\n        // 根据语言和声纹识别参数拼接 WebSocket URL 查询参数\r\n        let params = [];\r\n        if (lang) params.push(`lang=${encodeURIComponent(lang)}`);\r\n        if (speakerVerification) params.push('sv=1'); // 声纹识别参数，勾选时添加\r\n        const queryStr = params.length > 0 ? `?${params.join('&')}` : '';\r\n\r\n        // 请根据实际服务器地址修改此处 ws 地址和端口\r\n        const wsUrl = `ws://192.168.168.77:6007/ws/transcribe${queryStr}`;\r\n        const ws = new WebSocket(wsUrl);\r\n        ws.binaryType = 'arraybuffer';\r\n\r\n        ws.onopen = () => {\r\n          console.log('WebSocket 已连接');\r\n\r\n          // 启动录音\r\n          recorder.start().catch((e) => {\r\n            alert('启动录音失败: ' + e.message);\r\n            ws.close();\r\n          });\r\n\r\n          // 定时发送音频数据（每 500ms 发送一次）\r\n          intervalRef.current = setInterval(() => {\r\n            if (ws.readyState === 1) {\r\n              const audioBlob = recorder.getAudioBlob();\r\n              if (audioBlob.size > 0) {\r\n                console.log('发送音频数据，大小：', audioBlob.size);\r\n                ws.send(audioBlob);\r\n                recorder.clearBuffer();\r\n              }\r\n            }\r\n          }, 500);\r\n        };\r\n\r\n        ws.onmessage = (evt) => {\r\n          try {\r\n            const resJson = JSON.parse(evt.data);\r\n            if (resJson.code === 0) {\r\n              // 收到转写正确结果\r\n              const recognizedText = resJson.data || '无识别结果';\r\n\r\n              // 更新转写文本展示\r\n              setTranscription((prev) => (prev ? prev + '\\n' + recognizedText : recognizedText));\r\n\r\n              // 识别到有效文本时，发送给后端 LLM 服务\r\n              if (recognizedText && recognizedText.trim() && recognizedText !== '无识别结果') {\r\n                sendTextMessage(recognizedText);\r\n              }\r\n            } else {\r\n              // 其他情况输出原始数据\r\n              setTranscription((prev) => (prev ? prev + '\\n' + evt.data : evt.data));\r\n            }\r\n          } catch (e) {\r\n            console.error('解析转写消息失败', e);\r\n            setTranscription((prev) => (prev ? prev + '\\n' + evt.data : evt.data));\r\n          }\r\n        };\r\n\r\n        ws.onclose = () => {\r\n          console.log('WebSocket 已关闭');\r\n          stopRecording();\r\n        };\r\n\r\n        ws.onerror = (e) => {\r\n          console.error('WebSocket 错误', e);\r\n        };\r\n\r\n        wsRef.current = ws;\r\n        setIsRecording(true);\r\n      })\r\n      .catch((error) => {\r\n        alert('请求麦克风权限失败: ' + error.message);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * 停止录音并关闭 WebSocket 连接\r\n   */\r\n  function stopRecording() {\r\n    if (!isRecording) return;\r\n\r\n    if (wsRef.current) {\r\n      wsRef.current.close();\r\n      wsRef.current = null;\r\n    }\r\n    recorder.stop();\r\n\r\n    if (intervalRef.current) {\r\n      clearInterval(intervalRef.current);\r\n      intervalRef.current = null;\r\n    }\r\n\r\n    setIsRecording(false);\r\n  }\r\n\r\n  // 拖拽事件处理，仅麦克风按钮\r\n  useEffect(() => {\r\n    if (!micButtonRef.current) return;\r\n    const button = micButtonRef.current;\r\n\r\n    // 读取并恢复按钮位置\r\n    const savedPosStr = localStorage.getItem(storageKey);\r\n    let left = 26;\r\n    let top = 26;\r\n    if (savedPosStr) {\r\n      try {\r\n        const pos = JSON.parse(savedPosStr);\r\n        if (\r\n          typeof pos.left === 'number' &&\r\n          typeof pos.top === 'number' &&\r\n          pos.left >= 0 &&\r\n          pos.top >= 0\r\n        ) {\r\n          left = pos.left;\r\n          top = pos.top;\r\n        }\r\n      } catch {\r\n        // 解析失败忽略，使用默认\r\n      }\r\n    }\r\n\r\n    button.style.position = 'fixed';\r\n    button.style.left = `${left}px`;\r\n    button.style.top = `${top}px`;\r\n    button.style.zIndex = '10000';\r\n    button.style.cursor = 'grab';\r\n\r\n    // 拖拽相关变量\r\n    isDraggingRef.current = false;\r\n    offsetXRef.current = 0;\r\n    offsetYRef.current = 0;\r\n\r\n    const onMouseDown = (e) => {\r\n      if (e.button !== 0) return; // 仅左键拖拽\r\n      isDraggingRef.current = true;\r\n      offsetXRef.current = e.clientX - button.offsetLeft;\r\n      offsetYRef.current = e.clientY - button.offsetTop;\r\n      button.style.cursor = 'grabbing';\r\n      e.preventDefault();\r\n    };\r\n    const onMouseMove = (e) => {\r\n      if (!isDraggingRef.current) return;\r\n      let newLeft = e.clientX - offsetXRef.current;\r\n      let newTop = e.clientY - offsetYRef.current;\r\n\r\n      const maxLeft = window.innerWidth - button.offsetWidth;\r\n      const maxTop = window.innerHeight - button.offsetHeight;\r\n      newLeft = Math.min(Math.max(0, newLeft), maxLeft);\r\n      newTop = Math.min(Math.max(0, newTop), maxTop);\r\n\r\n      button.style.left = `${newLeft}px`;\r\n      button.style.top = `${newTop}px`;\r\n    };\r\n    const onMouseUp = () => {\r\n      if (!isDraggingRef.current) return;\r\n      isDraggingRef.current = false;\r\n      button.style.cursor = 'grab';\r\n\r\n      // 保存位置\r\n      localStorage.setItem(\r\n        storageKey,\r\n        JSON.stringify({ left: button.offsetLeft, top: button.offsetTop })\r\n      );\r\n    };\r\n\r\n    const onTouchStart = (e) => {\r\n      if (e.touches.length === 0) return;\r\n      isDraggingRef.current = true;\r\n      const touch = e.touches[0];\r\n      offsetXRef.current = touch.clientX - button.offsetLeft;\r\n      offsetYRef.current = touch.clientY - button.offsetTop;\r\n      button.style.cursor = 'grabbing';\r\n    };\r\n    const onTouchMove = (e) => {\r\n      if (!isDraggingRef.current || e.touches.length === 0) return;\r\n      const touch = e.touches[0];\r\n      let newLeft = touch.clientX - offsetXRef.current;\r\n      let newTop = touch.clientY - offsetYRef.current;\r\n\r\n      const maxLeft = window.innerWidth - button.offsetWidth;\r\n      const maxTop = window.innerHeight - button.offsetHeight;\r\n      newLeft = Math.min(Math.max(0, newLeft), maxLeft);\r\n      newTop = Math.min(Math.max(0, newTop), maxTop);\r\n\r\n      button.style.left = `${newLeft}px`;\r\n      button.style.top = `${newTop}px`;\r\n\r\n      e.preventDefault();\r\n    };\r\n    const onTouchEnd = () => {\r\n      if (!isDraggingRef.current) return;\r\n      isDraggingRef.current = false;\r\n      button.style.cursor = 'grab';\r\n\r\n      // 保存位置\r\n      localStorage.setItem(\r\n        storageKey,\r\n        JSON.stringify({ left: button.offsetLeft, top: button.offsetTop })\r\n      );\r\n    };\r\n\r\n    button.addEventListener('mousedown', onMouseDown);\r\n    document.addEventListener('mousemove', onMouseMove);\r\n    document.addEventListener('mouseup', onMouseUp);\r\n\r\n    button.addEventListener('touchstart', onTouchStart, { passive: false });\r\n    document.addEventListener('touchmove', onTouchMove, { passive: false });\r\n    document.addEventListener('touchend', onTouchEnd);\r\n\r\n    return () => {\r\n      button.removeEventListener('mousedown', onMouseDown);\r\n      document.removeEventListener('mousemove', onMouseMove);\r\n      document.removeEventListener('mouseup', onMouseUp);\r\n\r\n      button.removeEventListener('touchstart', onTouchStart);\r\n      document.removeEventListener('touchmove', onTouchMove);\r\n      document.removeEventListener('touchend', onTouchEnd);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <style>{`\r\n        /* 麦克风按钮样式 */\r\n        #mic-button-wrapper {\r\n          position: fixed;\r\n          z-index: 10000;\r\n          user-select: none;\r\n          pointer-events: auto;\r\n          display: flex;\r\n          flex-direction: column;\r\n          align-items: center;\r\n          gap: 4px;\r\n          /* 位置由JS直接设置mic-button-wrapper定位 */\r\n        }\r\n\r\n        #listening-text {\r\n          font-size: 12px;\r\n          color: rgba(128, 128, 128, 0.7);\r\n          user-select: none;\r\n          pointer-events: none;\r\n          font-weight: 500;\r\n          opacity: 0;\r\n          transition: opacity 0.3s ease;\r\n          height: 16px;\r\n          line-height: 16px;\r\n        }\r\n        #listening-text.visible {\r\n          opacity: 1;\r\n        }\r\n\r\n        #mic-button {\r\n          background: none;\r\n          border: none;\r\n          padding: 0;\r\n          outline: none;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          filter: none;\r\n          transition: filter 0.3s ease;\r\n\r\n          width: 68px;\r\n          height: 68px;\r\n          cursor: grab;\r\n          /* 不再设置fixed定位，由wrapper定位 */\r\n        }\r\n        #mic-button.recording {\r\n          filter: drop-shadow(0 0 5px red);\r\n        }\r\n        #mic-button img {\r\n          width: 48px;\r\n          height: 48px;\r\n          user-select: none;\r\n          pointer-events: none;\r\n          -webkit-user-drag: none;\r\n        }\r\n\r\n        /* 语言和声纹识别区域样式 */\r\n        #controls-container {\r\n          max-width: 700px;\r\n          margin: 20px auto 12px auto;\r\n          font-family: Arial, sans-serif;\r\n          color: white;\r\n          display: flex;\r\n          align-items: center;\r\n          gap: 20px;\r\n          user-select: none;\r\n        }\r\n        #controls-container label {\r\n          font-size: 14px;\r\n          user-select: none;\r\n        }\r\n        #langInput {\r\n          padding: 4px;\r\n          font-size: 14px;\r\n          width: 120px;\r\n          background-color: #333;\r\n          border: 1px solid #666;\r\n          border-radius: 3px;\r\n          color: white;\r\n          user-select: text;\r\n        }\r\n        #speakerVerificationLabel {\r\n          display: flex;\r\n          align-items: center;\r\n          font-size: 14px;\r\n          user-select: none;\r\n        }\r\n        #speakerVerificationLabel input {\r\n          margin-right: 6px;\r\n        }\r\n      `}</style>\r\n\r\n      {/* 麦克风及“聆听中”容器，控制整体定位、拖拽 */}\r\n      <div\r\n        id=\"mic-button-wrapper\"\r\n        ref={micButtonRef}\r\n        style={{ left: 26, top: 26, position: 'fixed' }}\r\n      >\r\n        {/* 聆听中提示 */}\r\n        <div id=\"listening-text\" className={isRecording ? 'visible' : ''} aria-live=\"polite\" role=\"status\">\r\n          聆听中...\r\n        </div>\r\n\r\n        {/* 麦克风按钮 */}\r\n        <button\r\n          id=\"mic-button\"\r\n          className={isRecording ? 'recording' : ''}\r\n          onClick={() => (isRecording ? stopRecording() : startRecording())}\r\n          aria-label={isRecording ? '停止录音' : '开始录音'}\r\n          title={isRecording ? '点击停止录音' : '点击开始录音'}\r\n          type=\"button\"\r\n        >\r\n          <img\r\n            src=\"/core/client/ai-butler/image/mic-icon.png\"\r\n            alt=\"麦克风\"\r\n            draggable={false}\r\n          />\r\n        </button>\r\n      </div>\r\n\r\n      {/* 语言和声纹识别控制 */}\r\n      <div id=\"controls-container\" aria-label=\"语音识别设置\">\r\n        <label htmlFor=\"langInput\">语言：</label>\r\n        <input\r\n          id=\"langInput\"\r\n          type=\"text\"\r\n          value={lang}\r\n          onChange={(e) => setLang(e.target.value)}\r\n          disabled={isRecording}\r\n          placeholder=\"auto\"\r\n          autoComplete=\"off\"\r\n        />\r\n\r\n        <label id=\"speakerVerificationLabel\" htmlFor=\"speakerVerificationCheckbox\">\r\n          <input\r\n            id=\"speakerVerificationCheckbox\"\r\n            type=\"checkbox\"\r\n            checked={speakerVerification}\r\n            disabled={isRecording}\r\n            onChange={(e) => setSpeakerVerification(e.target.checked)}\r\n          />\r\n          声纹识别\r\n        </label>\r\n      </div>\r\n\r\n      {/* 转写结果展示 */}\r\n      <div\r\n        id=\"transcriptionResult\"\r\n        style={{\r\n          maxWidth: 700,\r\n          margin: '12px auto 20px auto',\r\n          fontFamily: 'Arial, sans-serif',\r\n          whiteSpace: 'pre-wrap',\r\n          backgroundColor: 'transparent',\r\n          padding: 10,\r\n          border: '1px solid transparent',\r\n          borderRadius: 5,\r\n          minHeight: 150,\r\n          fontFamily: 'monospace',\r\n          fontSize: 14,\r\n          overflowY: 'auto',\r\n          maxHeight: 300,\r\n          userSelect: 'text',\r\n          color: transcription ? 'white' : 'rgba(255, 255, 255, 0.5)',\r\n        }}\r\n      >\r\n        {transcription || '识别文字展示区...'}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}