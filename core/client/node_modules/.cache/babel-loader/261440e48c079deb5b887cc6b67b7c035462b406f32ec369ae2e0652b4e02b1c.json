{"ast":null,"code":"var _jsxFileName = \"D:\\\\XM\\\\AI-Sphere-Butler\\\\core\\\\client\\\\src\\\\components\\\\OldWebRTC.jsx\",\n  _s = $RefreshSig$();\n// src/components/OldWebRTC.jsx\nimport React, { useEffect, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function OldWebRTC({\n  renderVideo = true,\n  keepConnection = false\n}) {\n  _s();\n  const videoRef = useRef(null);\n  const audioRef = useRef(null);\n  const pcRef = useRef(null);\n  const textareaRef = useRef(null);\n  const canvasRef = useRef(null); // 用于抠图的画布\n  const pipRef = useRef(false); // 画中画状态\n\n  const containerRef = useRef(null);\n  const [useStun, setUseStun] = useState(false);\n  const [started, setStarted] = useState(false);\n  const [zoomWidth, setZoomWidth] = useState(600);\n  const [videoLoaded, setVideoLoaded] = useState(false); // 新增：视频加载状态\n  const [debugLogs, setDebugLogs] = useState([]); // 新增：调试日志\n\n  // 视频初始宽高\n  const initialWidth = 600;\n  const initialHeight = 450;\n\n  // 信令服务器地址\n  const SIGNALING_URL = '/offer';\n\n  // 视频缩放比例\n  const zoomStep = 50;\n\n  // 聊天框位置状态\n  const [chatPos, setChatPos] = useState(() => {\n    try {\n      const saved = localStorage.getItem('chatbox-position');\n      if (saved) {\n        const pos = JSON.parse(saved);\n        return pos;\n      }\n    } catch {}\n    return {\n      left: 20,\n      top: 20\n    };\n  });\n\n  // 绿幕抠图颜色阈值（放宽范围，避免误判）\n  const [greenThreshold, setGreenThreshold] = useState({\n    r: 80,\n    // 红色上限（放宽）\n    g: 150,\n    // 绿色下限（降低）\n    b: 80 // 蓝色上限（放宽）\n  });\n\n  // 拖拽相关状态\n  const draggingRef = useRef(false);\n  const dragOffsetRef = useRef({\n    x: 0,\n    y: 0\n  });\n\n  // 拖拽事件处理\n  function onDragStart(e) {\n    if (e.target.tagName.toLowerCase() === 'textarea') {\n      draggingRef.current = false;\n      return;\n    }\n    draggingRef.current = true;\n    const targetRect = e.currentTarget.getBoundingClientRect();\n    if (e.type === 'touchstart' && e.touches && e.touches[0]) {\n      dragOffsetRef.current = {\n        x: e.touches[0].clientX - targetRect.left,\n        y: e.touches[0].clientY - targetRect.top\n      };\n    } else {\n      dragOffsetRef.current = {\n        x: e.clientX - targetRect.left,\n        y: e.clientY - targetRect.top\n      };\n    }\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  function onDragMove(e) {\n    if (!draggingRef.current) return;\n    let clientX, clientY;\n    if (e.type === 'touchmove' && e.touches && e.touches[0]) {\n      clientX = e.touches[0].clientX;\n      clientY = e.touches[0].clientY;\n    } else if (e.type === 'mousemove') {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    } else {\n      return;\n    }\n    if (!containerRef.current || !e.currentTarget) return;\n    const containerRect = containerRef.current.getBoundingClientRect();\n    const chatRect = e.currentTarget.getBoundingClientRect();\n    const chatWidth = chatRect.width;\n    const chatHeight = chatRect.height;\n    let newLeft = clientX - containerRect.left - dragOffsetRef.current.x;\n    let newTop = clientY - containerRect.top - dragOffsetRef.current.y;\n    newLeft = Math.min(Math.max(0, newLeft), containerRect.width - chatWidth);\n    newTop = Math.min(Math.max(0, newTop), containerRect.height - chatHeight);\n    setChatPos({\n      left: newLeft,\n      top: newTop\n    });\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  function onDragEnd(e) {\n    if (draggingRef.current) {\n      draggingRef.current = false;\n      localStorage.setItem('chatbox-position', JSON.stringify(chatPos));\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  // 新增：调试日志记录\n  const logDebug = message => {\n    setDebugLogs(prev => {\n      const newLogs = [...prev, `[${new Date().toLocaleTimeString()}] ${message}`];\n      return newLogs.slice(-10); // 只保留最近10条\n    });\n    console.log('[WebRTC Debug]', message);\n  };\n\n  // 视频帧处理函数（带调试）\n  const processVideoFrame = useRef(() => {});\n\n  // WebRTC协商\n  async function negotiate() {\n    const pc = pcRef.current;\n    if (!pc) return;\n    pc.addTransceiver('video', {\n      direction: 'recvonly'\n    });\n    pc.addTransceiver('audio', {\n      direction: 'recvonly'\n    });\n    try {\n      const offer = await pc.createOffer();\n      await pc.setLocalDescription(offer);\n      await new Promise(resolve => {\n        if (pc.iceGatheringState === 'complete') {\n          resolve();\n        } else {\n          const checkState = () => {\n            if (pc.iceGatheringState === 'complete') {\n              pc.removeEventListener('icegatheringstatechange', checkState);\n              resolve();\n            }\n          };\n          pc.addEventListener('icegatheringstatechange', checkState);\n        }\n      });\n      const response = await fetch(SIGNALING_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          sdp: pc.localDescription.sdp,\n          type: pc.localDescription.type\n        })\n      });\n      const answer = await response.json();\n      await pc.setRemoteDescription(answer);\n      logDebug('WebRTC协商完成');\n    } catch (e) {\n      logDebug('协商失败: ' + e.message);\n      alert('协商失败: ' + e.message);\n    }\n  }\n  function start() {\n    if (started) return;\n    const config = {\n      sdpSemantics: 'unified-plan'\n    };\n    const pc = new RTCPeerConnection(config);\n    pcRef.current = pc;\n\n    // 监听轨道事件（带调试）\n    pc.addEventListener('track', evt => {\n      logDebug(`收到${evt.track.kind}轨道`);\n      if (evt.track.kind === 'video') {\n        if (videoRef.current) {\n          videoRef.current.srcObject = evt.streams[0];\n          logDebug('视频轨道已绑定到video元素');\n        }\n      } else if (evt.track.kind === 'audio') {\n        if (audioRef.current) {\n          audioRef.current.srcObject = evt.streams[0];\n          logDebug('音频轨道已绑定到audio元素');\n        }\n      }\n    });\n\n    // 监听ICE连接状态\n    pc.addEventListener('iceconnectionstatechange', () => {\n      logDebug('ICE连接状态: ' + pc.iceConnectionState);\n      if (pc.iceConnectionState === 'failed') {\n        alert('ICE连接失败，请重试');\n      }\n    });\n    setStarted(true);\n    negotiate();\n    setZoomWidth(initialWidth);\n  }\n  function stop() {\n    if (!started) return;\n    setStarted(false);\n    if (document.pictureInPictureElement) {\n      document.exitPictureInPicture();\n      pipRef.current = false;\n    }\n    if (!keepConnection) {\n      setTimeout(() => {\n        if (pcRef.current) {\n          pcRef.current.close();\n          pcRef.current = null;\n          logDebug('关闭WebRTC连接');\n        }\n      }, 500);\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(t => t.stop());\n        videoRef.current.srcObject = null;\n      }\n      if (audioRef.current && audioRef.current.srcObject) {\n        audioRef.current.srcObject.getTracks().forEach(t => t.stop());\n        audioRef.current.srcObject = null;\n      }\n    }\n    setVideoLoaded(false);\n  }\n\n  // 缩放功能\n  function zoomIn() {\n    setZoomWidth(w => w + zoomStep);\n  }\n  function zoomOut() {\n    setZoomWidth(w => w - zoomStep > 0 ? w - zoomStep : w);\n  }\n\n  // 消息发送功能（保留原有）\n  const sendTextMessage = async () => {\n    if (!message.trim()) return;\n    try {\n      const response = await fetch('https://192.168.168.77:6010/qwener', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          text: message\n        })\n      });\n      if (!response.ok) throw new Error('状态码: ' + response.status);\n      logDebug('文本发送成功');\n    } catch (error) {\n      logDebug('文本发送失败：' + error.message);\n    }\n  };\n  const sendMultiModal = async () => {\n    if (!imageFile) return;\n    try {\n      const reader = new FileReader();\n      reader.onloadend = async () => {\n        const response = await fetch('https://192.168.1.70:6010/multimodal', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            text: message.trim(),\n            image: reader.result\n          })\n        });\n        if (!response.ok) throw new Error('状态码: ' + response.status);\n        logDebug('多模态发送成功');\n        setImageFile(null);\n        setMessage('');\n      };\n      reader.readAsDataURL(imageFile);\n    } catch (error) {\n      logDebug('多模态发送失败：' + error.message);\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (imageFile) {\n      await sendMultiModal();\n    } else {\n      await sendTextMessage();\n      setMessage('');\n    }\n  };\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n    setImageFile(file || null);\n  };\n\n  // 画中画功能\n  const togglePictureInPicture = async () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    try {\n      if (document.pictureInPictureElement) {\n        await document.exitPictureInPicture();\n        pipRef.current = false;\n        logDebug('退出画中画');\n      } else if (document.pictureInPictureEnabled) {\n        await canvas.requestPictureInPicture();\n        pipRef.current = true;\n        logDebug('进入画中画');\n      }\n    } catch (error) {\n      logDebug('画中画错误: ' + error.message);\n      alert('画中画功能无法使用: ' + error.message);\n    }\n  };\n\n  // 打断功能\n  const handleInterruptClick = async () => {\n    try {\n      const resp = await fetch('http://192.168.168.77:6010/api/interrupt_speaking', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (!resp.ok) throw new Error('状态码: ' + resp.status);\n      logDebug('打断请求发送成功');\n    } catch (e) {\n      logDebug('打断接口异常: ' + e.message);\n    }\n  };\n\n  // 核心：视频加载与Canvas初始化（带调试）\n  useEffect(() => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    if (!video || !canvas) return;\n\n    // 视频加载完成后初始化Canvas\n    const handleVideoLoaded = () => {\n      setVideoLoaded(true);\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      logDebug(`视频加载完成 (${canvas.width}x${canvas.height})`);\n\n      // 初始化帧处理函数\n      const ctx = canvas.getContext('2d', {\n        willReadFrequently: true\n      });\n      processVideoFrame.current = () => {\n        if (!started || !videoLoaded) return;\n        try {\n          // 绘制原始视频帧（先确保能显示画面）\n          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n          // 绿幕抠图逻辑（可临时注释测试）\n          const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n          const data = imageData.data;\n          for (let i = 0; i < data.length; i += 4) {\n            const r = data[i];\n            const g = data[i + 1];\n            const b = data[i + 2];\n\n            // 绿幕判断（放宽条件，避免误判）\n            if (r < greenThreshold.r && g > greenThreshold.g && b < greenThreshold.b) {\n              data[i + 3] = 0; // 透明\n            }\n          }\n          ctx.putImageData(imageData, 0, 0);\n          logDebug('帧处理完成（每50帧打印一次）', Math.random() > 0.98); // 减少日志频率\n        } catch (error) {\n          logDebug('帧处理错误: ' + error.message);\n        }\n        requestAnimationFrame(processVideoFrame.current);\n      };\n\n      // 开始处理帧\n      if (started) {\n        processVideoFrame.current();\n      }\n    };\n\n    // 监听视频加载事件\n    video.addEventListener('loadedmetadata', handleVideoLoaded);\n    // 监听视频播放事件\n    video.addEventListener('play', () => {\n      logDebug('视频开始播放');\n      if (started && videoLoaded) {\n        processVideoFrame.current();\n      }\n    });\n\n    // 清理函数\n    return () => {\n      video.removeEventListener('loadedmetadata', handleVideoLoaded);\n      video.removeEventListener('play', () => {});\n    };\n  }, [started, videoLoaded, greenThreshold]);\n\n  // 状态变化时重启帧处理\n  useEffect(() => {\n    if (started && videoLoaded && canvasRef.current) {\n      logDebug('开始处理视频帧');\n      processVideoFrame.current();\n    }\n  }, [started, videoLoaded]);\n\n  // 通用样式（保留原有）\n  const frostedGlassBtnStyle = {\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\n    border: '1px solid rgba(255, 255, 255, 0.3)',\n    color: 'white',\n    fontWeight: 'bold',\n    padding: '8px 16px',\n    cursor: 'pointer',\n    borderRadius: 4,\n    outline: 'none',\n    transition: 'all 0.3s',\n    fontSize: 14,\n    backdropFilter: 'blur(10px)',\n    WebkitBackdropFilter: 'blur(10px)',\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)'\n  };\n  const disabledBtnStyle = {\n    ...frostedGlassBtnStyle,\n    opacity: 0.4,\n    cursor: 'not-allowed',\n    boxShadow: 'none'\n  };\n  const getBtnHoverStyle = disabled => !disabled && {\n    backgroundColor: 'rgba(255, 255, 255, 0.2)',\n    boxShadow: '0 6px 20px rgba(255, 255, 255, 0.3)',\n    transform: 'scale(1.05)'\n  };\n\n  // 按钮hover状态\n  const [startBtnHover, setStartBtnHover] = useState(false);\n  const [stopBtnHover, setStopBtnHover] = useState(false);\n  const [zoomInHover, setZoomInHover] = useState(false);\n  const [zoomOutHover, setZoomOutHover] = useState(false);\n  const [interruptBtnHover, setInterruptBtnHover] = useState(false);\n  const [pipBtnHover, setPipBtnHover] = useState(false);\n\n  // 消息和图片状态\n  const [message, setMessage] = useState('');\n  const [imageFile, setImageFile] = useState(null);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    style: {\n      maxWidth: 1280,\n      position: 'relative',\n      minHeight: '100vh'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        bottom: 10,\n        right: 10,\n        backgroundColor: 'rgba(0,0,0,0.7)',\n        color: 'white',\n        padding: 8,\n        borderRadius: 4,\n        maxWidth: 300,\n        maxHeight: 150,\n        overflowY: 'auto',\n        fontSize: 12,\n        zIndex: 99999\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 'bold',\n          marginBottom: 4\n        },\n        children: \"\\u8C03\\u8BD5\\u65E5\\u5FD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 9\n      }, this), debugLogs.map((log, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: 2\n        },\n        children: log\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"option\",\n      style: {\n        marginBottom: 8\n      },\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"use-stun\",\n        type: \"checkbox\",\n        checked: useStun,\n        onChange: e => setUseStun(e.target.checked),\n        style: {\n          accentColor: 'white',\n          hidden: true\n        },\n        disabled: started\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: zoomIn,\n        style: {\n          ...frostedGlassBtnStyle,\n          marginRight: 8,\n          ...(zoomInHover ? getBtnHoverStyle(false) : {})\n        },\n        onMouseEnter: () => setZoomInHover(true),\n        onMouseLeave: () => setZoomInHover(false),\n        children: \"\\u653E\\u5927\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: zoomOut,\n        style: {\n          ...frostedGlassBtnStyle,\n          marginRight: 8,\n          ...(zoomOutHover ? getBtnHoverStyle(false) : {})\n        },\n        onMouseEnter: () => setZoomOutHover(true),\n        onMouseLeave: () => setZoomOutHover(false),\n        children: \"\\u7F29\\u5C0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: togglePictureInPicture,\n        disabled: !started,\n        style: {\n          ...(started ? frostedGlassBtnStyle : disabledBtnStyle),\n          marginRight: 8,\n          ...(pipBtnHover && started ? getBtnHoverStyle(false) : {})\n        },\n        onMouseEnter: () => setPipBtnHover(true),\n        onMouseLeave: () => setPipBtnHover(false),\n        children: pipRef.current ? '退出画中画' : '画中画'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: start,\n      disabled: started,\n      style: {\n        ...(started ? disabledBtnStyle : frostedGlassBtnStyle),\n        ...(startBtnHover && !started ? getBtnHoverStyle(false) : {}),\n        marginRight: 8\n      },\n      onMouseEnter: () => setStartBtnHover(true),\n      onMouseLeave: () => setStartBtnHover(false),\n      children: \"\\u542F\\u52A8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: stop,\n      disabled: !started,\n      style: {\n        ...(!started ? disabledBtnStyle : frostedGlassBtnStyle),\n        ...(stopBtnHover && started ? getBtnHoverStyle(false) : {})\n      },\n      onMouseEnter: () => setStopBtnHover(true),\n      onMouseLeave: () => setStopBtnHover(false),\n      children: \"\\u505C\\u6B62\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 7\n    }, this), renderVideo && /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"media\",\n      style: {\n        marginTop: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          color: 'white'\n        },\n        children: \"\\u7BA1\\u5BB6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        ref: audioRef,\n        autoPlay: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        style: {\n          display: 'none',\n          // 改为'block'可临时显示原始视频\n          width: 100,\n          // 小尺寸显示，不影响布局\n          height: 'auto',\n          position: 'absolute',\n          top: 10,\n          right: 10,\n          zIndex: 100\n        },\n        autoPlay: true,\n        playsInline: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          width: zoomWidth,\n          height: zoomWidth * initialHeight / initialWidth,\n          position: 'relative',\n          zIndex: 10,\n          border: '1px solid rgba(255,255,255,0.3)',\n          // 边框帮助确认Canvas位置\n          backgroundColor: 'rgba(0,0,0,0.1)' // 浅灰背景，确认Canvas是否显示\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        left: chatPos.left,\n        top: chatPos.top,\n        width: 320,\n        borderRadius: 6,\n        padding: 12,\n        color: 'white',\n        userSelect: 'none',\n        cursor: draggingRef.current ? 'grabbing' : 'grab',\n        zIndex: 9999\n      },\n      onMouseDown: onDragStart,\n      onMouseMove: onDragMove,\n      onMouseUp: onDragEnd,\n      onMouseLeave: onDragEnd,\n      onTouchStart: onDragStart,\n      onTouchMove: onDragMove,\n      onTouchEnd: onDragEnd,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          gap: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          rows: 3,\n          style: {\n            width: '100%',\n            resize: 'vertical',\n            padding: 8,\n            borderRadius: 8,\n            border: '1px solid rgba(255,255,255,0.3)',\n            backgroundColor: 'rgba(255,255,255,0.1)',\n            backdropFilter: 'blur(10px)',\n            color: 'white',\n            outline: 'none'\n          },\n          placeholder: \"\\u8BF7\\u8F93\\u5165\\u6587\\u672C...\",\n          onClick: e => e.stopPropagation()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 598,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'flex-end',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleInterruptClick,\n            style: {\n              ...frostedGlassBtnStyle,\n              padding: '6px 16px',\n              fontSize: 14\n            },\n            onMouseEnter: () => setInterruptBtnHover(true),\n            onMouseLeave: () => setInterruptBtnHover(false),\n            children: \"\\u6253\\u65AD\\u8BF4\\u8BDD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 617,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"image-upload\",\n            style: {\n              ...frostedGlassBtnStyle,\n              padding: '6px 12px',\n              cursor: 'pointer'\n            },\n            children: \"\\u4E0A\\u4F20\\u56FE\\u7247\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 626,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"image-upload\",\n            type: \"file\",\n            accept: \"image/*\",\n            style: {\n              display: 'none'\n            },\n            onChange: handleImageChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 632,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            style: {\n              ...frostedGlassBtnStyle,\n              padding: '6px 16px'\n            },\n            children: \"\\u53D1\\u9001\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 616,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 597,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 453,\n    columnNumber: 5\n  }, this);\n}\n_s(OldWebRTC, \"yNCxI2x/WN7ep7gLrPe2cAVoaGQ=\");\n_c = OldWebRTC;\nvar _c;\n$RefreshReg$(_c, \"OldWebRTC\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","OldWebRTC","renderVideo","keepConnection","_s","videoRef","audioRef","pcRef","textareaRef","canvasRef","pipRef","containerRef","useStun","setUseStun","started","setStarted","zoomWidth","setZoomWidth","videoLoaded","setVideoLoaded","debugLogs","setDebugLogs","initialWidth","initialHeight","SIGNALING_URL","zoomStep","chatPos","setChatPos","saved","localStorage","getItem","pos","JSON","parse","left","top","greenThreshold","setGreenThreshold","r","g","b","draggingRef","dragOffsetRef","x","y","onDragStart","e","target","tagName","toLowerCase","current","targetRect","currentTarget","getBoundingClientRect","type","touches","clientX","clientY","preventDefault","stopPropagation","onDragMove","containerRect","chatRect","chatWidth","width","chatHeight","height","newLeft","newTop","Math","min","max","onDragEnd","setItem","stringify","logDebug","message","prev","newLogs","Date","toLocaleTimeString","slice","console","log","processVideoFrame","negotiate","pc","addTransceiver","direction","offer","createOffer","setLocalDescription","Promise","resolve","iceGatheringState","checkState","removeEventListener","addEventListener","response","fetch","method","headers","body","sdp","localDescription","answer","json","setRemoteDescription","alert","start","config","sdpSemantics","RTCPeerConnection","evt","track","kind","srcObject","streams","iceConnectionState","stop","document","pictureInPictureElement","exitPictureInPicture","setTimeout","close","getTracks","forEach","t","zoomIn","w","zoomOut","sendTextMessage","trim","text","ok","Error","status","error","sendMultiModal","imageFile","reader","FileReader","onloadend","image","result","setImageFile","setMessage","readAsDataURL","handleSubmit","handleImageChange","file","files","togglePictureInPicture","canvas","pictureInPictureEnabled","requestPictureInPicture","handleInterruptClick","resp","video","handleVideoLoaded","videoWidth","videoHeight","ctx","getContext","willReadFrequently","drawImage","imageData","getImageData","data","i","length","putImageData","random","requestAnimationFrame","frostedGlassBtnStyle","backgroundColor","border","color","fontWeight","padding","cursor","borderRadius","outline","transition","fontSize","backdropFilter","WebkitBackdropFilter","boxShadow","disabledBtnStyle","opacity","getBtnHoverStyle","disabled","transform","startBtnHover","setStartBtnHover","stopBtnHover","setStopBtnHover","zoomInHover","setZoomInHover","zoomOutHover","setZoomOutHover","interruptBtnHover","setInterruptBtnHover","pipBtnHover","setPipBtnHover","ref","style","maxWidth","position","minHeight","children","bottom","right","maxHeight","overflowY","zIndex","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","map","margin","className","id","checked","onChange","accentColor","hidden","onClick","marginRight","onMouseEnter","onMouseLeave","marginTop","autoPlay","display","playsInline","userSelect","onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","onSubmit","flexDirection","gap","value","rows","resize","placeholder","justifyContent","htmlFor","accept","_c","$RefreshReg$"],"sources":["D:/XM/AI-Sphere-Butler/core/client/src/components/OldWebRTC.jsx"],"sourcesContent":["// src/components/OldWebRTC.jsx\r\nimport React, { useEffect, useRef, useState } from 'react';\r\n\r\nexport default function OldWebRTC({ renderVideo = true, keepConnection = false }) {\r\n  const videoRef = useRef(null);\r\n  const audioRef = useRef(null);\r\n  const pcRef = useRef(null);\r\n  const textareaRef = useRef(null);\r\n  const canvasRef = useRef(null); // 用于抠图的画布\r\n  const pipRef = useRef(false); // 画中画状态\r\n\r\n  const containerRef = useRef(null);\r\n\r\n  const [useStun, setUseStun] = useState(false);\r\n  const [started, setStarted] = useState(false);\r\n  const [zoomWidth, setZoomWidth] = useState(600);\r\n  const [videoLoaded, setVideoLoaded] = useState(false); // 新增：视频加载状态\r\n  const [debugLogs, setDebugLogs] = useState([]); // 新增：调试日志\r\n\r\n  // 视频初始宽高\r\n  const initialWidth = 600;\r\n  const initialHeight = 450;\r\n\r\n  // 信令服务器地址\r\n  const SIGNALING_URL = '/offer';\r\n\r\n  // 视频缩放比例\r\n  const zoomStep = 50;\r\n\r\n  // 聊天框位置状态\r\n  const [chatPos, setChatPos] = useState(() => {\r\n    try {\r\n      const saved = localStorage.getItem('chatbox-position');\r\n      if (saved) {\r\n        const pos = JSON.parse(saved);\r\n        return pos;\r\n      }\r\n    } catch {}\r\n    return { left: 20, top: 20 };\r\n  });\r\n\r\n  // 绿幕抠图颜色阈值（放宽范围，避免误判）\r\n  const [greenThreshold, setGreenThreshold] = useState({\r\n    r: 80,    // 红色上限（放宽）\r\n    g: 150,   // 绿色下限（降低）\r\n    b: 80     // 蓝色上限（放宽）\r\n  });\r\n\r\n  // 拖拽相关状态\r\n  const draggingRef = useRef(false);\r\n  const dragOffsetRef = useRef({ x: 0, y: 0 });\r\n\r\n  // 拖拽事件处理\r\n  function onDragStart(e) {\r\n    if (e.target.tagName.toLowerCase() === 'textarea') {\r\n      draggingRef.current = false;\r\n      return;\r\n    }\r\n    \r\n    draggingRef.current = true;\r\n    const targetRect = e.currentTarget.getBoundingClientRect();\r\n    if (e.type === 'touchstart' && e.touches && e.touches[0]) {\r\n      dragOffsetRef.current = {\r\n        x: e.touches[0].clientX - targetRect.left,\r\n        y: e.touches[0].clientY - targetRect.top,\r\n      };\r\n    } else {\r\n      dragOffsetRef.current = {\r\n        x: e.clientX - targetRect.left,\r\n        y: e.clientY - targetRect.top,\r\n      };\r\n    }\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  function onDragMove(e) {\r\n    if (!draggingRef.current) return;\r\n  \r\n    let clientX, clientY;\r\n    if (e.type === 'touchmove' && e.touches && e.touches[0]) {\r\n      clientX = e.touches[0].clientX;\r\n      clientY = e.touches[0].clientY;\r\n    } else if (e.type === 'mousemove') {\r\n      clientX = e.clientX;\r\n      clientY = e.clientY;\r\n    } else {\r\n      return;\r\n    }\r\n  \r\n    if (!containerRef.current || !e.currentTarget) return;\r\n  \r\n    const containerRect = containerRef.current.getBoundingClientRect();\r\n    const chatRect = e.currentTarget.getBoundingClientRect();\r\n    const chatWidth = chatRect.width;\r\n    const chatHeight = chatRect.height;\r\n  \r\n    let newLeft = clientX - containerRect.left - dragOffsetRef.current.x;\r\n    let newTop = clientY - containerRect.top - dragOffsetRef.current.y;\r\n  \r\n    newLeft = Math.min(Math.max(0, newLeft), containerRect.width - chatWidth);\r\n    newTop = Math.min(Math.max(0, newTop), containerRect.height - chatHeight);\r\n  \r\n    setChatPos({ left: newLeft, top: newTop });\r\n  \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n  \r\n  function onDragEnd(e) {\r\n    if (draggingRef.current) {\r\n      draggingRef.current = false;\r\n      localStorage.setItem('chatbox-position', JSON.stringify(chatPos));\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  // 新增：调试日志记录\r\n  const logDebug = (message) => {\r\n    setDebugLogs(prev => {\r\n      const newLogs = [...prev, `[${new Date().toLocaleTimeString()}] ${message}`];\r\n      return newLogs.slice(-10); // 只保留最近10条\r\n    });\r\n    console.log('[WebRTC Debug]', message);\r\n  };\r\n\r\n  // 视频帧处理函数（带调试）\r\n  const processVideoFrame = useRef(() => {});\r\n\r\n  // WebRTC协商\r\n  async function negotiate() {\r\n    const pc = pcRef.current;\r\n    if (!pc) return;\r\n\r\n    pc.addTransceiver('video', { direction: 'recvonly' });\r\n    pc.addTransceiver('audio', { direction: 'recvonly' });\r\n\r\n    try {\r\n      const offer = await pc.createOffer();\r\n      await pc.setLocalDescription(offer);\r\n\r\n      await new Promise((resolve) => {\r\n        if (pc.iceGatheringState === 'complete') {\r\n          resolve();\r\n        } else {\r\n          const checkState = () => {\r\n            if (pc.iceGatheringState === 'complete') {\r\n              pc.removeEventListener('icegatheringstatechange', checkState);\r\n              resolve();\r\n            }\r\n          };\r\n          pc.addEventListener('icegatheringstatechange', checkState);\r\n        }\r\n      });\r\n\r\n      const response = await fetch(SIGNALING_URL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          sdp: pc.localDescription.sdp,\r\n          type: pc.localDescription.type,\r\n        }),\r\n      });\r\n      const answer = await response.json();\r\n      await pc.setRemoteDescription(answer);\r\n      logDebug('WebRTC协商完成');\r\n    } catch (e) {\r\n      logDebug('协商失败: ' + e.message);\r\n      alert('协商失败: ' + e.message);\r\n    }\r\n  }\r\n\r\n  function start() {\r\n    if (started) return;\r\n\r\n    const config = { sdpSemantics: 'unified-plan' };\r\n    const pc = new RTCPeerConnection(config);\r\n    pcRef.current = pc;\r\n\r\n    // 监听轨道事件（带调试）\r\n    pc.addEventListener('track', (evt) => {\r\n      logDebug(`收到${evt.track.kind}轨道`);\r\n      if (evt.track.kind === 'video') {\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = evt.streams[0];\r\n          logDebug('视频轨道已绑定到video元素');\r\n        }\r\n      } else if (evt.track.kind === 'audio') {\r\n        if (audioRef.current) {\r\n          audioRef.current.srcObject = evt.streams[0];\r\n          logDebug('音频轨道已绑定到audio元素');\r\n        }\r\n      }\r\n    });\r\n\r\n    // 监听ICE连接状态\r\n    pc.addEventListener('iceconnectionstatechange', () => {\r\n      logDebug('ICE连接状态: ' + pc.iceConnectionState);\r\n      if (pc.iceConnectionState === 'failed') {\r\n        alert('ICE连接失败，请重试');\r\n      }\r\n    });\r\n\r\n    setStarted(true);\r\n    negotiate();\r\n    setZoomWidth(initialWidth);\r\n  }\r\n\r\n  function stop() {\r\n    if (!started) return;\r\n\r\n    setStarted(false);\r\n    if (document.pictureInPictureElement) {\r\n      document.exitPictureInPicture();\r\n      pipRef.current = false;\r\n    }\r\n\r\n    if (!keepConnection) {\r\n      setTimeout(() => {\r\n        if (pcRef.current) {\r\n          pcRef.current.close();\r\n          pcRef.current = null;\r\n          logDebug('关闭WebRTC连接');\r\n        }\r\n      }, 500);\r\n\r\n      if (videoRef.current && videoRef.current.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach((t) => t.stop());\r\n        videoRef.current.srcObject = null;\r\n      }\r\n      if (audioRef.current && audioRef.current.srcObject) {\r\n        audioRef.current.srcObject.getTracks().forEach((t) => t.stop());\r\n        audioRef.current.srcObject = null;\r\n      }\r\n    }\r\n    setVideoLoaded(false);\r\n  }\r\n\r\n  // 缩放功能\r\n  function zoomIn() {\r\n    setZoomWidth((w) => w + zoomStep);\r\n  }\r\n  function zoomOut() {\r\n    setZoomWidth((w) => (w - zoomStep > 0 ? w - zoomStep : w));\r\n  }\r\n\r\n  // 消息发送功能（保留原有）\r\n  const sendTextMessage = async () => {\r\n    if (!message.trim()) return;\r\n    try {\r\n      const response = await fetch('https://192.168.168.77:6010/qwener', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ text: message }),\r\n      });\r\n      if (!response.ok) throw new Error('状态码: ' + response.status);\r\n      logDebug('文本发送成功');\r\n    } catch (error) {\r\n      logDebug('文本发送失败：' + error.message);\r\n    }\r\n  };\r\n\r\n  const sendMultiModal = async () => {\r\n    if (!imageFile) return;\r\n    try {\r\n      const reader = new FileReader();\r\n      reader.onloadend = async () => {\r\n        const response = await fetch('https://192.168.1.70:6010/multimodal', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ text: message.trim(), image: reader.result }),\r\n        });\r\n        if (!response.ok) throw new Error('状态码: ' + response.status);\r\n        logDebug('多模态发送成功');\r\n        setImageFile(null);\r\n        setMessage('');\r\n      };\r\n      reader.readAsDataURL(imageFile);\r\n    } catch (error) {\r\n      logDebug('多模态发送失败：' + error.message);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (imageFile) {\r\n      await sendMultiModal();\r\n    } else {\r\n      await sendTextMessage();\r\n      setMessage('');\r\n    }\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    setImageFile(file || null);\r\n  };\r\n\r\n  // 画中画功能\r\n  const togglePictureInPicture = async () => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    try {\r\n      if (document.pictureInPictureElement) {\r\n        await document.exitPictureInPicture();\r\n        pipRef.current = false;\r\n        logDebug('退出画中画');\r\n      } else if (document.pictureInPictureEnabled) {\r\n        await canvas.requestPictureInPicture();\r\n        pipRef.current = true;\r\n        logDebug('进入画中画');\r\n      }\r\n    } catch (error) {\r\n      logDebug('画中画错误: ' + error.message);\r\n      alert('画中画功能无法使用: ' + error.message);\r\n    }\r\n  };\r\n\r\n  // 打断功能\r\n  const handleInterruptClick = async () => {\r\n    try {\r\n      const resp = await fetch('http://192.168.168.77:6010/api/interrupt_speaking', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      if (!resp.ok) throw new Error('状态码: ' + resp.status);\r\n      logDebug('打断请求发送成功');\r\n    } catch (e) {\r\n      logDebug('打断接口异常: ' + e.message);\r\n    }\r\n  };\r\n\r\n  // 核心：视频加载与Canvas初始化（带调试）\r\n  useEffect(() => {\r\n    const video = videoRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (!video || !canvas) return;\r\n\r\n    // 视频加载完成后初始化Canvas\r\n    const handleVideoLoaded = () => {\r\n      setVideoLoaded(true);\r\n      canvas.width = video.videoWidth;\r\n      canvas.height = video.videoHeight;\r\n      logDebug(`视频加载完成 (${canvas.width}x${canvas.height})`);\r\n      \r\n      // 初始化帧处理函数\r\n      const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n      processVideoFrame.current = () => {\r\n        if (!started || !videoLoaded) return;\r\n        \r\n        try {\r\n          // 绘制原始视频帧（先确保能显示画面）\r\n          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n          \r\n          // 绿幕抠图逻辑（可临时注释测试）\r\n          const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n          const data = imageData.data;\r\n          \r\n          for (let i = 0; i < data.length; i += 4) {\r\n            const r = data[i];\r\n            const g = data[i + 1];\r\n            const b = data[i + 2];\r\n            \r\n            // 绿幕判断（放宽条件，避免误判）\r\n            if (r < greenThreshold.r && g > greenThreshold.g && b < greenThreshold.b) {\r\n              data[i + 3] = 0; // 透明\r\n            }\r\n          }\r\n          ctx.putImageData(imageData, 0, 0);\r\n          logDebug('帧处理完成（每50帧打印一次）', Math.random() > 0.98); // 减少日志频率\r\n        } catch (error) {\r\n          logDebug('帧处理错误: ' + error.message);\r\n        }\r\n        requestAnimationFrame(processVideoFrame.current);\r\n      };\r\n      \r\n      // 开始处理帧\r\n      if (started) {\r\n        processVideoFrame.current();\r\n      }\r\n    };\r\n\r\n    // 监听视频加载事件\r\n    video.addEventListener('loadedmetadata', handleVideoLoaded);\r\n    // 监听视频播放事件\r\n    video.addEventListener('play', () => {\r\n      logDebug('视频开始播放');\r\n      if (started && videoLoaded) {\r\n        processVideoFrame.current();\r\n      }\r\n    });\r\n\r\n    // 清理函数\r\n    return () => {\r\n      video.removeEventListener('loadedmetadata', handleVideoLoaded);\r\n      video.removeEventListener('play', () => {});\r\n    };\r\n  }, [started, videoLoaded, greenThreshold]);\r\n\r\n  // 状态变化时重启帧处理\r\n  useEffect(() => {\r\n    if (started && videoLoaded && canvasRef.current) {\r\n      logDebug('开始处理视频帧');\r\n      processVideoFrame.current();\r\n    }\r\n  }, [started, videoLoaded]);\r\n\r\n  // 通用样式（保留原有）\r\n  const frostedGlassBtnStyle = {\r\n    backgroundColor: 'rgba(255, 255, 255, 0.1)',\r\n    border: '1px solid rgba(255, 255, 255, 0.3)',\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    padding: '8px 16px',\r\n    cursor: 'pointer',\r\n    borderRadius: 4,\r\n    outline: 'none',\r\n    transition: 'all 0.3s',\r\n    fontSize: 14,\r\n    backdropFilter: 'blur(10px)',\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n    boxShadow: '0 4px 10px rgba(255, 255, 255, 0.15)',\r\n  };\r\n\r\n  const disabledBtnStyle = {\r\n    ...frostedGlassBtnStyle,\r\n    opacity: 0.4,\r\n    cursor: 'not-allowed',\r\n    boxShadow: 'none',\r\n  };\r\n\r\n  const getBtnHoverStyle = (disabled) => !disabled && {\r\n    backgroundColor: 'rgba(255, 255, 255, 0.2)',\r\n    boxShadow: '0 6px 20px rgba(255, 255, 255, 0.3)',\r\n    transform: 'scale(1.05)',\r\n  };\r\n\r\n  // 按钮hover状态\r\n  const [startBtnHover, setStartBtnHover] = useState(false);\r\n  const [stopBtnHover, setStopBtnHover] = useState(false);\r\n  const [zoomInHover, setZoomInHover] = useState(false);\r\n  const [zoomOutHover, setZoomOutHover] = useState(false);\r\n  const [interruptBtnHover, setInterruptBtnHover] = useState(false);\r\n  const [pipBtnHover, setPipBtnHover] = useState(false);\r\n\r\n  // 消息和图片状态\r\n  const [message, setMessage] = useState('');\r\n  const [imageFile, setImageFile] = useState(null);\r\n\r\n  return (\r\n    <div ref={containerRef} style={{ maxWidth: 1280, position: 'relative', minHeight: '100vh' }}>\r\n      {/* 调试日志显示（临时添加，帮助排查问题） */}\r\n      <div style={{ \r\n        position: 'fixed', bottom: 10, right: 10, \r\n        backgroundColor: 'rgba(0,0,0,0.7)', color: 'white', \r\n        padding: 8, borderRadius: 4, maxWidth: 300, \r\n        maxHeight: 150, overflowY: 'auto', fontSize: 12,\r\n        zIndex: 99999\r\n      }}>\r\n        <div style={{ fontWeight: 'bold', marginBottom: 4 }}>调试日志</div>\r\n        {debugLogs.map((log, i) => (\r\n          <div key={i} style={{ margin: 2 }}>{log}</div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"option\" style={{ marginBottom: 8 }}>\r\n        <input\r\n          id=\"use-stun\"\r\n          type=\"checkbox\"\r\n          checked={useStun}\r\n          onChange={(e) => setUseStun(e.target.checked)}\r\n          style={{ accentColor: 'white', hidden: true }}\r\n          disabled={started}\r\n        />\r\n      </div>\r\n\r\n      <div style={{ marginBottom: 8 }}>\r\n        <button\r\n          onClick={zoomIn}\r\n          style={{ ...frostedGlassBtnStyle, marginRight: 8, ...(zoomInHover ? getBtnHoverStyle(false) : {}) }}\r\n          onMouseEnter={() => setZoomInHover(true)}\r\n          onMouseLeave={() => setZoomInHover(false)}\r\n        >\r\n          放大\r\n        </button>\r\n        <button\r\n          onClick={zoomOut}\r\n          style={{ ...frostedGlassBtnStyle, marginRight: 8, ...(zoomOutHover ? getBtnHoverStyle(false) : {}) }}\r\n          onMouseEnter={() => setZoomOutHover(true)}\r\n          onMouseLeave={() => setZoomOutHover(false)}\r\n        >\r\n          缩小\r\n        </button>\r\n        <button\r\n          onClick={togglePictureInPicture}\r\n          disabled={!started}\r\n          style={{ \r\n            ...(started ? frostedGlassBtnStyle : disabledBtnStyle), \r\n            marginRight: 8, \r\n            ...(pipBtnHover && started ? getBtnHoverStyle(false) : {}) \r\n          }}\r\n          onMouseEnter={() => setPipBtnHover(true)}\r\n          onMouseLeave={() => setPipBtnHover(false)}\r\n        >\r\n          {pipRef.current ? '退出画中画' : '画中画'}\r\n        </button>\r\n      </div>\r\n\r\n      <button\r\n        onClick={start}\r\n        disabled={started}\r\n        style={{\r\n          ...(started ? disabledBtnStyle : frostedGlassBtnStyle),\r\n          ...(startBtnHover && !started ? getBtnHoverStyle(false) : {}),\r\n          marginRight: 8,\r\n        }}\r\n        onMouseEnter={() => setStartBtnHover(true)}\r\n        onMouseLeave={() => setStartBtnHover(false)}\r\n      >\r\n        启动\r\n      </button>\r\n      <button\r\n        onClick={stop}\r\n        disabled={!started}\r\n        style={{\r\n          ...(!started ? disabledBtnStyle : frostedGlassBtnStyle),\r\n          ...(stopBtnHover && started ? getBtnHoverStyle(false) : {}),\r\n        }}\r\n        onMouseEnter={() => setStopBtnHover(true)}\r\n        onMouseLeave={() => setStopBtnHover(false)}\r\n      >\r\n        停止\r\n      </button>\r\n\r\n      {/* 视频区域 */}\r\n      {renderVideo && (\r\n        <div id=\"media\" style={{ marginTop: 20 }}>\r\n          <h2 style={{ color: 'white' }}>管家</h2>\r\n\r\n          <audio ref={audioRef} autoPlay />\r\n          \r\n          {/* 原始视频（临时显示，帮助排查问题） */}\r\n          <video\r\n            ref={videoRef}\r\n            style={{ \r\n              display: 'none', // 改为'block'可临时显示原始视频\r\n              width: 100, // 小尺寸显示，不影响布局\r\n              height: 'auto',\r\n              position: 'absolute',\r\n              top: 10,\r\n              right: 10,\r\n              zIndex: 100\r\n            }}\r\n            autoPlay\r\n            playsInline\r\n          />\r\n          \r\n          {/* 处理后的视频（Canvas） */}\r\n          <canvas\r\n            ref={canvasRef}\r\n            style={{ \r\n              width: zoomWidth, \r\n              height: (zoomWidth * initialHeight) / initialWidth,\r\n              position: 'relative',\r\n              zIndex: 10,\r\n              border: '1px solid rgba(255,255,255,0.3)', // 边框帮助确认Canvas位置\r\n              backgroundColor: 'rgba(0,0,0,0.1)' // 浅灰背景，确认Canvas是否显示\r\n            }}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* 聊天框 */}\r\n      <div\r\n        style={{\r\n          position: 'absolute',\r\n          left: chatPos.left,\r\n          top: chatPos.top,\r\n          width: 320,\r\n          borderRadius: 6,\r\n          padding: 12,\r\n          color: 'white',\r\n          userSelect: 'none',\r\n          cursor: draggingRef.current ? 'grabbing' : 'grab',\r\n          zIndex: 9999,\r\n        }}\r\n        onMouseDown={onDragStart}\r\n        onMouseMove={onDragMove}\r\n        onMouseUp={onDragEnd}\r\n        onMouseLeave={onDragEnd}\r\n        onTouchStart={onDragStart}\r\n        onTouchMove={onDragMove}\r\n        onTouchEnd={onDragEnd}\r\n      >\r\n        <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n          <textarea\r\n            value={message}\r\n            onChange={(e) => setMessage(e.target.value)}\r\n            rows={3}\r\n            style={{\r\n              width: '100%',\r\n              resize: 'vertical',\r\n              padding: 8,\r\n              borderRadius: 8,\r\n              border: '1px solid rgba(255,255,255,0.3)',\r\n              backgroundColor: 'rgba(255,255,255,0.1)',\r\n              backdropFilter: 'blur(10px)',\r\n              color: 'white',\r\n              outline: 'none',\r\n            }}\r\n            placeholder=\"请输入文本...\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          />\r\n          <div style={{ display: 'flex', justifyContent: 'flex-end', gap: 8 }}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleInterruptClick}\r\n              style={{ ...frostedGlassBtnStyle, padding: '6px 16px', fontSize: 14 }}\r\n              onMouseEnter={() => setInterruptBtnHover(true)}\r\n              onMouseLeave={() => setInterruptBtnHover(false)}\r\n            >\r\n              打断说话\r\n            </button>\r\n            <label\r\n              htmlFor=\"image-upload\"\r\n              style={{ ...frostedGlassBtnStyle, padding: '6px 12px', cursor: 'pointer' }}\r\n            >\r\n              上传图片\r\n            </label>\r\n            <input\r\n              id=\"image-upload\"\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              style={{ display: 'none' }}\r\n              onChange={handleImageChange}\r\n            />\r\n            <button\r\n              type=\"submit\"\r\n              style={{ ...frostedGlassBtnStyle, padding: '6px 16px' }}\r\n            >\r\n              发送\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}